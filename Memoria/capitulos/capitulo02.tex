% !TeX root = ../libro.tex
% !TeX encoding = utf8

\chapter{Implicitación}
Ahora que sabemos representar las superficies generadas por una función implícita cualquiera, nos proponemos ser capaces de representar también superficies definidas paramétricamente. Para ello haremos uso de la teoría de bases de Groebner, pero antes debemos introducir una serie de definiciones y resultados previos que nos pongan en contexto.

\section{Polinomios en varias variables}
Fijamos $A$ cuerpo y $X=\{x_1, \dots, x_n\}$ un conjunto de variables distintas.

\begin{definicion}
    Llamamos \textbf{monomio} en $X$ al producto de la forma:
    $$x_1^{\alpha_1} \cdots x_n^{\alpha_n}\quad,\ \alpha_i \in \N,\ \forall  0\le i \le n$$
    Lo denotaremos como $X^{\alpha}$, y diremos que $\alpha\in \N^n$ es el \textbf{exponente} del monomio.
\end{definicion}

\begin{definicion}
    Definimos un \textbf{polinomio} en $X$ con coeficientes en $A$ a toda combinación lineal finita de monomios: 
    \begin{equation*}
        \sum_{\alpha\in\Nn} a_{\alpha} X^{\alpha},\ a_\alpha \in A
    \end{equation*}
\end{definicion}

\begin{proposicion}
    El conjunto de polinomios, que denotaremos $A[X] = A[x_1,\dots, x_n]$, es un cuerpo con las operaciones:
    \begin{itemize}
        \item Suma heredada de $A$: $(f+g)(\alpha) = f(\alpha) + f(\alpha),\ \forall f,g\in A[X]$.
        \item Producto de convolución: $(fg)(\alpha) = \sum_{\alpha} \sum_{\beta+\gamma=\alpha} f(\beta)g(\gamma),\ \forall f,g\in A[X]$.
    \end{itemize}

\end{proposicion}

Nos surge la pregunta de si hay alguna forma \qq{natural} de ordenar los monomios que forman un polinomio, al igual que ocurre para polinomios de una sola variable. Primero tenemos que especificar qué es lo que consideramos \qq{natural}.

\begin{definicion}
    Un \textbf{orden admisible} es un orden total $\le$ sobre $\N^n$ cumpliendo:
    \begin{enumerate}
        \item $(0,\dots ,0) \le \alpha,\ \forall \alpha \in \N^n$.
        \item $\alpha < \beta \implies \alpha + \gamma < \beta + \gamma,\ \forall \alpha,\beta,\gamma \in \N^n$.
    \end{enumerate}
\end{definicion}

Siempre supondremos que usamos un orden admisible, luego podemos ordenar los monomios que conforman un polinomio ordenando sus exponentes según cualquier dicho orden. Hay multitud de órdenes entre los que elegir. Algunos de los más importantes son:

\begin{ejemplo}
    Definimos el \textbf{orden lexicográfico} $\le_{\text{lex}}$ como:
    \begin{equation*}
        \alpha \lex \beta \iff \begin{cases}
            \alpha  = \beta \\
            \quad\text{ó}   \\
            \alpha_i < \beta_i \text{, donde $i$ es el primer índice tal que } \alpha_i \neq \beta_i
        \end{cases}
    \end{equation*}
\end{ejemplo}

\begin{definicion}
    Llamamos \textbf{grado} de $\alpha\in\Nn$ a $\vert \alpha\vert = \sum_{i=1}^n \alpha_1+\cdots + \alpha_n$.
\end{definicion}
\begin{ejemplo}
    Definimos el \textbf{orden lexicográfico graduado inverso} $\le_{\text{degrevlex}}$ como:
    \begin{equation*}
        \alpha \le_{\text{degrevlex}} \beta \iff \begin{cases}
            |\alpha| < |\beta| \\
            \quad\text{ó}   \\
            |\alpha| = |\beta| \text{ y } \alpha_i > \beta_i \text{, donde $i$ es el último índice tal que } \alpha_i \neq \beta_i
        \end{cases}
    \end{equation*}
\end{ejemplo}

Una vez obtenida la noción de orden admisible, estamos en disposición de definir varios conceptos que nos resultarán imprescindibles.

\begin{definicion}
    Sea $f= \sum_{\alpha\in \Nn} a_{\alpha} X^{\alpha}$ y $\le$ admisible. Definimos:
    \begin{itemize}
        \item \textbf{Exponente:} $exp(f) = \max_{\le}\alpha$.
        \item \textbf{Monomio líder:} $\lmf = X^{\expf}$
        \item \textbf{Coeficiente líder:} $\lcf = a_{\expf}$.
        \item \textbf{Término líder:} $\ltf = \lcf \cdot \lmf$.
    \end{itemize}
\end{definicion}

\begin{teorema}
    Sea $F=\{f_1,\dots, f_s\} \subset A[X]$. Entonces todo polinomio $f\in A[X]$ se puede expresar como:
    \begin{equation*}
        f = q_1f_1 + \cdots + q_sf_s + r
    \end{equation*}

    donde $q_i, r\in A[X]$ y $r$ no se puede expresar como combinación lineal de ningún elemento de $F$ o es $0$. Notaremos $\rem(f, [F]) = r$.
\end{teorema}

En otras palabras, podemos dividir $f$ entre los polinomios $f_1, \dots, f_s$ para expresar $f$ como combinación lineal de elementos de $F$. Sin embargo, esta descomposición no será única, y dependerá del orden que ocupen los polinomios en $F$. Podemos calcular esta descomposición usando \autoref{a:division}.

\SetKwComment{Comment}{/* }{ */}
\begin{algorithm}[hbt!]
    \caption{División polinomios varias variables}\label{a:division}
    \KwData{$f$, $F = \left[ f_1, \dots, f_S\right]$}
    $p\gets f$\;
    $\left[q_1,\dots, q_s\right] \gets \left[0,\dots, 0\right]$\;
    $r\gets 0$\;

    \While{$p \neq 0$}{
        $\text{divisorEncontrado} \gets false$\;
        \For{$f_i \in F$} {
            \If{$\text{exp}(p) = \text{exp}(f_i) + \alpha$}{
                $q_i\gets q_i + \frac{\text{lc}(p)}{\text{lc}(f_i)} X^{\alpha}$\;
                $p \gets p - f_i \cdot \frac{\text{lc}(p)}{\text{lc}(f_i)} X^{\alpha}$\;
                $\text{divisorEncontrado} \gets true$\;
            }
        }
        \If{$!\text{divisorEncontrado}$}{
            $r \gets r + \text{lt}(p)$\;
            $p \gets p - \text{lt}(p)$\;
        }
    }
    \Return{$\left[r,q_1,\dots, q_s\right]$}
\end{algorithm}

\begin{proof}
    TODO
\end{proof}
\section{Bases de Groebner}

\begin{definicion}
    Dado un anillo conmutativo $R$, decimos que $\emptyset \neq I \subseteq R$ es un \textbf{ideal} si:
    \begin{enumerate}
        \item $a+b\in I,\ \forall a,b\in I$.
        \item $ab\in I,\ \forall a\in I,\ \forall b\in R$.
    \end{enumerate}

    Lo denotaremos como $I\le R$.
\end{definicion}

\begin{definicion}
    Dado $F\subseteq A$, el \textbf{ideal generado} por $F$ es:
    \begin{equation*}
        \langle F \rangle = \{a_1f_1 + \cdots + a_sf_s : a_1,\dots, a_s\in A,\ f_1,\dots, f_s\in F\}
    \end{equation*}
\end{definicion}

\begin{definicion}
    Dado $I\le A[X]$, diremos que $G = \{g_1,\dots, g_s\}\subseteq I$ es una \textbf{base de Groebner} para $I$ si $\langle \lt(I)\rangle = \langle \lt(g_1),\dots, \lt(g_t) \rangle$.
\end{definicion}

\begin{definicion}
    Dada $f\in A[X]$, definimos su \textbf{soporte} como $$\supp(f) = \{ \alpha\in\Nn : f(\alpha) \neq 0\}$$
\end{definicion}

\begin{definicion}
    $G$ se dirá una \textbf{base de Groebner reducida} para $I$ si para todo $g\in G$ se cumple:
    \begin{itemize}
        \item $\lcg=1$.
        \item $\supp(g) \cap \left(\exp(G\setminus\{g\}) + \Nn \right) = \emptyset$.
    \end{itemize}
\end{definicion}

La base de Groebner es a un ideal lo que un sistema de generadores a un espacio vectorial: un subconjunto a partir del cual podemos obtener el total. Si además la base es reducida, esta será el equivalente a la base del espacio vectorial. Por tanto, resulta de gran interés saber si dado un ideal $I$ siempre existirá una base de Groebner asociada, y de ser así, si podemos calcularla.

\begin{definicion}
    Dados $\alpha,\beta \in \Nn$, definimos:
    \begin{itemize}
        \item \textbf{mínimo común múltiplo}: $\lcm(\alpha,\beta) = \{\max(\alpha_1, \beta_1),\dots, \max(\alpha_n, \beta_n)\}$.
        \item \textbf{máximo común divisor}: $\gcd(\alpha,\beta) = \{\min(\alpha_1, \beta_1),\dots, \max(\alpha_n, \beta_n)\}$.
    \end{itemize}
\end{definicion}

\begin{definicion}
    Sean $f,g \in A[X]$ donde $\alpha=\exp(f),\ \beta=\exp(g),\ \gamma = \lcm(\alpha,\beta)$. Definimos el \textbf{S-polinomio} de $f$ y $g$ como
    \begin{equation*}
        S(f,g) = \lc(g)X^{\gamma-\alpha}f - \lc(f)X^{\gamma-\beta}g
    \end{equation*}
\end{definicion}

\begin{teorema}[Primer Criterio de Buchberger]\label{t:criterio}
    Sean $I\le A[X]$ y $G=\{g_1,\dots, g_t\}$ conjunto de generadores de $I$. Entonces:
    \begin{equation*}
        G \text{ es base de Groebner para } I \iff \rem(S(g_i,g_j), G)=0,\ \forall 1\le i<j\le t
    \end{equation*}
\end{teorema}

El algoritmo que usaremos para el cálculo de la base de Groebner se basará en este criterio. Sin embargo, antes de presentarlo, estudiamos dos criterios adicionales que lo harán más eficiente evitando el cálculo de S-polinomios innecesarios, que es la operación más costosa del algoritmo al suponer la realización de numerosas divisiones.

\begin{teorema}[Criterios de Buchberger]\label{t:criterios}
    Sean $I\le A[X]$ y $g_1,g_2 \in G\subseteq A[X]$. Si se cumple cualquiera de las siguientes condiciones:
    \begin{enumerate}
        \item $\lcm(g_1,g_2) = \lm(g_1)\lm(g_2)$.
        \item $\exists f\in G \colon \lm(f) \vert \lcm(g_1,g_2)$ y se verifica alguna de las condiciones:
        \begin{enumerate}
            \item algún $S(g_i,f)\reduces 0$.
            \item $\lm(f)\vert \frac{\lm(g_i}{\gcd(g_1,g_2}$ y $\sm(g_j)\lm(f) \neq \sm(f)\lm(g_j)$.
        \end{enumerate}
        donde $i,j\in\{1,2\}$ e $i\neq j$.
    \end{enumerate}
    Entonces $S(g_1,g_2)\reduces 0$
\end{teorema}

 Aplicando estos criterios, obtenemos \autoref{a:buchberger}.
 
\SetKwComment{Comment}{/* }{ */}
\begin{algorithm}[hbt!]
    \caption{Algoritmo de Buchberger optimizado}\label{a:buchberger}
    \KwData{$f$, $F = \left[ f_1, \dots, f_S\right]$}

    $G\gets F$\;

    \Repeat{$G' = G$}{
        $G'\gets G$\;
        \For{each pair $\{f,g\} \subseteq G'$} {
            \If{$\text{!Criterio 1}(f,g) \textbf{ AND } !\text{Criterio 2}(f,g, G')$}{
                $r\gets \rem(S(f,g), G')$\;
                \If{$r\neq 0$}{
                    $G\gets G\cup \{r\}$\;
                }
            }
        }
    }

    \Return{$G$}
\end{algorithm}

\begin{observacion}
    Una decisión necesaria y que aún no hemos mencionado es la de cómo se eligen las parejas $\{f,g\}$. Uno de los métodos más usados es la conocida como \textbf{estrategia normal}, debido a su simpleza y haber probado ser de las que completan más rápido el algoritmo. Esta consiste en tomar el par $f,g$ cuyo $\lcm(f,g)$ sea del menor grado posible según el orden admisible usado.
\end{observacion}

Ahora ya somos capaces de calcular una base de Groebner de todo ideal $I\le A[X]$. No obstante, nos gustaría que siempre que fuera posible, esta fuera reducida. Veamos que siempre existe esta base reducida y cómo obtenerla.

\begin{definicion}
    Sea $M\le \Nn$. Decimos que $A$ es un \textbf{conjunto generador minimal} de $M$ si:
    \begin{equation*}
        M = a + \Nn \quad \wedge \quad M\neq (A\setminus \{\alpha\}) + \Nn,\ \forall \alpha \in A 
    \end{equation*}
\end{definicion}

\begin{lema}\label{l:minimal}
    Todo ideal tiene un único conjunto generador minimal.
\end{lema}

\begin{teorema}
    Todo ideal $I$ admite una única base de Groebner reducida para un orden admisible dado.
\end{teorema}
\begin{proof}
    \mybox{Existencia} Sea $G$ un conjunto generador minimal de $\exp(I)$, que sabemos que existe por \autoref{l:minimal}. Sea $g\in G$ y $r = \rem\left(g, [G\setminus \{g\}]\right)$. Tenemos que:
    \begin{equation*}
        \exp(g) \notin \exp(G\setminus\{g\} + \Nn \implies \exp(g)=\exp(r) \implies \exp(G) = \exp\left( (G\setminus \{g\})\cup \{r\}\right)
    \end{equation*}
    Como $g-r\in \langle G\setminus \{g\} \rangle \subseteq I$, tenemos que $r\in I$. Por tanto $G' = (G\setminus \{g\} \cup \{r\}$ es base de Groebner de $I$ y cumple $\supp(r) \cap \left(\exp(G'\setminus\{r\}) + \Nn \right) = \emptyset$.
    Aplicando este procedimiento a cada $g\in G$ obtenemos una base reducida de $I$.\newline

    \mybox{Unicidad} Sean $G_1,G_2$ dos bases minimales de $I$. Por \autoref{l:minimal}:
    \begin{equation*}
        \exp(G_1) = \exp(G_2) \implies \forall g_1\in G_1,\ \exists! g_2\in G_2 : \exp(g_1) = \exp(g_2)
    \end{equation*}

    Como $g_2 - g_1 \in I \implies \rem(g1-g_2, G_1) = 0$. Por otro lado:
    \begin{align*}        
    &\begin{rcases}
        \supp(g1-g_2) \subseteq \left( \supp(g_1)\cup \supp(g_2) \right) \setminus \{\exp(g_1)\}\\
        \supp(g_i)\setminus \{\exp(g_i)\}\cap \left(\{\exp(G_i) + \Nn\}\right) = \varnothing,\ i\in\{1,2\}
    \end{rcases} \implies \supp(g_1-g_2) \cap \left(\exp(G_1)+\Nn\right) = \varnothing\\[10pt]
    &\implies \rem(g_1-g_2, G_1) = g_1-g_2 \implies g_1=g_2 \implies G_1 = G_2
    \end{align*}
\end{proof}

De esta demostración podemos obtener \autoref{a:minim} para reducir una base de Groebner cualquiera a su respectiva minimal:
\begin{algorithm}[hbt!]
    \caption{Minimización de base de Groebner}\label{a:minim}
    \KwData{$G$ base a minimizar}

    $G\gets F$\;

    \ForEach {$g \in G$}{
        $g\gets g/\lc(g)$\;
        $r\gets \rem(g, [G\setminus \{g\}])$\;

        \If{$r\neq 0$}{
            $g \gets r$\;
        }
    }
\end{algorithm}


\section{Implicitación Polinomial}

\begin{definicion}Dado $F \subseteq A[X]$, llamamos \textbf{variedad afín} definida por $F$ al conjunto:
    \begin{equation*}
        \mathbb{V}(F) = \{(a_1,\dots, a_n)\in A^n : f_i(a_1,\dots, a_n)=0,\ \forall 1\le i \le s\}
    \end{equation*}
\end{definicion}

\begin{definicion}
    Dado $I\le A[x_1,\dots,x_n]$, diremos que su \textbf{ideal de $l$-eliminación} es:
    \begin{equation*}
        I_l = I \cap A[x_{l+1}, \dots, x_n] \le A[x_{l+1}, \dots, x_n]
    \end{equation*}
\end{definicion}

\begin{definicion}
    Decimos que un orden admisible $\le$ es un \textbf{orden de $l$-eliminación} si 
    $$\beta\le \alpha \implies \beta \in \N_l^n,\ \forall \alpha \in \N_l^n,\ \forall \beta \in \Nn$$
    donde $\N_l^n = \{\alpha\in \Nn \colon \alpha_i =0,\ 1\le i \le l\}$.
\end{definicion}

\begin{teorema}[Eliminación]
    Sea $I\le A[x_1,\dots,x_n]$ y $G$ una base de Groebner suya respecto a un orden $\le$ de $l$-eliminación. Entonces, una base de Groebner para $I_l$ viene dada por:
    \begin{equation*}
        G_l = G\cap A[x_{l+1},\dots, x_n]
    \end{equation*}
\end{teorema}

\begin{teorema}[Implicitación Polinomial]
    Dados $f_1,\dots, f_n \in A[t_1, \dots, t_r]$ con $A$ cuerpo infinito, sea
    \begin{align*}
        \phi \colon A^r  & \to A^n\\
        (a_1,\dots, a_r) & \mapsto \left( f_1(a_1,\dots, a_r), \dots, f_n(a_1,\dots, a_r) \right)
    \end{align*}

    Definimos los ideales:
    \begin{itemize}
        \item $I = \langle x_1-f_1,\dots,  x_n-f_n\rangle \le A[t_1,\dots, t_r,x_1\dots, x_n]$
        \item $J = I\cap A[x_1,\dots, x_n]$ el ideal de $r$-eliminación de $I$
    \end{itemize}

    Entonces, $\mathbb{V}(J)$ es la menor variedad que contiene a $\phi(A^r)$.
\end{teorema}
