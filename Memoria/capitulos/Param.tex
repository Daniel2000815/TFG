
Ahora que sabemos representar las superficies generadas por una ecuación implícita cualquiera, nos proponemos ser capaces de representar también superficies definidas paramétricamente. Para ello fijaremos un anillo conmutativo $A$ y un conjunto de variables distintas $X=\{x_1,\dots, x_n\}$. Nuestro objetivo será, dado un conjunto $V\subseteq A^n$ por las ecuaciones paramétricas
\begin{align*}
    x_1 &= g_1(t_1,\dots, t_r),\\
    &\vdots \\
    x_n &= g_n(t_1,\dots, t_r),
\end{align*}
donde $g_i$ son polinomios de varias variables en $A$, obtener una ecuación implícita para $V$. En el caso que nos atañe $A=\R^3$, pero presentaremos todos los resultados de forma general.\newline

El contenido de esta sección está fuertemente basado en el libro Ideals, Varieties, and Algorithms de Cox, Little y O'Shea \cite{ideals_varieties}, el cual introduce de forma bastante completa resultados y algoritmos de álgebra conmutativa. Empezaremos explicando a qué nos referimos con polinomios de varias variables y recordando el concepto de ideal y sus propiedades. Después veremos que este problema equivale a uno de pertenencia a un ideal y cómo resolverlo usando la teoría de bases de Groebner.

\subsection{Polinomios en varias variables}
Estamos acostumbrados a trabajar con polinomios de una única variable como una suma o colección de monomios. Podemos mantener esta filosofía en el caso de varias variables adaptando el concepto que tenemos de estos.

\begin{definicion}
    Llamamos \textbf{monomio} en $X$ al producto de la forma
    $$x_1^{\alpha_1} \cdots x_n^{\alpha_n}\quad,\ \alpha_i \in \N,\ i\in\{1,\dots, n\}.$$
    Lo denotaremos como $X^{\alpha}$, y diremos que $\alpha\in \N^n$ es el \textbf{exponente} del monomio.
\end{definicion}

\begin{definicion}
    Definimos el \textbf{polinomio} $f:A^n\to A$ en $X$ con coeficientes en $A$ a toda combinación lineal finita de monomios
    \begin{align*}
        f = \sum_{\alpha\in \N^n} a_{\alpha} X^{\alpha}.
    \end{align*}

\end{definicion}

\begin{proposicion}
    El conjunto de polinomios es un anillo conmutativo. En concreto, para
     $$ f = \sum_{\alpha\in \N^n} a_{\alpha} X^{\alpha}\quad \text{ y }\quad g = \sum_{\beta\in \N^n} a_{\beta} X^{\beta},$$ 
     las operaciones internas del anillo son las siguientes.
    \begin{itemize}
        \item Suma heredada de $A$: $(f+g)(a) = f(a) + g(a)$.
        \item Producto de convolución: $(fg)(a) = \sum_{\alpha} \sum_{\beta+\gamma=\alpha} f(a)g(a)$.
    \end{itemize}
    Denotaremos como  $A[X] = A[x_1,\dots, x_n]$ a este anillo.
\end{proposicion}

En las siguientes secciones veremos que el problema de pertenencia de polinomios a un ideal se puede resolver mediante el procedimiento de la división. Este es bien conocido en polinomios de una variable, y ahora queremos extenderlo a un número arbitrario de ellas y varios divisores. Para ello en primer lugar necesitaremos una forma de ordenar los monomios que forman un polinomio. En una variable la forma \qq{natural} de comparar dos monomios es a través de su exponente. En el caso de varias variables la elección no es tan clara, y hay varias opciones que parecen igual de válidas. Vamos a formalizar el concepto de orden para introducir algunas de las posibilidades de las que disponemos. 

\begin{definicion}
    Un \textbf{orden total} sobre un conjunto $\Delta$ es una relación binaria $\le$ que cumple las siguientes propiedades.
    \begin{enumerate}
        \item Reflexiva: $a\le a,\ \text{para todo } a\in \Delta$.
        \item Transitiva: si $a\le b$ y $b\le c$ entonces $a\le c,\ \text{para todo } a,b,c\in \Delta$.
        \item Antisimétrica: si $a\le b$ y $b\le a$ entonces $a\le b,\ \text{para todo } a,b\in \Delta$.
        \item Completitud: $a\le b$ o $b\le a,\ \text{para todo } a,b\in \Delta$.
    \end{enumerate}
\end{definicion}
\begin{definicion}
    Un \textbf{orden admisible} es un orden total $\le$ sobre $\N^n$ cumpliendo
    \begin{enumerate}
        \item $(0,\dots ,0) \le \alpha,\ \text{para todo } \alpha \in \N^n$,
        \item si $\alpha < \beta$ entonces $\alpha + \gamma < \beta + \gamma,\ \text{para todo } \alpha,\beta,\gamma \in \N^n$.
    \end{enumerate}
\end{definicion}
\begin{proposicion}
    Todo orden admisible es un buen orden, esto es, todo subconjunto no vacío tiene un elemento mínimo.
\end{proposicion}

A partir de ahora siempre supondremos que todo orden que usemos es admisible en $\N^n$, luego podemos ordenar los monomios que conforman un polinomio ordenando sus exponentes según dicho orden. Veamos algunos de los órdenes más usados. 

\begin{definicion}
    Definimos el \textbf{orden lexicográfico} $\le_{\text{lex}}$ como
    \begin{equation*}
        \alpha \lex \beta \iff \begin{cases}
            \alpha  = \beta \\
            \quad\text{ó}   \\
            \alpha_i < \beta_i \text{, donde $i$ es el primer índice tal que } \alpha_i \neq \beta_i.
        \end{cases}
    \end{equation*}
\end{definicion}

% \begin{proof}
%     Es inmediato que es total, ya que $\le$ en $\N$ lo es. Veamos las otras condiciones.
%     \begin{enumerate}
%         \item Tomamos $\alpha \in \N^n$ tal que $\alpha\neq (0,\dots,0)$ y sea $i$ el primer índice tal que $\alpha_i \neq 0$. Entonces $0< \alpha_i$, de donde $(0,\dots, 0) \lex \alpha$.
%         \item Sean $\alpha$ y $\beta$ tales que $\alpha\lex \beta$, e $i$ el primer índice tal que $\alpha_i < \beta_i$
%     \end{enumerate}
% \end{proof}

\begin{definicion}
    Dado $\omega\in \N^n$, un orden admisible $\le$ se dice \textbf{$\boldsymbol{\omega}$-graduado} cuando
    \begin{equation*}
        \alpha\le \beta \text { implica que } \langle \alpha, \omega\rangle  < \langle \beta, \omega\rangle,
    \end{equation*}
    donde $\langle \alpha, \omega\rangle$ se llama el \textbf{$\boldsymbol{w}$-grado} de $\alpha$ y se define como
    \begin{equation}
        \langle \alpha, \omega\rangle = \alpha_1 \omega_1 + \cdots + \alpha_n \omega_n.
    \end{equation}
\end{definicion}

\begin{definicion}
    Dado un orden admisible $\le$, definimos el \textbf{orden $\boldsymbol{\omega}$-graduado asociado} como
    \begin{equation*}
        \alpha \le_{\omega} \beta \iff \begin{cases}
            \langle \alpha, \omega\rangle  < \langle \beta, \omega\rangle \\
            \quad\text{ó}   \\
           \langle \alpha, \omega\rangle = \langle \beta, \omega\rangle \text{ y } \alpha \le \beta.
        \end{cases}
    \end{equation*}
    Cuando $\omega = (1,\dots, 1)$ simplemente diremos que el orden es graduado, y usaremos las notaciones
    \begin{equation*}
        \le_{(1,\dots,1)} = \le_{\text{deg}},\quad (\lex)_{\text{deg}} = \le_{\text{deglex}},\quad (\lex)_{\omega} = \le_{\omega\text{-lex}}.
    \end{equation*}
\end{definicion}

\begin{definicion}
    Definimos el \textbf{orden lexicográfico graduado inverso} $\le_{\text{degrevlex}}$ como
    \begin{equation*}
        \alpha \le_{\text{degrevlex}} \beta \iff \begin{cases}
            |\alpha| < |\beta| \\
            \quad\text{ó}   \\
            |\alpha| = |\beta| \text{ y } \alpha_i > \beta_i \text{, donde $i$ es el último índice tal que } \alpha_i \neq \beta_i.
        \end{cases}
    \end{equation*}
\end{definicion}

\begin{proposicion}
    Sea $\le$ un orden admisible. Entonces $\le_{\omega}$ es admisible.
\end{proposicion}
\begin{proposicion}
    Los órdenes $\lex$ y $\le_{\text{degrevlex}}$ son admisibles.
\end{proposicion}

Una vez obtenida la noción de orden admisible, estamos en disposición de definir varios conceptos que nos resultarán imprescindibles para la manipulación de polinomios multivariable.

\begin{definicion}
    Sea $f= \sum_{\alpha} a_{\alpha} X^{\alpha}$ un polinomio y $\le$ un orden admisible. Definimos los siguientes conceptos asociados a $f$.
    \begin{itemize}
        \item \textbf{Exponente:} $exp(f) = \Max_{\le}(\alpha)$.
        \item \textbf{Monomio líder:}  $\lmf = X^{\expf}$.
        \item \textbf{Coeficiente líder:} $\lcf = a_{\expf}$.
        \item \textbf{Término líder:} $\ltf = \lcf \cdot \lmf$.
    \end{itemize}
\end{definicion}

\begin{definicion}
    Dado un monomio $X^{\alpha}$, definimos su \textbf{grado} como $\vert \alpha\vert = \alpha_1+\cdots + \alpha_n$. En el caso de un polinomio $f\in A[X]$, diremos que su grado es el grado de su monomio líder, y lo notaremos como $\deg(f)$.
\end{definicion}

Antes de presentar el algoritmo de la división, nos cercioramos de que esta operación siempre tiene sentido con el siguiente teorema.
\begin{teorema}[Algoritmo de división]
    Sea $F=\{f_1,\dots, f_s\} \subset A[X]$. Todo polinomio $f\in A[X]$ se puede expresar como
    \begin{equation*}
        f = q_1f_1 + \cdots + q_sf_s + r,
    \end{equation*}
    donde $q_i, r\in A[X]$ y $r=0$ ó $exp(r)\le exp(f)$. Llamaremos a $r$ el resto de dividir $f$ por $F$, y lo notaremos $\rem(f, [F]) = r$. Además, cuando $r=0$ diremos que $f$ reduce a $0$, y escribiremos $f \stackrel{F}{\to} 0$.
\end{teorema}

En otras palabras, podemos dividir $f$ entre cualquier conjunto de polinomios $F=\{f_1, \dots, f_s\}$ para expresarlo como combinación de sus elementos multiplicados por ciertos coeficientes polinómicos. El método es similar al usado en una variable, consistente en intentar reducir el monomio líder de $f$ restándole un múltiplo de cierto $f_i$. Para encontrar este $f_i$ simplemente se recorre el conjunto $F$ hasta encontrar uno válido, y de no haberlo se pasa el término líder al resto y se continua con el siguiente. Esto es justo lo que hace el \autoref{a:division}. Cabe destacar que esta forma de buscar el $f_i$ hace que la descomposición de $f$ obtenida no sea única, pues la elección dependerá de la posición que ocupen los divisores en el conjunto $F$, y por tanto del orden elegido. Más adelante veremos que la elección del orden influye en el resultado de más algoritmos.

\SetKwComment{Comment}{/* }{ */}
\begin{algorithm}[hbt!]
    \caption{División de polinomios en varias variables}\label{a:division}
    \KwData{dividendo $f$, divisores $F = \left[ f_1, \dots, f_s\right]$}
    \KwResult{Tupla con el resto $r$ y los coeficientes $q_i$ para cada $f_i\in F$}
    $p\gets f$
    
    $\left[q_1,\dots, q_s\right] \gets \left[0,\dots, 0\right]$
    
    $r\gets 0$

    \While{$p \neq 0$}{
        $\text{divisorEncontrado} \gets false$
        \For{$f_i \in F$} {
            \If{$\text{exp}(p) = \text{exp}(f_i) + \alpha$}{
                $q_i\gets q_i + \frac{\text{lc}(p)}{\text{lc}(f_i)} X^{\alpha}$
                
                $p \gets p - f_i \cdot \frac{\text{lc}(p)}{\text{lc}(f_i)} X^{\alpha}$
                
                $\text{divisorEncontrado} \gets true$
            }
        }
        \If{$!\text{divisorEncontrado}$}{
            $r \gets r + \text{lt}(p)$
            
            $p \gets p - \text{lt}(p)$
        }
    }
    \Return{$\left[r,q_1,\dots, q_s\right]$}
\end{algorithm}

\subsection{Bases de Groebner}
Ya tenemos claras las ideas sobre qué es un polinomio en varias variables, así que ahora pasamos a repasar el concepto de ideal y cómo podemos usar las bases de Groebner para trabajar con ellos en el caso de ideales de polinomios.
\begin{definicion}
    Decimos que $\emptyset \neq I \subseteq A[X]$ es un \textbf{ideal} de $A[X]$ si
    \begin{enumerate}
        \item $0\in I$,
        \item $a+b\in I,\ \text{para todo } a,b\in I$,
        \item $af\in I,\ \text{para todo } a\in I,\ \text{para todo } f\in A[x]$.
    \end{enumerate}
    En ese caso escribiremos $I\le A$.
\end{definicion}

\begin{proposicion}
    Dados los ideales $I,J\le A[X]$, son también ideales de $A[X]$:
    \begin{enumerate}
        \item $I+J = \{f+g : f\in I, g\in J\}$,
        \item $IJ = \{f_1g_1 + \cdots + f_tg_t : f_i\in I, g_i\in J, 1\le i \le t\}$,
        \item $I\cap J = \{h: h\in I \text{ y } h\in J\}$.
    \end{enumerate}
\end{proposicion}

Podemos calcular estos ideales usando sus conjuntos de generadores.
\begin{definicion}
    Dado $F=\{f_1,\dots, f_s\}\subseteq A[X]$, el \textbf{ideal generado} por $F$ es
    \begin{equation*}
        \langle F \rangle = \{a_1f_1 + \cdots + a_sf_s : a_1,\dots, a_s\in A,\ f_1,\dots, f_s\in F\}\le A[X].
    \end{equation*}
    Diremos que $F$ es un \textbf{conjunto de generadores} de $I$.
\end{definicion}

\begin{proposicion}
    Sean $I=\langle F\rangle$ y $J=\langle G\rangle$ ideales de $A[X]$. Entonces
    \begin{enumerate}
        \item $I+J = \langle F\cup G\rangle$,
        \item $IJ = \langle fg : f\in F, g\in G \rangle$,
        \item $I\cap J = \langle tF, (1-t)G \rangle \cap A[x_1,\dots, x_n]$.
    \end{enumerate}
\end{proposicion}

Pasamos a presentar el concepto de base de Groebner asociada a un ideal. Podemos pensar que una base de Groebner es a un ideal lo que un sistema de generadores a un espacio vectorial: un subconjunto a partir del cual podemos obtener el total.
\begin{definicion}
    Sea $I\le A[X]$. Denotamos el conjunto de los términos líder de $I$ como
    \begin{equation*}
        \lt(I) = \{\lt(f) : f\in I\}.
    \end{equation*}
\end{definicion}

\begin{definicion}
    Dado $I\le A[X]$, diremos que $G = \{g_1,\dots, g_s\}\subseteq I$ es una \textbf{base de Groebner} para $I$ si 
    $$\langle \lt(I)\rangle = \langle \lt(g_1),\dots, \lt(g_t) \rangle.$$
\end{definicion}

La analogía con el sistema de generadores de un espacio vectorial nos conduce de forma natural a la pregunta de si habrá también un análogo al concepto de base, y si dado un ideal $I$ siempre existirá una base de Groebner asociada a este. La respuesta es afirmativa en ambos casos.
\begin{definicion}
    Dada $f\in A[X]$, definimos su \textbf{soporte} como $$\supp(f) = \{ \alpha\in\Nn : f(\alpha) \neq 0\}.$$
\end{definicion}

\begin{definicion}
    Sea $I\le A[X]$. Diremos que $G$ es una \textbf{base de Groebner reducida} para $I$ si para todo $g\in G$ se cumple
    \begin{enumerate}
        \item $\lcg=1$,
        \item $\supp(g) \cap \left(\exp(G\setminus\{g\}) + \Nn \right) = \emptyset$.
    \end{enumerate}
    Es decir, una base será reducida si ningún elemento se puede expresar como combinación del resto. Esto equivale a que
    \begin{equation*}
        \rem\left(g, G\setminus \{g\}\right) \neq 0,\ \text{para todo } g\in G.
    \end{equation*}
\end{definicion}

\begin{definicion}
    Sea $M\le \Nn$. Decimos que $A$ es un \textbf{conjunto generador minimal} de $M$ si
    \begin{equation*}
        M = A + \Nn \quad \text{ y } \quad M\neq (A\setminus \{a\}) + \Nn,\ \text{para todo } a \in A.
    \end{equation*}
\end{definicion}

\begin{lema}\label{l:minimal}
    Todo ideal tiene un único conjunto generador minimal.
\end{lema}
\begin{lema}
    Sea $I\le A$. Se cumple que $a-b\in I,\ \text{para todo } a,b\in I$. 
\end{lema}
\begin{proof}\label{l:resta}
    Basta observar que tomando $-1 \in A$ obtenemos que $b\cdot (-1) \in I$, de donde
    \begin{equation*}
        a-b = a+ b(-1) \in I.\qedhere
    \end{equation*}
\end{proof}
\begin{teorema}\label{t:reduce}
    Todo ideal $I$ admite una única base de Groebner reducida para un orden admisible dado.
\end{teorema}
\begin{proof}
    \mybox{Existencia} Sea $G$ un conjunto generador minimal de $\exp(I)$, que sabemos que existe por el \autoref{l:minimal}. Sea $g\in G$ y $r = \rem\left(g, [G\setminus \{g\}]\right)$. Tenemos que
    \begin{equation*}
        \exp(g) \notin \exp(G\setminus\{g\}) + \Nn \text{ luego } \exp(g)=\exp(r),
    \end{equation*}
    de donde
    \begin{equation*}
        \exp(G) = \exp\Big( (G\setminus \{g\})\cup \{r\}\Big).
    \end{equation*}
    Además $g-r\in \langle G\setminus \{g\} \rangle \subseteq I$, de forma que $r\in I$ y $G' = (G\setminus \{g\} \cup \{r\}$ es una base de Groebner de $I$ cumpliendo $\supp(r) \cap \Big(\exp(G'\setminus\{r\}) + \Nn \Big) = \emptyset$.
    Aplicando este procedimiento a cada elemento de $G$ obtenemos una base reducida de $I$.\\[5pt]
    \mybox{Unicidad} Sean $G_1,G_2$ dos bases minimales de $I$. Por el \autoref{l:minimal}, como $\exp(G_1) = \exp(G_2)$, dado cualquier $g_1\in G_1$, no existe ningún $g_2\in G_2$ tal que $\exp(g_1) = \exp(g_2)$. Por otro lado, se cumple
    \begin{enumerate}
        \item $ \supp(g_1-g_2) \subseteq \Big( \supp(g_1)\cup \supp(g_2) \Big) \setminus \{\exp(g_1)\}$,
        \item $\supp(g_i)\setminus \{\exp(g_i)\}\cap \Big(\{\exp(G_i) + \Nn\}\Big) = \varnothing,\ i\in\{1,2\}$,
    \end{enumerate}
    de donde
    \begin{equation*}
        \supp(g_1-g_2) \cap \left(\exp(G_1)+\Nn\right) = \varnothing.
    \end{equation*}
    Concluimos entonces que $\rem(g_1-g_2, G_1) = g_1-g_2$, y como por el  \autoref{l:resta} sabemos que $g_2-g_1\in I$, dicho resto será igual a cero, de forma que $g_1=g_2$ y $G_1 = G_2$.
\end{proof}

Terminamos la sección obteniendo un algoritmo para calcular la base de Groebner reducida para un ideal dado un conjunto de generadores suyo $G$. Este se basará en eliminar de $G$ aquellos polinomios cuyos exponentes podamos poner como combinación lineal del resto. Claro está que no podemos realizar esta comprobación directamente, y deberemos buscar alguna condición equivalente que sí podamos calcular.

\begin{definicion}
    Dados $\alpha,\beta \in \Nn$, definimos los términos
    \begin{itemize}
        \item \textbf{Mínimo común múltiplo}: $\lcm(\alpha,\beta) = \{\Max(\alpha_1, \beta_1),\dots, \Max(\alpha_n, \beta_n)\}$,
        \item \textbf{Máximo común divisor}: $\gcd(\alpha,\beta) = \{\Min(\alpha_1, \beta_1),\dots, \Min(\alpha_n, \beta_n)\}$.
    \end{itemize}
\end{definicion}

\begin{definicion}
    Sean $f,g \in A[X]$. Tomando $\alpha=\exp(f),\ \beta=\exp(g)$ y $\gamma = \lcm(\alpha,\beta)$, se define el \textbf{S-polinomio} de $f$ y $g$ como
    \begin{equation*}
        S(f,g) = \lc(g)X^{\gamma-\alpha}f - \lc(f)X^{\gamma-\beta}g.
    \end{equation*}
\end{definicion}

\begin{teorema}[Primer Criterio de Buchberger]\label{t:criterio}
    Sean $I\le A[X]$ y $G=\{g_1,\dots, g_t\}$ un conjunto de generadores de $I$. Entonces:
    \begin{equation*}
        G \text{ es base de Groebner para } I \iff \rem(S(g_i,g_j), G)=0,\ \text{para todo } 1\le i<j\le t.
    \end{equation*}
\end{teorema}

El algoritmo que usaremos para el cálculo de la base de Groebner se basará en este criterio. Sin embargo, antes de presentarlo estudiamos dos criterios adicionales \cite{criterio1,criterio2} que lo harán más eficiente descartando S-polinomios antes de comprobar su resto, ahorrando el cómputo de numerosas divisiones.

\begin{definicion}
    Sea $f= \sum_{\alpha} a_{\alpha} X^{\alpha}$ un polinomio cuyo monomio líder es $X^{\alpha^{(k)}}$ y $\le$ un orden admisible. Definimos el \textbf{segundo monomio líder} de $f$ como el monomio $X^{\alpha^{(i)}}$ de $f$ tal que
    \begin{equation*}
        X^{\alpha^{(i)}} \ge X^{\alpha^{(j)}},\ \text{ para todo } j\notin\{i,k\}. 
    \end{equation*}
    Lo denotaremos como $\sm(f)$.
\end{definicion}
\begin{teorema}[Criterios de Buchberger]\label{t:criterios}
    Sean $I\le A[X]$, $G\subseteq A[X]$ un conjunto de generadores de $I$, y $g_1,g_2 \in G$. Si se cumple cualquiera de las siguientes condiciones entonces  $S(g_1,g_2)\reduces 0$.
    \begin{enumerate}
        \item $\lcm(g_1,g_2) = \lm(g_1)\lm(g_2)$,
        \item existe un $f\in G$ tal que $\lm(f)\ \vert\ \lcm(g_1,g_2)$ y además
        \begin{enumerate}
            \item algún $S(g_i,f)\reduces 0\quad$ ó
            \item $\lm(f)\vert \frac{\lm(g_i)}{\gcd(g_1,g_2}$ y $\sm(g_j)\lm(f) \neq \sm(f)\lm(g_j)$,
        \end{enumerate}
        donde $i,j\in\{1,2\}$ e $i\neq j$.
    \end{enumerate}
    
\end{teorema}

Usando los criterios obtenidos obtenemos el \autoref{a:buchberger} para calcular la base de Groebner de cualquier ideal. La salida de este no es una base minimal, pero la demostración del \autoref{t:reduce} nos proporciona un método para reducir una base cualquiera a la minimal asociada. En el \autoref{a:minim} mostramos este procedimiento.\newline

\SetKwComment{Comment}{/* }{ */}
\begin{algorithm}[hbt!]
    \caption{Algoritmo de Buchberger optimizado}\label{a:buchberger}
    \KwData{polinomio $f$, conjunto de generadores $F = \left[ f_1, \dots, f_S\right]$}
    \KwResult{base de Groebner $G$}

    $G\gets F$\;

    \Repeat{$G' = G$}{
        $G'\gets G$\;
        \For{each pair $\{f,g\} \subseteq G'$} {
            \If{$\text{!Criterio 1}(f,g) \textbf{ AND } !\text{Criterio 2}(f,g, G')$}{
                $r\gets \rem(S(f,g), G')$\;
                \If{$r\neq 0$}{
                    $G\gets G\cup \{r\}$\;
                }
            }
        }
    }

    \Return{$G$}
\end{algorithm}

\begin{algorithm}[hbt!]
    \caption{Minimización de base de Groebner}\label{a:minim}
    \KwData{$G$ base a minimizar}

    $G\gets F$\;

    \ForEach {$g \in G$}{
        $g\gets g/\lc(g)$\;
        $r\gets \rem(g, [G\setminus \{g\}])$\;

        \If{$r\neq 0$}{
            $g \gets r$\;
        }
    }
\end{algorithm}

Ya somos capaces de obtener una base de Groebner minimal de cualquier ideal dado un conjunto de generadores suyo, pero en este proceso se toma una decisión que aún no hemos discutido: cómo se eligen las parejas $\{f,g\}$. Uno de los métodos más usados es la conocida como \textbf{estrategia normal}, debido a su simpleza y haber probado ser de las que completan más rápido el algoritmo, y consiste en tomar el par $f,g$ cuyo $\lcm(f,g)$ sea del menor grado posible según el orden admisible usado. Vemos por tanto que de nuevo la elección de un orden u otro nos proporcionará resultados diferentes, y en este caso esto se traduce en que la base reducida tenga muchos menos elementos en un orden que en otro.

\subsection{Teorema de implicitación}
Empezábamos la sección diciendo que el problema de implicitación equivalía al de pertenencia a un ideal. Antes de ver de qué ideal se trata tenemos que introducir unos últimos conceptos que nos ayuden a entender por qué.

\begin{definicion}Dado $F=\{f_1,\dots, f_s\} \subseteq A[X]$, llamamos \textbf{variedad afín} definida por $F$ al conjunto:
    \begin{equation*}
        \mathbb{V}(F) = \{(a_1,\dots, a_n)\in A^n : f_i(a_1,\dots, a_n)=0,\ \text{para todo } i\in\{1,\dots, s\}\}.
    \end{equation*}
\end{definicion}

\begin{proposicion}
    Sean $\mathbb{V}(F)$ y $\mathbb{V}(G)$ variedades afines. Entonces
    \begin{itemize}
        \item  $\mathbb{V}(F) =  \mathbb{V}(\langle F\rangle)$,
        \item $\mathbb{V}(F\cup G) = \mathbb{V}(F) \cap \mathbb{V}(G)$,
        \item $\mathbb{V}(FG) = \mathbb{V}(F) \cup \mathbb{V}(G)$.
    \end{itemize}
\end{proposicion}

\begin{proposicion}
    Sean los ideales $I,J\le A[X]$. Entonces  $\mathbb{V}(I \cap J) = \mathbb{V}(I) \cup \mathbb{V}(J)$.
\end{proposicion}
\begin{definicion}
    Sea $B\subseteq A^n$. Definimos el \textbf{ideal asociado} a $B$ como
    \begin{equation*}
        \mathbb{I}(B) = \{f\in A[X] : f(b_1,\dots, b_n) = 0,\ \text{para todo } (b_1,\dots, b_n)\in B\}.
    \end{equation*}
\end{definicion}

Para resolver el problema de implicitación deberemos aprender antes a eliminar variables de un ideal.
\begin{definicion}
    Dado $I\le A[x_1,\dots,x_n]$, definimos su \textbf{ideal de $l$-eliminación} como
    \begin{equation*}
        I_l = I \cap A[x_{l+1}, \dots, x_n] \le A[x_{l+1}, \dots, x_n].
    \end{equation*}
\end{definicion}

\begin{definicion}
    Decimos que un orden admisible $\le$ es un \textbf{orden de $l$-eliminación} si 
    $$\beta\le \alpha \text{ implica } \beta \in \N_l^n,\ \text{para todo } \alpha \in \N_l^n \text{ y } \text{para todo } \beta \in \Nn,$$
    donde $\N_l^n = \{\alpha\in \Nn \colon \alpha_i =0,\ 1\le i \le l\}$.
\end{definicion}

\begin{teorema}[Eliminación]
    Sea $I\le A[x_1,\dots,x_n]$ y $G$ una base de Groebner suya respecto a un orden $\le$ de $l$-eliminación. Entonces, una base de Groebner para $I_l$ viene dada por
    \begin{equation*}
        G_l = G\cap A[x_{l+1},\dots, x_n].
    \end{equation*}
\end{teorema}

% Ahora sí, veamos de qué ideal se trata.

Con estos resultados podemos decir que el problema de implicitación consiste en encontrar la variedad asociada a las ecuaciones paramétricas
\begin{equation*}
    \begin{cases}
    x_1 &= g_1(t_1,\dots, t_r),\\
    &\vdots \label{eq:paramEq} \\
    x_n &= g_n(t_1,\dots, t_r).
    \end{cases}
\end{equation*}
Si escribimos $g_i = f_i/q_i$ con $f_i,q_i \in A[t_1,\dots, t_r]$ para $i=1,\dots, r$, podemos definir la aplicación
\begin{align*}
        \phi \colon A^r\setminus W  & \to A^n,\\
        (a_1,\dots, a_r) & \mapsto \left( \frac{f_1(a_1,\dots, a_r)}{q_1(a_1,\dots, a_r)}, \dots, \frac{f_n(a_1,\dots, a_r)}{q_n(a_1,\dots, a_r)}\right),
    \end{align*}
donde $W=\mathbb{V}(q_1\cdots q_r)$. Veamos cómo encontrar la menor variedad que contiene la imagen de $\phi$ en el caso de que $q_i = 1$ para cada $i\in \{1,\dots, r\}$. 
\begin{teorema}[Implicitación Polinomial]\label{t:implicit}
    Dados $f_1,\dots, f_n \in A[t_1, \dots, t_r]$ con $A$ cuerpo infinito, sea
    \begin{align*}
        \phi \colon A^r  & \to A^n,\\
        (a_1,\dots, a_r) & \mapsto \left( f_1(a_1,\dots, a_r), \dots, f_n(a_1,\dots, a_r) \right).
    \end{align*}
    Definimos los ideales:
    \begin{itemize}
        \item $I = \langle x_1-f_1,\dots,  x_n-f_n\rangle \le A[t_1,\dots, t_r,x_1\dots, x_n]$,
        \item $J = I\cap A[x_1,\dots, x_n]$ el ideal de $r$-eliminación de $I$.
    \end{itemize}
    Entonces, $\mathbb{V}(J)$ es la menor variedad que contiene a $\phi(A^r)$.
\end{teorema}


La extensión al caso racional es la siguiente.
\begin{teorema}[Implicitación Racional]\label{t:implicitRac}
    Sea $f_1,\dots, f_n, q_1,\dots, q_n \in A[t_1, \dots, t_r]$ con $A$ cuerpo infinito, $W=\mathbb{V}(q_1,\dots, q_n)$ y
    \begin{align*}
        \phi \colon A^r\setminus W  & \to A^n,\\
        (a_1,\dots, a_r) & \mapsto \left( \frac{f_1(a_1,\dots, a_r)}{q_1(a_1,\dots, a_r)}, \dots, \frac{f_n(a_1,\dots, a_r)}{q_n(a_1,\dots, a_r)}\right).
    \end{align*}
     Definimos los ideales:
    \begin{itemize}
        \item $I = \langle q_1x_1-f_1,\dots,  q_nx_n-f_n, 1-q_1\cdots q_ny\rangle \le A[y,t_1,\dots, t_r,x_1\dots, x_n]$,
        \item $J = I\cap A[x_1,\dots, x_n]$ el ideal de $1+r$-eliminación de $I$.
    \end{itemize}
    Entonces, $\mathbb{V}(J)$ es la menor variedad que contiene a $\phi(A^r\setminus W)$.
\end{teorema}

\begin{observacion}
    En el caso $r=1$ y cuando $f_i$ y $q_i$ sean primos relativos para cada $1\le i \le n$, basta tomar
    $$I = \langle q_1x_1-f_1,\dots,  q_nx_n-f_n\rangle.$$
\end{observacion}

Con este resultado, una vez obtenida la variedad, si resulta que esta tiene un único generador este será una potencia la ecuación implícita, luego el ideal al que llevamos haciendo referencia desde el principio de la sección y del que queríamos comprobar la pertenencia es el ideal $J$ de los teoremas anteriores. El hecho de que no obtengamos la potencia exacta de la ecuación implícita no es problema, pues nos basta conocer donde se anula para poder representar la frontera de la superficie que genera.  Sin embargo, no tenemos asegurado que vaya a haber un único generador del ideal, de forma que la superficie satisfaría varias ecuaciones implícitas y no podría ser representada por una sola. A continuación presentamos un resultado que aporta información al respecto.

\begin{definicion}
    Dado un ideal $I\le A[X]$, definimos su radical como
    \begin{equation*}
        \sqrt{I} = \{f\in A[X] : f^m\in I \text{ para algún } m\in \N\}.
    \end{equation*}
\end{definicion}
\begin{proposicion}
    Sea $I\le A[X]$. Entonces $\sqrt{I}$ es un ideal y contiene a $I$.
\end{proposicion}
\begin{definicion}
    Decimos que un ideal $I\le A[X]$ es \textbf{radical} si $\sqrt{I} = I$.
\end{definicion}

\begin{proposicion}
    Sea $B\subseteq A^n$. Entonces $\mathbb{I}(B)$ es un ideal radical.
\end{proposicion}
\begin{teorema}[Nullstellensatz fuerte]
    Si $A$ es algebraicamente cerrado, dado un ideal $I\le A[X]$ se cumple
    \begin{equation*}
        \sqrt{I} = \mathbb{I}(\mathbb{V}(I)).
    \end{equation*}
\end{teorema}
\begin{proposicion}
    Sea $I\le A[X]$ y $f\in A[X]$. Entonces
    \begin{equation*}
        f\in \sqrt{I} \text{ si y solo si } \langle I \rangle + \langle 1-fy \rangle = A[X].
    \end{equation*}
\end{proposicion}
Así, si pudiéramos calcular el radical del ideal $J$ de los teoremas de implicitación y este tuviera un solo elemento, tendríamos asegurado que la variedad está generada por esa única ecuación implícita. Además, calculando el radical podríamos obtener también la potencia exacta de la ecuación implícita que obtuvimos con el \autoref{t:implicitRac}. Sin embargo, el cálculo del radical o su número de elementos es en general muy complicado, y no es una opción viable. Por tanto, lo que haremos en la práctica será simplemente aplicar el algoritmo y comprobar si efectivamente se obtiene un único generador, en cuyo caso contrario concluiremos que no podemos realizar la implicitación.\newline

Hay otros métodos diferentes que permiten abordar el problema de eliminación de variables, y por tanto el de implicitación. Uno especialmente interesante es el uso de resultantes, pues en casos específicos puede simplificar mucho la obtención de la ecuación implícita. En la siguiente sección estudiaremos como podemos usar de forma básica el resultante del sistema de ecuaciones \eqref{eq:paramEq} para obtener su representación implícita.
