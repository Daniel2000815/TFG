{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SVG = exports.XLINKNS = exports.SVGNS = void 0;\n\nvar OutputJax_js_1 = require(\"./common/OutputJax.js\");\n\nvar WrapperFactory_js_1 = require(\"./svg/WrapperFactory.js\");\n\nvar tex_js_1 = require(\"./svg/fonts/tex.js\");\n\nvar FontCache_js_1 = require(\"./svg/FontCache.js\");\n\nvar string_js_1 = require(\"../util/string.js\");\n\nvar lengths_js_1 = require(\"../util/lengths.js\");\n\nexports.SVGNS = 'http://www.w3.org/2000/svg';\nexports.XLINKNS = 'http://www.w3.org/1999/xlink';\n\nvar SVG = function (_super) {\n  __extends(SVG, _super);\n\n  function SVG(options) {\n    if (options === void 0) {\n      options = null;\n    }\n\n    var _this = _super.call(this, options, WrapperFactory_js_1.SVGWrapperFactory, tex_js_1.TeXFont) || this;\n\n    _this.minwidth = 0;\n    _this.shift = 0;\n    _this.container = null;\n    _this.svgStyles = null;\n    _this.fontCache = new FontCache_js_1.FontCache(_this);\n    return _this;\n  }\n\n  SVG.prototype.initialize = function () {\n    if (this.options.fontCache === 'global') {\n      this.fontCache.clearCache();\n    }\n  };\n\n  SVG.prototype.clearFontCache = function () {\n    this.fontCache.clearCache();\n  };\n\n  SVG.prototype.reset = function () {\n    this.clearFontCache();\n  };\n\n  SVG.prototype.setScale = function (node) {\n    if (this.options.scale !== 1) {\n      this.adaptor.setStyle(node, 'fontSize', (0, lengths_js_1.percent)(this.options.scale));\n    }\n  };\n\n  SVG.prototype.escaped = function (math, html) {\n    this.setDocument(html);\n    return this.html('span', {}, [this.text(math.math)]);\n  };\n\n  SVG.prototype.styleSheet = function (html) {\n    if (this.svgStyles) {\n      return this.svgStyles;\n    }\n\n    var sheet = this.svgStyles = _super.prototype.styleSheet.call(this, html);\n\n    this.adaptor.setAttribute(sheet, 'id', SVG.STYLESHEETID);\n    return sheet;\n  };\n\n  SVG.prototype.pageElements = function (html) {\n    if (this.options.fontCache === 'global' && !this.findCache(html)) {\n      return this.svg('svg', {\n        id: SVG.FONTCACHEID,\n        style: {\n          display: 'none'\n        }\n      }, [this.fontCache.getCache()]);\n    }\n\n    return null;\n  };\n\n  SVG.prototype.findCache = function (html) {\n    var adaptor = this.adaptor;\n    var svgs = adaptor.tags(adaptor.body(html.document), 'svg');\n\n    for (var i = svgs.length - 1; i >= 0; i--) {\n      if (this.adaptor.getAttribute(svgs[i], 'id') === SVG.FONTCACHEID) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  SVG.prototype.processMath = function (math, parent) {\n    var container = this.container;\n    this.container = parent;\n    var wrapper = this.factory.wrap(math);\n\n    var _a = __read(this.createRoot(wrapper), 2),\n        svg = _a[0],\n        g = _a[1];\n\n    this.typesetSVG(wrapper, svg, g);\n    this.container = container;\n  };\n\n  SVG.prototype.createRoot = function (wrapper) {\n    var _a = wrapper.getOuterBBox(),\n        w = _a.w,\n        h = _a.h,\n        d = _a.d,\n        pwidth = _a.pwidth;\n\n    var px = wrapper.metrics.em / 1000;\n    var W = Math.max(w, px);\n    var H = Math.max(h + d, px);\n    var g = this.svg('g', {\n      stroke: 'currentColor',\n      fill: 'currentColor',\n      'stroke-width': 0,\n      transform: 'scale(1,-1)'\n    });\n    var adaptor = this.adaptor;\n    var svg = adaptor.append(this.container, this.svg('svg', {\n      xmlns: exports.SVGNS,\n      width: this.ex(W),\n      height: this.ex(H),\n      role: 'img',\n      focusable: false,\n      style: {\n        'vertical-align': this.ex(-d)\n      },\n      viewBox: [0, this.fixed(-h * 1000, 1), this.fixed(W * 1000, 1), this.fixed(H * 1000, 1)].join(' ')\n    }, [g]));\n\n    if (W === .001) {\n      adaptor.setAttribute(svg, 'preserveAspectRatio', 'xMidYMid slice');\n\n      if (w < 0) {\n        adaptor.setStyle(this.container, 'margin-right', this.ex(w));\n      }\n    }\n\n    if (pwidth) {\n      adaptor.setStyle(svg, 'min-width', this.ex(W));\n      adaptor.setAttribute(svg, 'width', pwidth);\n      adaptor.removeAttribute(svg, 'viewBox');\n      var scale = this.fixed(wrapper.metrics.ex / (this.font.params.x_height * 1000), 6);\n      adaptor.setAttribute(g, 'transform', \"scale(\".concat(scale, \",-\").concat(scale, \") translate(0, \").concat(this.fixed(-h * 1000, 1), \")\"));\n    }\n\n    if (this.options.fontCache !== 'none') {\n      adaptor.setAttribute(svg, 'xmlns:xlink', exports.XLINKNS);\n    }\n\n    return [svg, g];\n  };\n\n  SVG.prototype.typesetSVG = function (wrapper, svg, g) {\n    var adaptor = this.adaptor;\n    this.minwidth = this.shift = 0;\n\n    if (this.options.fontCache === 'local') {\n      this.fontCache.clearCache();\n      this.fontCache.useLocalID(this.options.localID);\n      adaptor.insert(this.fontCache.getCache(), g);\n    }\n\n    wrapper.toSVG(g);\n    this.fontCache.clearLocalID();\n\n    if (this.minwidth) {\n      adaptor.setStyle(svg, 'minWidth', this.ex(this.minwidth));\n      adaptor.setStyle(this.container, 'minWidth', this.ex(this.minwidth));\n    } else if (this.shift) {\n      var align = adaptor.getAttribute(this.container, 'justify') || 'center';\n      this.setIndent(svg, align, this.shift);\n    }\n  };\n\n  SVG.prototype.setIndent = function (svg, align, shift) {\n    if (align === 'center' || align === 'left') {\n      this.adaptor.setStyle(svg, 'margin-left', this.ex(shift));\n    }\n\n    if (align === 'center' || align === 'right') {\n      this.adaptor.setStyle(svg, 'margin-right', this.ex(-shift));\n    }\n  };\n\n  SVG.prototype.ex = function (m) {\n    m /= this.font.params.x_height;\n    return Math.abs(m) < .001 ? '0' : m.toFixed(3).replace(/\\.?0+$/, '') + 'ex';\n  };\n\n  SVG.prototype.svg = function (kind, properties, children) {\n    if (properties === void 0) {\n      properties = {};\n    }\n\n    if (children === void 0) {\n      children = [];\n    }\n\n    return this.html(kind, properties, children, exports.SVGNS);\n  };\n\n  SVG.prototype.unknownText = function (text, variant) {\n    var metrics = this.math.metrics;\n    var scale = this.font.params.x_height / metrics.ex * metrics.em * 1000;\n    var svg = this.svg('text', {\n      'data-variant': variant,\n      transform: 'scale(1,-1)',\n      'font-size': this.fixed(scale, 1) + 'px'\n    }, [this.text(text)]);\n    var adaptor = this.adaptor;\n\n    if (variant !== '-explicitFont') {\n      var c = (0, string_js_1.unicodeChars)(text);\n\n      if (c.length !== 1 || c[0] < 0x1D400 || c[0] > 0x1D7FF) {\n        var _a = __read(this.font.getCssFont(variant), 3),\n            family = _a[0],\n            italic = _a[1],\n            bold = _a[2];\n\n        adaptor.setAttribute(svg, 'font-family', family);\n\n        if (italic) {\n          adaptor.setAttribute(svg, 'font-style', 'italic');\n        }\n\n        if (bold) {\n          adaptor.setAttribute(svg, 'font-weight', 'bold');\n        }\n      }\n    }\n\n    return svg;\n  };\n\n  SVG.prototype.measureTextNode = function (text) {\n    var adaptor = this.adaptor;\n    text = adaptor.clone(text);\n    adaptor.removeAttribute(text, 'transform');\n    var ex = this.fixed(this.font.params.x_height * 1000, 1);\n    var svg = this.svg('svg', {\n      position: 'absolute',\n      visibility: 'hidden',\n      width: '1ex',\n      height: '1ex',\n      viewBox: [0, 0, ex, ex].join(' ')\n    }, [text]);\n    adaptor.append(adaptor.body(adaptor.document), svg);\n    var w = adaptor.nodeSize(text, 1000, true)[0];\n    adaptor.remove(svg);\n    return {\n      w: w,\n      h: .75,\n      d: .2\n    };\n  };\n\n  SVG.NAME = 'SVG';\n  SVG.OPTIONS = __assign(__assign({}, OutputJax_js_1.CommonOutputJax.OPTIONS), {\n    internalSpeechTitles: true,\n    titleID: 0,\n    fontCache: 'local',\n    localID: null\n  });\n  SVG.commonStyles = {\n    'mjx-container[jax=\"SVG\"]': {\n      direction: 'ltr'\n    },\n    'mjx-container[jax=\"SVG\"] > svg': {\n      overflow: 'visible',\n      'min-height': '1px',\n      'min-width': '1px'\n    },\n    'mjx-container[jax=\"SVG\"] > svg a': {\n      fill: 'blue',\n      stroke: 'blue'\n    }\n  };\n  SVG.FONTCACHEID = 'MJX-SVG-global-cache';\n  SVG.STYLESHEETID = 'MJX-SVG-styles';\n  return SVG;\n}(OutputJax_js_1.CommonOutputJax);\n\nexports.SVG = SVG;","map":{"version":3,"mappings":"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","names":["exports","__extends","options","_super","WrapperFactory_js_1","tex_js_1","_this","fontCache","FontCache_js_1","SVG","clearCache","clearFontCache","node","scale","adaptor","setStyle","math","html","setDocument","text","svgStyles","sheet","styleSheet","call","setAttribute","STYLESHEETID","findCache","svg","id","FONTCACHEID","style","display","getCache","svgs","tags","body","document","i","length","getAttribute","parent","container","wrapper","factory","wrap","createRoot","g","typesetSVG","getOuterBBox","w","h","d","pwidth","px","metrics","em","W","Math","max","H","stroke","fill","transform","append","xmlns","width","ex","height","role","focusable","viewBox","fixed","join","removeAttribute","font","params","x_height","concat","minwidth","shift","useLocalID","localID","insert","toSVG","clearLocalID","align","setIndent","m","abs","toFixed","replace","kind","properties","children","variant","c","getCssFont","family","italic","bold","clone","position","visibility","nodeSize","remove","__assign","OutputJax_js_1","OPTIONS","internalSpeechTitles","titleID","direction","overflow"],"sourceRoot":"","sources":["../../ts/output/svg.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}