{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\daniz\\\\TFG\\\\Aplicacion\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:\\\\Users\\\\daniz\\\\TFG\\\\Aplicacion\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\daniz\\\\TFG\\\\Aplicacion\\\\src\\\\CustomNodes\\\\PrimitiveNode.js\";\nimport React, { useEffect } from \"react\";\nimport CustomNode from \"../CustomNodes/CustomNode\";\nimport FloatInput from \"../CustomComponents/FloatInput.js\";\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\nimport useLocalStorage from \"../storageHook\";\nvar theme = createTheme({\n  palette: {\n    primary: {\n      light: '#92bcff',\n      main: '#609dff',\n      dark: '#166cf5',\n      contrastText: 'white'\n    }\n  }\n});\nvar Primitives = {\n  Sphere: \"Sphere\",\n  Box: \"Box\",\n  Torus: \"Torus\",\n  Cylinder: \"Cylinder\"\n};\nexport default function PrimitiveNode(_ref) {\n  var _storage$primitive,\n      _this = this;\n\n  var data = _ref.data,\n      id = _ref.id;\n\n  var _React$useState = React.useState(\"sphere\"),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      primitive = _React$useState2[0],\n      setPrimitive = _React$useState2[1];\n\n  var _React$useState3 = React.useState(\"\"),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      sdf = _React$useState4[0],\n      setSdf = _React$useState4[1];\n\n  var _React$useState5 = React.useState([1.0, 1.0, 1.0]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      inputs = _React$useState6[0],\n      setInputs = _React$useState6[1];\n\n  var _React$useState7 = React.useState([\"Radius\", \"\", \"\"]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      inputLabels = _React$useState8[0],\n      setInputLabels = _React$useState8[1];\n\n  var _useLocalStorage = useLocalStorage('user_implicits', {}),\n      _useLocalStorage2 = _slicedToArray(_useLocalStorage, 2),\n      storage = _useLocalStorage2[0],\n      setStorage = _useLocalStorage2[1];\n\n  var prepareInputs = function prepareInputs(label1) {\n    var label2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    var label3 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n    setInputLabels([label1, label2, label3]);\n    setInputsActive([label1, label2, label3]);\n  };\n\n  var handleInputChange = function handleInputChange(newVal, idx) {\n    var newInputs = _toConsumableArray(inputs);\n\n    newInputs[idx] = newVal;\n    setInputs(newInputs);\n  };\n\n  useEffect(function () {\n    /*\r\n    console.log(\"ACTUALIZADO SDF\");\r\n    if (primitive == Primitives.Sphere) {\r\n      setSdf(`sphere(p, ${inputs[0].toFixed(4)})`);\r\n      prepareInputs(\"radius\");\r\n    } else if (primitive == Primitives.Box) {\r\n      setSdf(\r\n        `box(p, vec3(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}, \r\n          ${inputs[2].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"sx\", \"sy\", \"sz\");\r\n    } else if (primitive == Primitives.Torus) {\r\n      setSdf(\r\n        `torus(p, vec2(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"hole\", \"thickness\");\r\n    } else if (primitive == Primitives.Cylinder) {\r\n      setSdf(\r\n        `cylinder(p, \r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n        )`\r\n      );\r\n      prepareInputs(\"height\", \"radius\");\r\n    }\r\n      console.log(storage);\r\n    */\n    var parameters = storage[primitive].parameters;\n    console.log(\"TYPE: \" + typeof parameters[0].defaultVal);\n    setInputs(Object.keys(parameters).map(function (k) {\n      return parameters[k].defaultVal.toFixed(4);\n    }));\n    setInputLabels(Object.keys(parameters).map(function (k) {\n      return parameters[k].label;\n    })); // setInputs(Array(parameters.length).fill().map((_, idx) => parameters[idx].defaultVal));\n\n    console.log(parameters);\n    console.log(primitive);\n  }, [primitive]);\n  useEffect(function () {\n    var parameters = storage[primitive].parameters;\n    setSdf(\"\".concat(primitive, \"(p \").concat(parameters.length > 0 ? ',' : '').concat(parameters.map(function (p, idx) {\n      return \"\".concat(inputs[idx]);\n    }).join(','), \")\"));\n  }, [inputs]);\n  return /*#__PURE__*/React.createElement(ThemeProvider, {\n    theme: theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CustomNode, {\n    title: \"Primitive\",\n    id: id,\n    data: data,\n    dropdownOptions: Object.keys(storage),\n    body: /*#__PURE__*/React.createElement(React.Fragment, null, (_storage$primitive = storage[primitive]) === null || _storage$primitive === void 0 ? void 0 : _storage$primitive.parameters.map(function (param) {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 20\n        }\n      }, param.symbol);\n    }), inputs.map(function (input, idx) {\n      return /*#__PURE__*/React.createElement(FloatInput, {\n        val: inputs[idx],\n        handleChange: function handleChange(newVal) {\n          return handleInputChange(newVal, idx);\n        },\n        label: inputLabels[0],\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }\n      });\n    })),\n    onChangeOption: setPrimitive,\n    sdf: sdf,\n    currOption: primitive,\n    nInputs: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"names":["React","useEffect","CustomNode","FloatInput","createTheme","ThemeProvider","useLocalStorage","theme","palette","primary","light","main","dark","contrastText","Primitives","Sphere","Box","Torus","Cylinder","PrimitiveNode","data","id","useState","primitive","setPrimitive","sdf","setSdf","inputs","setInputs","inputLabels","setInputLabels","storage","setStorage","prepareInputs","label1","label2","label3","setInputsActive","handleInputChange","newVal","idx","newInputs","parameters","console","log","defaultVal","Object","keys","map","k","toFixed","label","length","p","join","param","symbol","input"],"sources":["C:/Users/daniz/TFG/Aplicacion/src/CustomNodes/PrimitiveNode.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport CustomNode from \"../CustomNodes/CustomNode\";\r\nimport FloatInput from \"../CustomComponents/FloatInput.js\";\r\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\r\nimport useLocalStorage from \"../storageHook\";\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#92bcff',\r\n      main: '#609dff',\r\n      dark: '#166cf5',\r\n      contrastText: 'white',\r\n    },\r\n  },\r\n});\r\n\r\nconst Primitives = {\r\n  Sphere: \"Sphere\",\r\n  Box: \"Box\",\r\n  Torus: \"Torus\",\r\n  Cylinder: \"Cylinder\",\r\n};\r\n\r\nexport default function PrimitiveNode({ data, id }) {\r\n  const [primitive, setPrimitive] = React.useState(\"sphere\");\r\n  const [sdf, setSdf] = React.useState(\"\");\r\n  const [inputs, setInputs] = React.useState([1.0, 1.0, 1.0]);\r\n  const [inputLabels, setInputLabels] = React.useState([\"Radius\", \"\", \"\"]);\r\n  const [storage, setStorage] = useLocalStorage('user_implicits', {});\r\n\r\n  const prepareInputs = (label1, label2 = \"\", label3 = \"\") => {\r\n    setInputLabels([label1, label2, label3]);\r\n    setInputsActive([label1, label2, label3]);\r\n  };\r\n\r\n  const handleInputChange = (newVal, idx) => {\r\n    const newInputs = [...inputs];\r\n    newInputs[idx] = newVal;\r\n\r\n    setInputs(newInputs);\r\n  }\r\n\r\n  useEffect(() => {\r\n    /*\r\n    console.log(\"ACTUALIZADO SDF\");\r\n    if (primitive == Primitives.Sphere) {\r\n      setSdf(`sphere(p, ${inputs[0].toFixed(4)})`);\r\n      prepareInputs(\"radius\");\r\n    } else if (primitive == Primitives.Box) {\r\n      setSdf(\r\n        `box(p, vec3(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}, \r\n          ${inputs[2].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"sx\", \"sy\", \"sz\");\r\n    } else if (primitive == Primitives.Torus) {\r\n      setSdf(\r\n        `torus(p, vec2(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"hole\", \"thickness\");\r\n    } else if (primitive == Primitives.Cylinder) {\r\n      setSdf(\r\n        `cylinder(p, \r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n        )`\r\n      );\r\n      prepareInputs(\"height\", \"radius\");\r\n    }\r\n\r\n    console.log(storage);\r\n    */\r\n    const parameters = storage[primitive].parameters;\r\n    \r\n    console.log(\"TYPE: \" + typeof(parameters[0].defaultVal));\r\n    setInputs(Object.keys(parameters).map(function(k){return parameters[k].defaultVal.toFixed(4)}));\r\n    setInputLabels(Object.keys(parameters).map(function(k){return parameters[k].label}));\r\n    \r\n    // setInputs(Array(parameters.length).fill().map((_, idx) => parameters[idx].defaultVal));\r\n    console.log(parameters);\r\n    console.log(primitive);\r\n  }, [primitive]);\r\n\r\n  useEffect(()=>{\r\n    const parameters = storage[primitive].parameters;\r\n    setSdf(`${primitive}(p ${parameters.length>0?',':''}${(parameters.map((p,idx)=>`${inputs[idx]}`)).join(',')})`);\r\n  }, [inputs])\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CustomNode\r\n        title={\"Primitive\"}\r\n        id={id}\r\n        data={data}\r\n        dropdownOptions={Object.keys(storage)}\r\n        body={\r\n          <>\r\n          {storage[primitive]?.parameters.map((param)=>{\r\n            return(<p>{param.symbol}</p>)\r\n          })}\r\n\r\n          {inputs.map((input, idx) => {\r\n            return(\r\n            <FloatInput\r\n              val={inputs[idx]}\r\n              handleChange={(newVal) => handleInputChange(newVal, idx)}\r\n              label={inputLabels[0]}\r\n            />\r\n            )\r\n          })}\r\n          </>\r\n        }\r\n        onChangeOption={setPrimitive}\r\n        sdf={sdf}\r\n        currOption={primitive}\r\n        nInputs={0}\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}