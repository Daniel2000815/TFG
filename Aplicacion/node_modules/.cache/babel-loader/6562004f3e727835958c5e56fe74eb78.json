{"ast":null,"code":"\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar MmlNode_js_1 = require(\"../../core/MmlTree/MmlNode.js\");\n\nvar NodeUtil_js_1 = __importDefault(require(\"./NodeUtil.js\"));\n\nvar TexParser_js_1 = __importDefault(require(\"./TexParser.js\"));\n\nvar TexError_js_1 = __importDefault(require(\"./TexError.js\"));\n\nvar Entities_js_1 = require(\"../../util/Entities.js\");\n\nvar ParseUtil;\n\n(function (ParseUtil) {\n  var emPerInch = 7.2;\n  var pxPerInch = 72;\n  var UNIT_CASES = {\n    'em': function em(m) {\n      return m;\n    },\n    'ex': function ex(m) {\n      return m * .43;\n    },\n    'pt': function pt(m) {\n      return m / 10;\n    },\n    'pc': function pc(m) {\n      return m * 1.2;\n    },\n    'px': function px(m) {\n      return m * emPerInch / pxPerInch;\n    },\n    'in': function _in(m) {\n      return m * emPerInch;\n    },\n    'cm': function cm(m) {\n      return m * emPerInch / 2.54;\n    },\n    'mm': function mm(m) {\n      return m * emPerInch / 25.4;\n    },\n    'mu': function mu(m) {\n      return m / 18;\n    }\n  };\n  var num = '([-+]?([.,]\\\\d+|\\\\d+([.,]\\\\d*)?))';\n  var unit = '(pt|em|ex|mu|px|mm|cm|in|pc)';\n  var dimenEnd = RegExp('^\\\\s*' + num + '\\\\s*' + unit + '\\\\s*$');\n  var dimenRest = RegExp('^\\\\s*' + num + '\\\\s*' + unit + ' ?');\n\n  function matchDimen(dim, rest) {\n    if (rest === void 0) {\n      rest = false;\n    }\n\n    var match = dim.match(rest ? dimenRest : dimenEnd);\n    return match ? muReplace([match[1].replace(/,/, '.'), match[4], match[0].length]) : [null, null, 0];\n  }\n\n  ParseUtil.matchDimen = matchDimen;\n\n  function muReplace(_a) {\n    var _b = __read(_a, 3),\n        value = _b[0],\n        unit = _b[1],\n        length = _b[2];\n\n    if (unit !== 'mu') {\n      return [value, unit, length];\n    }\n\n    var em = Em(UNIT_CASES[unit](parseFloat(value || '1')));\n    return [em.slice(0, -2), 'em', length];\n  }\n\n  function dimen2em(dim) {\n    var _a = __read(matchDimen(dim), 2),\n        value = _a[0],\n        unit = _a[1];\n\n    var m = parseFloat(value || '1');\n    var func = UNIT_CASES[unit];\n    return func ? func(m) : 0;\n  }\n\n  ParseUtil.dimen2em = dimen2em;\n\n  function Em(m) {\n    if (Math.abs(m) < .0006) {\n      return '0em';\n    }\n\n    return m.toFixed(3).replace(/\\.?0+$/, '') + 'em';\n  }\n\n  ParseUtil.Em = Em;\n\n  function cols() {\n    var W = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      W[_i] = arguments[_i];\n    }\n\n    return W.map(function (n) {\n      return Em(n);\n    }).join(' ');\n  }\n\n  ParseUtil.cols = cols;\n\n  function fenced(configuration, open, mml, close, big, color) {\n    if (big === void 0) {\n      big = '';\n    }\n\n    if (color === void 0) {\n      color = '';\n    }\n\n    var nf = configuration.nodeFactory;\n    var mrow = nf.create('node', 'mrow', [], {\n      open: open,\n      close: close,\n      texClass: MmlNode_js_1.TEXCLASS.INNER\n    });\n    var mo;\n\n    if (big) {\n      mo = new TexParser_js_1.default('\\\\' + big + 'l' + open, configuration.parser.stack.env, configuration).mml();\n    } else {\n      var openNode = nf.create('text', open);\n      mo = nf.create('node', 'mo', [], {\n        fence: true,\n        stretchy: true,\n        symmetric: true,\n        texClass: MmlNode_js_1.TEXCLASS.OPEN\n      }, openNode);\n    }\n\n    NodeUtil_js_1.default.appendChildren(mrow, [mo, mml]);\n\n    if (big) {\n      mo = new TexParser_js_1.default('\\\\' + big + 'r' + close, configuration.parser.stack.env, configuration).mml();\n    } else {\n      var closeNode = nf.create('text', close);\n      mo = nf.create('node', 'mo', [], {\n        fence: true,\n        stretchy: true,\n        symmetric: true,\n        texClass: MmlNode_js_1.TEXCLASS.CLOSE\n      }, closeNode);\n    }\n\n    color && mo.attributes.set('mathcolor', color);\n    NodeUtil_js_1.default.appendChildren(mrow, [mo]);\n    return mrow;\n  }\n\n  ParseUtil.fenced = fenced;\n\n  function fixedFence(configuration, open, mml, close) {\n    var mrow = configuration.nodeFactory.create('node', 'mrow', [], {\n      open: open,\n      close: close,\n      texClass: MmlNode_js_1.TEXCLASS.ORD\n    });\n\n    if (open) {\n      NodeUtil_js_1.default.appendChildren(mrow, [mathPalette(configuration, open, 'l')]);\n    }\n\n    if (NodeUtil_js_1.default.isType(mml, 'mrow')) {\n      NodeUtil_js_1.default.appendChildren(mrow, NodeUtil_js_1.default.getChildren(mml));\n    } else {\n      NodeUtil_js_1.default.appendChildren(mrow, [mml]);\n    }\n\n    if (close) {\n      NodeUtil_js_1.default.appendChildren(mrow, [mathPalette(configuration, close, 'r')]);\n    }\n\n    return mrow;\n  }\n\n  ParseUtil.fixedFence = fixedFence;\n\n  function mathPalette(configuration, fence, side) {\n    if (fence === '{' || fence === '}') {\n      fence = '\\\\' + fence;\n    }\n\n    var D = '{\\\\bigg' + side + ' ' + fence + '}';\n    var T = '{\\\\big' + side + ' ' + fence + '}';\n    return new TexParser_js_1.default('\\\\mathchoice' + D + T + T + T, {}, configuration).mml();\n  }\n\n  ParseUtil.mathPalette = mathPalette;\n\n  function fixInitialMO(configuration, nodes) {\n    for (var i = 0, m = nodes.length; i < m; i++) {\n      var child = nodes[i];\n\n      if (child && !NodeUtil_js_1.default.isType(child, 'mspace') && (!NodeUtil_js_1.default.isType(child, 'TeXAtom') || NodeUtil_js_1.default.getChildren(child)[0] && NodeUtil_js_1.default.getChildren(NodeUtil_js_1.default.getChildren(child)[0]).length)) {\n        if (NodeUtil_js_1.default.isEmbellished(child) || NodeUtil_js_1.default.isType(child, 'TeXAtom') && NodeUtil_js_1.default.getTexClass(child) === MmlNode_js_1.TEXCLASS.REL) {\n          var mi = configuration.nodeFactory.create('node', 'mi');\n          nodes.unshift(mi);\n        }\n\n        break;\n      }\n    }\n  }\n\n  ParseUtil.fixInitialMO = fixInitialMO;\n\n  function internalMath(parser, text, level, font) {\n    if (parser.configuration.options.internalMath) {\n      return parser.configuration.options.internalMath(parser, text, level, font);\n    }\n\n    var mathvariant = font || parser.stack.env.font;\n    var def = mathvariant ? {\n      mathvariant: mathvariant\n    } : {};\n    var mml = [],\n        i = 0,\n        k = 0,\n        c,\n        node,\n        match = '',\n        braces = 0;\n\n    if (text.match(/\\\\?[${}\\\\]|\\\\\\(|\\\\(eq)?ref\\s*\\{/)) {\n      while (i < text.length) {\n        c = text.charAt(i++);\n\n        if (c === '$') {\n          if (match === '$' && braces === 0) {\n            node = parser.create('node', 'TeXAtom', [new TexParser_js_1.default(text.slice(k, i - 1), {}, parser.configuration).mml()]);\n            mml.push(node);\n            match = '';\n            k = i;\n          } else if (match === '') {\n            if (k < i - 1) {\n              mml.push(internalText(parser, text.slice(k, i - 1), def));\n            }\n\n            match = '$';\n            k = i;\n          }\n        } else if (c === '{' && match !== '') {\n          braces++;\n        } else if (c === '}') {\n          if (match === '}' && braces === 0) {\n            var atom = new TexParser_js_1.default(text.slice(k, i), {}, parser.configuration).mml();\n            node = parser.create('node', 'TeXAtom', [atom], def);\n            mml.push(node);\n            match = '';\n            k = i;\n          } else if (match !== '') {\n            if (braces) {\n              braces--;\n            }\n          }\n        } else if (c === '\\\\') {\n          if (match === '' && text.substr(i).match(/^(eq)?ref\\s*\\{/)) {\n            var len = RegExp['$&'].length;\n\n            if (k < i - 1) {\n              mml.push(internalText(parser, text.slice(k, i - 1), def));\n            }\n\n            match = '}';\n            k = i - 1;\n            i += len;\n          } else {\n            c = text.charAt(i++);\n\n            if (c === '(' && match === '') {\n              if (k < i - 2) {\n                mml.push(internalText(parser, text.slice(k, i - 2), def));\n              }\n\n              match = ')';\n              k = i;\n            } else if (c === ')' && match === ')' && braces === 0) {\n              node = parser.create('node', 'TeXAtom', [new TexParser_js_1.default(text.slice(k, i - 2), {}, parser.configuration).mml()]);\n              mml.push(node);\n              match = '';\n              k = i;\n            } else if (c.match(/[${}\\\\]/) && match === '') {\n              i--;\n              text = text.substr(0, i - 1) + text.substr(i);\n            }\n          }\n        }\n      }\n\n      if (match !== '') {\n        throw new TexError_js_1.default('MathNotTerminated', 'Math not terminated in text box');\n      }\n    }\n\n    if (k < text.length) {\n      mml.push(internalText(parser, text.slice(k), def));\n    }\n\n    if (level != null) {\n      mml = [parser.create('node', 'mstyle', mml, {\n        displaystyle: false,\n        scriptlevel: level\n      })];\n    } else if (mml.length > 1) {\n      mml = [parser.create('node', 'mrow', mml)];\n    }\n\n    return mml;\n  }\n\n  ParseUtil.internalMath = internalMath;\n\n  function internalText(parser, text, def) {\n    text = text.replace(/^\\s+/, Entities_js_1.entities.nbsp).replace(/\\s+$/, Entities_js_1.entities.nbsp);\n    var textNode = parser.create('text', text);\n    return parser.create('node', 'mtext', [], def, textNode);\n  }\n\n  ParseUtil.internalText = internalText;\n\n  function underOver(parser, base, script, pos, stack) {\n    ParseUtil.checkMovableLimits(base);\n\n    if (NodeUtil_js_1.default.isType(base, 'munderover') && NodeUtil_js_1.default.isEmbellished(base)) {\n      NodeUtil_js_1.default.setProperties(NodeUtil_js_1.default.getCoreMO(base), {\n        lspace: 0,\n        rspace: 0\n      });\n      var mo = parser.create('node', 'mo', [], {\n        rspace: 0\n      });\n      base = parser.create('node', 'mrow', [mo, base]);\n    }\n\n    var mml = parser.create('node', 'munderover', [base]);\n    NodeUtil_js_1.default.setChild(mml, pos === 'over' ? mml.over : mml.under, script);\n    var node = mml;\n\n    if (stack) {\n      node = parser.create('node', 'TeXAtom', [mml], {\n        texClass: MmlNode_js_1.TEXCLASS.OP,\n        movesupsub: true\n      });\n    }\n\n    NodeUtil_js_1.default.setProperty(node, 'subsupOK', true);\n    return node;\n  }\n\n  ParseUtil.underOver = underOver;\n\n  function checkMovableLimits(base) {\n    var symbol = NodeUtil_js_1.default.isType(base, 'mo') ? NodeUtil_js_1.default.getForm(base) : null;\n\n    if (NodeUtil_js_1.default.getProperty(base, 'movablelimits') || symbol && symbol[3] && symbol[3].movablelimits) {\n      NodeUtil_js_1.default.setProperties(base, {\n        movablelimits: false\n      });\n    }\n  }\n\n  ParseUtil.checkMovableLimits = checkMovableLimits;\n\n  function trimSpaces(text) {\n    if (typeof text !== 'string') {\n      return text;\n    }\n\n    var TEXT = text.trim();\n\n    if (TEXT.match(/\\\\$/) && text.match(/ $/)) {\n      TEXT += ' ';\n    }\n\n    return TEXT;\n  }\n\n  ParseUtil.trimSpaces = trimSpaces;\n\n  function setArrayAlign(array, align) {\n    align = ParseUtil.trimSpaces(align || '');\n\n    if (align === 't') {\n      array.arraydef.align = 'baseline 1';\n    } else if (align === 'b') {\n      array.arraydef.align = 'baseline -1';\n    } else if (align === 'c') {\n      array.arraydef.align = 'axis';\n    } else if (align) {\n      array.arraydef.align = align;\n    }\n\n    return array;\n  }\n\n  ParseUtil.setArrayAlign = setArrayAlign;\n\n  function substituteArgs(parser, args, str) {\n    var text = '';\n    var newstring = '';\n    var i = 0;\n\n    while (i < str.length) {\n      var c = str.charAt(i++);\n\n      if (c === '\\\\') {\n        text += c + str.charAt(i++);\n      } else if (c === '#') {\n        c = str.charAt(i++);\n\n        if (c === '#') {\n          text += c;\n        } else {\n          if (!c.match(/[1-9]/) || parseInt(c, 10) > args.length) {\n            throw new TexError_js_1.default('IllegalMacroParam', 'Illegal macro parameter reference');\n          }\n\n          newstring = addArgs(parser, addArgs(parser, newstring, text), args[parseInt(c, 10) - 1]);\n          text = '';\n        }\n      } else {\n        text += c;\n      }\n    }\n\n    return addArgs(parser, newstring, text);\n  }\n\n  ParseUtil.substituteArgs = substituteArgs;\n\n  function addArgs(parser, s1, s2) {\n    if (s2.match(/^[a-z]/i) && s1.match(/(^|[^\\\\])(\\\\\\\\)*\\\\[a-z]+$/i)) {\n      s1 += ' ';\n    }\n\n    if (s1.length + s2.length > parser.configuration.options['maxBuffer']) {\n      throw new TexError_js_1.default('MaxBufferSize', 'MathJax internal buffer size exceeded; is there a' + ' recursive macro call?');\n    }\n\n    return s1 + s2;\n  }\n\n  ParseUtil.addArgs = addArgs;\n\n  function checkMaxMacros(parser, isMacro) {\n    if (isMacro === void 0) {\n      isMacro = true;\n    }\n\n    if (++parser.macroCount <= parser.configuration.options['maxMacros']) {\n      return;\n    }\n\n    if (isMacro) {\n      throw new TexError_js_1.default('MaxMacroSub1', 'MathJax maximum macro substitution count exceeded; ' + 'is here a recursive macro call?');\n    } else {\n      throw new TexError_js_1.default('MaxMacroSub2', 'MathJax maximum substitution count exceeded; ' + 'is there a recursive latex environment?');\n    }\n  }\n\n  ParseUtil.checkMaxMacros = checkMaxMacros;\n\n  function checkEqnEnv(parser) {\n    if (parser.stack.global.eqnenv) {\n      throw new TexError_js_1.default('ErroneousNestingEq', 'Erroneous nesting of equation structures');\n    }\n\n    parser.stack.global.eqnenv = true;\n  }\n\n  ParseUtil.checkEqnEnv = checkEqnEnv;\n\n  function copyNode(node, parser) {\n    var tree = node.copy();\n    var options = parser.configuration;\n    tree.walkTree(function (n) {\n      var e_1, _a;\n\n      options.addNode(n.kind, n);\n      var lists = (n.getProperty('in-lists') || '').split(/,/);\n\n      try {\n        for (var lists_1 = __values(lists), lists_1_1 = lists_1.next(); !lists_1_1.done; lists_1_1 = lists_1.next()) {\n          var list = lists_1_1.value;\n          list && options.addNode(list, n);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (lists_1_1 && !lists_1_1.done && (_a = lists_1.return)) _a.call(lists_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    });\n    return tree;\n  }\n\n  ParseUtil.copyNode = copyNode;\n\n  function MmlFilterAttribute(_parser, _name, value) {\n    return value;\n  }\n\n  ParseUtil.MmlFilterAttribute = MmlFilterAttribute;\n\n  function getFontDef(parser) {\n    var font = parser.stack.env['font'];\n    return font ? {\n      mathvariant: font\n    } : {};\n  }\n\n  ParseUtil.getFontDef = getFontDef;\n\n  function keyvalOptions(attrib, allowed, error) {\n    var e_2, _a;\n\n    if (allowed === void 0) {\n      allowed = null;\n    }\n\n    if (error === void 0) {\n      error = false;\n    }\n\n    var def = readKeyval(attrib);\n\n    if (allowed) {\n      try {\n        for (var _b = __values(Object.keys(def)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n\n          if (!allowed.hasOwnProperty(key)) {\n            if (error) {\n              throw new TexError_js_1.default('InvalidOption', 'Invalid option: %1', key);\n            }\n\n            delete def[key];\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    return def;\n  }\n\n  ParseUtil.keyvalOptions = keyvalOptions;\n\n  function readKeyval(text) {\n    var _a, _b;\n\n    var options = {};\n    var rest = text;\n    var end, key, val;\n\n    while (rest) {\n      _a = __read(readValue(rest, ['=', ',']), 3), key = _a[0], end = _a[1], rest = _a[2];\n\n      if (end === '=') {\n        _b = __read(readValue(rest, [',']), 3), val = _b[0], end = _b[1], rest = _b[2];\n        val = val === 'false' || val === 'true' ? JSON.parse(val) : val;\n        options[key] = val;\n      } else if (key) {\n        options[key] = true;\n      }\n    }\n\n    return options;\n  }\n\n  function removeBraces(text, count) {\n    while (count > 0) {\n      text = text.trim().slice(1, -1);\n      count--;\n    }\n\n    return text.trim();\n  }\n\n  function readValue(text, end) {\n    var length = text.length;\n    var braces = 0;\n    var value = '';\n    var index = 0;\n    var start = 0;\n    var startCount = true;\n    var stopCount = false;\n\n    while (index < length) {\n      var c = text[index++];\n\n      switch (c) {\n        case ' ':\n          break;\n\n        case '{':\n          if (startCount) {\n            start++;\n          } else {\n            stopCount = false;\n\n            if (start > braces) {\n              start = braces;\n            }\n          }\n\n          braces++;\n          break;\n\n        case '}':\n          if (braces) {\n            braces--;\n          }\n\n          if (startCount || stopCount) {\n            start--;\n            stopCount = true;\n          }\n\n          startCount = false;\n          break;\n\n        default:\n          if (!braces && end.indexOf(c) !== -1) {\n            return [stopCount ? 'true' : removeBraces(value, start), c, text.slice(index)];\n          }\n\n          startCount = false;\n          stopCount = false;\n      }\n\n      value += c;\n    }\n\n    if (braces) {\n      throw new TexError_js_1.default('ExtraOpenMissingClose', 'Extra open brace or missing close brace');\n    }\n\n    return [stopCount ? 'true' : removeBraces(value, start), '', text.slice(index)];\n  }\n})(ParseUtil || (ParseUtil = {}));\n\nexports.default = ParseUtil;","map":{"version":3,"mappings":"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","names":["ParseUtil","emPerInch","pxPerInch","UNIT_CASES","num","unit","dimenEnd","RegExp","dimenRest","matchDimen","dim","rest","match","muReplace","replace","length","_a","_b","value","em","Em","parseFloat","slice","dimen2em","m","func","Math","abs","toFixed","cols","W","map","n","join","fenced","configuration","open","mml","close","big","color","nf","nodeFactory","mrow","create","texClass","MmlNode_js_1","INNER","mo","TexParser_js_1","parser","stack","env","openNode","fence","stretchy","symmetric","OPEN","NodeUtil_js_1","appendChildren","closeNode","CLOSE","attributes","set","fixedFence","ORD","mathPalette","isType","getChildren","side","D","T","fixInitialMO","nodes","i","child","isEmbellished","getTexClass","REL","mi","unshift","internalMath","text","level","font","options","mathvariant","def","k","c","node","braces","charAt","push","internalText","atom","substr","len","TexError_js_1","displaystyle","scriptlevel","Entities_js_1","nbsp","textNode","underOver","base","script","pos","checkMovableLimits","setProperties","getCoreMO","lspace","rspace","setChild","over","under","OP","movesupsub","setProperty","symbol","getForm","getProperty","movablelimits","trimSpaces","TEXT","trim","setArrayAlign","array","align","arraydef","substituteArgs","args","str","newstring","parseInt","addArgs","s1","s2","checkMaxMacros","isMacro","macroCount","checkEqnEnv","global","eqnenv","copyNode","tree","copy","walkTree","addNode","kind","lists","split","lists_1_1","list","MmlFilterAttribute","_parser","_name","getFontDef","keyvalOptions","attrib","allowed","error","readKeyval","keys","_c","key","hasOwnProperty","end","val","readValue","JSON","parse","removeBraces","count","index","start","startCount","stopCount","indexOf","exports"],"sourceRoot":"","sources":["../../../ts/input/tex/ParseUtil.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}