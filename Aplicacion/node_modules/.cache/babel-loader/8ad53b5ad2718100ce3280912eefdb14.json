{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AbstractMathDocument = exports.resetAllOptions = exports.resetOptions = exports.RenderList = void 0;\n\nvar Options_js_1 = require(\"../util/Options.js\");\n\nvar InputJax_js_1 = require(\"./InputJax.js\");\n\nvar OutputJax_js_1 = require(\"./OutputJax.js\");\n\nvar MathList_js_1 = require(\"./MathList.js\");\n\nvar MathItem_js_1 = require(\"./MathItem.js\");\n\nvar MmlFactory_js_1 = require(\"../core/MmlTree/MmlFactory.js\");\n\nvar BitField_js_1 = require(\"../util/BitField.js\");\n\nvar PrioritizedList_js_1 = require(\"../util/PrioritizedList.js\");\n\nvar RenderList = function (_super) {\n  __extends(RenderList, _super);\n\n  function RenderList() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  RenderList.create = function (actions) {\n    var e_1, _a;\n\n    var list = new this();\n\n    try {\n      for (var _b = __values(Object.keys(actions)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n\n        var _d = __read(this.action(id, actions[id]), 2),\n            action = _d[0],\n            priority = _d[1];\n\n        if (priority) {\n          list.add(action, priority);\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    return list;\n  };\n\n  RenderList.action = function (id, action) {\n    var _a, _b, _c, _d;\n\n    var renderDoc, renderMath;\n    var convert = true;\n    var priority = action[0];\n\n    if (action.length === 1 || typeof action[1] === 'boolean') {\n      action.length === 2 && (convert = action[1]);\n      _a = __read(this.methodActions(id), 2), renderDoc = _a[0], renderMath = _a[1];\n    } else if (typeof action[1] === 'string') {\n      if (typeof action[2] === 'string') {\n        action.length === 4 && (convert = action[3]);\n\n        var _e = __read(action.slice(1), 2),\n            method1 = _e[0],\n            method2 = _e[1];\n\n        _b = __read(this.methodActions(method1, method2), 2), renderDoc = _b[0], renderMath = _b[1];\n      } else {\n        action.length === 3 && (convert = action[2]);\n        _c = __read(this.methodActions(action[1]), 2), renderDoc = _c[0], renderMath = _c[1];\n      }\n    } else {\n      action.length === 4 && (convert = action[3]);\n      _d = __read(action.slice(1), 2), renderDoc = _d[0], renderMath = _d[1];\n    }\n\n    return [{\n      id: id,\n      renderDoc: renderDoc,\n      renderMath: renderMath,\n      convert: convert\n    }, priority];\n  };\n\n  RenderList.methodActions = function (method1, method2) {\n    if (method2 === void 0) {\n      method2 = method1;\n    }\n\n    return [function (document) {\n      method1 && document[method1]();\n      return false;\n    }, function (math, document) {\n      method2 && math[method2](document);\n      return false;\n    }];\n  };\n\n  RenderList.prototype.renderDoc = function (document, start) {\n    var e_2, _a;\n\n    if (start === void 0) {\n      start = MathItem_js_1.STATE.UNPROCESSED;\n    }\n\n    try {\n      for (var _b = __values(this.items), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var item = _c.value;\n\n        if (item.priority >= start) {\n          if (item.item.renderDoc(document)) return;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n  };\n\n  RenderList.prototype.renderMath = function (math, document, start) {\n    var e_3, _a;\n\n    if (start === void 0) {\n      start = MathItem_js_1.STATE.UNPROCESSED;\n    }\n\n    try {\n      for (var _b = __values(this.items), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var item = _c.value;\n\n        if (item.priority >= start) {\n          if (item.item.renderMath(math, document)) return;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n  };\n\n  RenderList.prototype.renderConvert = function (math, document, end) {\n    var e_4, _a;\n\n    if (end === void 0) {\n      end = MathItem_js_1.STATE.LAST;\n    }\n\n    try {\n      for (var _b = __values(this.items), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var item = _c.value;\n        if (item.priority > end) return;\n\n        if (item.item.convert) {\n          if (item.item.renderMath(math, document)) return;\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n  };\n\n  RenderList.prototype.findID = function (id) {\n    var e_5, _a;\n\n    try {\n      for (var _b = __values(this.items), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var item = _c.value;\n\n        if (item.item.id === id) {\n          return item.item;\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    return null;\n  };\n\n  return RenderList;\n}(PrioritizedList_js_1.PrioritizedList);\n\nexports.RenderList = RenderList;\nexports.resetOptions = {\n  all: false,\n  processed: false,\n  inputJax: null,\n  outputJax: null\n};\nexports.resetAllOptions = {\n  all: true,\n  processed: true,\n  inputJax: [],\n  outputJax: []\n};\n\nvar DefaultInputJax = function (_super) {\n  __extends(DefaultInputJax, _super);\n\n  function DefaultInputJax() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DefaultInputJax.prototype.compile = function (_math) {\n    return null;\n  };\n\n  return DefaultInputJax;\n}(InputJax_js_1.AbstractInputJax);\n\nvar DefaultOutputJax = function (_super) {\n  __extends(DefaultOutputJax, _super);\n\n  function DefaultOutputJax() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DefaultOutputJax.prototype.typeset = function (_math, _document) {\n    if (_document === void 0) {\n      _document = null;\n    }\n\n    return null;\n  };\n\n  DefaultOutputJax.prototype.escaped = function (_math, _document) {\n    return null;\n  };\n\n  return DefaultOutputJax;\n}(OutputJax_js_1.AbstractOutputJax);\n\nvar DefaultMathList = function (_super) {\n  __extends(DefaultMathList, _super);\n\n  function DefaultMathList() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return DefaultMathList;\n}(MathList_js_1.AbstractMathList);\n\nvar DefaultMathItem = function (_super) {\n  __extends(DefaultMathItem, _super);\n\n  function DefaultMathItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return DefaultMathItem;\n}(MathItem_js_1.AbstractMathItem);\n\nvar AbstractMathDocument = function () {\n  function AbstractMathDocument(document, adaptor, options) {\n    var _this = this;\n\n    var CLASS = this.constructor;\n    this.document = document;\n    this.options = (0, Options_js_1.userOptions)((0, Options_js_1.defaultOptions)({}, CLASS.OPTIONS), options);\n    this.math = new (this.options['MathList'] || DefaultMathList)();\n    this.renderActions = RenderList.create(this.options['renderActions']);\n    this.processed = new AbstractMathDocument.ProcessBits();\n    this.outputJax = this.options['OutputJax'] || new DefaultOutputJax();\n    var inputJax = this.options['InputJax'] || [new DefaultInputJax()];\n\n    if (!Array.isArray(inputJax)) {\n      inputJax = [inputJax];\n    }\n\n    this.inputJax = inputJax;\n    this.adaptor = adaptor;\n    this.outputJax.setAdaptor(adaptor);\n    this.inputJax.map(function (jax) {\n      return jax.setAdaptor(adaptor);\n    });\n    this.mmlFactory = this.options['MmlFactory'] || new MmlFactory_js_1.MmlFactory();\n    this.inputJax.map(function (jax) {\n      return jax.setMmlFactory(_this.mmlFactory);\n    });\n    this.outputJax.initialize();\n    this.inputJax.map(function (jax) {\n      return jax.initialize();\n    });\n  }\n\n  Object.defineProperty(AbstractMathDocument.prototype, \"kind\", {\n    get: function get() {\n      return this.constructor.KIND;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  AbstractMathDocument.prototype.addRenderAction = function (id) {\n    var action = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      action[_i - 1] = arguments[_i];\n    }\n\n    var _a = __read(RenderList.action(id, action), 2),\n        fn = _a[0],\n        p = _a[1];\n\n    this.renderActions.add(fn, p);\n  };\n\n  AbstractMathDocument.prototype.removeRenderAction = function (id) {\n    var action = this.renderActions.findID(id);\n\n    if (action) {\n      this.renderActions.remove(action);\n    }\n  };\n\n  AbstractMathDocument.prototype.render = function () {\n    this.renderActions.renderDoc(this);\n    return this;\n  };\n\n  AbstractMathDocument.prototype.rerender = function (start) {\n    if (start === void 0) {\n      start = MathItem_js_1.STATE.RERENDER;\n    }\n\n    this.state(start - 1);\n    this.render();\n    return this;\n  };\n\n  AbstractMathDocument.prototype.convert = function (math, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _a = (0, Options_js_1.userOptions)({\n      format: this.inputJax[0].name,\n      display: true,\n      end: MathItem_js_1.STATE.LAST,\n      em: 16,\n      ex: 8,\n      containerWidth: null,\n      lineWidth: 1000000,\n      scale: 1,\n      family: ''\n    }, options),\n        format = _a.format,\n        display = _a.display,\n        end = _a.end,\n        ex = _a.ex,\n        em = _a.em,\n        containerWidth = _a.containerWidth,\n        lineWidth = _a.lineWidth,\n        scale = _a.scale,\n        family = _a.family;\n\n    if (containerWidth === null) {\n      containerWidth = 80 * ex;\n    }\n\n    var jax = this.inputJax.reduce(function (jax, ijax) {\n      return ijax.name === format ? ijax : jax;\n    }, null);\n    var mitem = new this.options.MathItem(math, jax, display);\n    mitem.start.node = this.adaptor.body(this.document);\n    mitem.setMetrics(em, ex, containerWidth, lineWidth, scale);\n\n    if (this.outputJax.options.mtextInheritFont) {\n      mitem.outputData.mtextFamily = family;\n    }\n\n    if (this.outputJax.options.merrorInheritFont) {\n      mitem.outputData.merrorFamily = family;\n    }\n\n    mitem.convert(this, end);\n    return mitem.typesetRoot || mitem.root;\n  };\n\n  AbstractMathDocument.prototype.findMath = function (_options) {\n    if (_options === void 0) {\n      _options = null;\n    }\n\n    this.processed.set('findMath');\n    return this;\n  };\n\n  AbstractMathDocument.prototype.compile = function () {\n    var e_6, _a, e_7, _b;\n\n    if (!this.processed.isSet('compile')) {\n      var recompile = [];\n\n      try {\n        for (var _c = __values(this.math), _d = _c.next(); !_d.done; _d = _c.next()) {\n          var math = _d.value;\n          this.compileMath(math);\n\n          if (math.inputData.recompile !== undefined) {\n            recompile.push(math);\n          }\n        }\n      } catch (e_6_1) {\n        e_6 = {\n          error: e_6_1\n        };\n      } finally {\n        try {\n          if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n        } finally {\n          if (e_6) throw e_6.error;\n        }\n      }\n\n      try {\n        for (var recompile_1 = __values(recompile), recompile_1_1 = recompile_1.next(); !recompile_1_1.done; recompile_1_1 = recompile_1.next()) {\n          var math = recompile_1_1.value;\n          var data = math.inputData.recompile;\n          math.state(data.state);\n          math.inputData.recompile = data;\n          this.compileMath(math);\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (recompile_1_1 && !recompile_1_1.done && (_b = recompile_1.return)) _b.call(recompile_1);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n\n      this.processed.set('compile');\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.compileMath = function (math) {\n    try {\n      math.compile(this);\n    } catch (err) {\n      if (err.retry || err.restart) {\n        throw err;\n      }\n\n      this.options['compileError'](this, math, err);\n      math.inputData['error'] = err;\n    }\n  };\n\n  AbstractMathDocument.prototype.compileError = function (math, err) {\n    math.root = this.mmlFactory.create('math', null, [this.mmlFactory.create('merror', {\n      'data-mjx-error': err.message,\n      title: err.message\n    }, [this.mmlFactory.create('mtext', null, [this.mmlFactory.create('text').setText('Math input error')])])]);\n\n    if (math.display) {\n      math.root.attributes.set('display', 'block');\n    }\n\n    math.inputData.error = err.message;\n  };\n\n  AbstractMathDocument.prototype.typeset = function () {\n    var e_8, _a;\n\n    if (!this.processed.isSet('typeset')) {\n      try {\n        for (var _b = __values(this.math), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var math = _c.value;\n\n          try {\n            math.typeset(this);\n          } catch (err) {\n            if (err.retry || err.restart) {\n              throw err;\n            }\n\n            this.options['typesetError'](this, math, err);\n            math.outputData['error'] = err;\n          }\n        }\n      } catch (e_8_1) {\n        e_8 = {\n          error: e_8_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_8) throw e_8.error;\n        }\n      }\n\n      this.processed.set('typeset');\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.typesetError = function (math, err) {\n    math.typesetRoot = this.adaptor.node('mjx-container', {\n      class: 'MathJax mjx-output-error',\n      jax: this.outputJax.name\n    }, [this.adaptor.node('span', {\n      'data-mjx-error': err.message,\n      title: err.message,\n      style: {\n        color: 'red',\n        'background-color': 'yellow',\n        'line-height': 'normal'\n      }\n    }, [this.adaptor.text('Math output error')])]);\n\n    if (math.display) {\n      this.adaptor.setAttributes(math.typesetRoot, {\n        style: {\n          display: 'block',\n          margin: '1em 0',\n          'text-align': 'center'\n        }\n      });\n    }\n\n    math.outputData.error = err.message;\n  };\n\n  AbstractMathDocument.prototype.getMetrics = function () {\n    if (!this.processed.isSet('getMetrics')) {\n      this.outputJax.getMetrics(this);\n      this.processed.set('getMetrics');\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.updateDocument = function () {\n    var e_9, _a;\n\n    if (!this.processed.isSet('updateDocument')) {\n      try {\n        for (var _b = __values(this.math.reversed()), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var math = _c.value;\n          math.updateDocument(this);\n        }\n      } catch (e_9_1) {\n        e_9 = {\n          error: e_9_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_9) throw e_9.error;\n        }\n      }\n\n      this.processed.set('updateDocument');\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.removeFromDocument = function (_restore) {\n    if (_restore === void 0) {\n      _restore = false;\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.state = function (state, restore) {\n    var e_10, _a;\n\n    if (restore === void 0) {\n      restore = false;\n    }\n\n    try {\n      for (var _b = __values(this.math), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var math = _c.value;\n        math.state(state, restore);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    if (state < MathItem_js_1.STATE.INSERTED) {\n      this.processed.clear('updateDocument');\n    }\n\n    if (state < MathItem_js_1.STATE.TYPESET) {\n      this.processed.clear('typeset');\n      this.processed.clear('getMetrics');\n    }\n\n    if (state < MathItem_js_1.STATE.COMPILED) {\n      this.processed.clear('compile');\n    }\n\n    return this;\n  };\n\n  AbstractMathDocument.prototype.reset = function (options) {\n    var _a;\n\n    if (options === void 0) {\n      options = {\n        processed: true\n      };\n    }\n\n    options = (0, Options_js_1.userOptions)(Object.assign({}, exports.resetOptions), options);\n    options.all && Object.assign(options, exports.resetAllOptions);\n    options.processed && this.processed.reset();\n    options.inputJax && this.inputJax.forEach(function (jax) {\n      return jax.reset.apply(jax, __spreadArray([], __read(options.inputJax), false));\n    });\n    options.outputJax && (_a = this.outputJax).reset.apply(_a, __spreadArray([], __read(options.outputJax), false));\n    return this;\n  };\n\n  AbstractMathDocument.prototype.clear = function () {\n    this.reset();\n    this.math.clear();\n    return this;\n  };\n\n  AbstractMathDocument.prototype.concat = function (list) {\n    this.math.merge(list);\n    return this;\n  };\n\n  AbstractMathDocument.prototype.clearMathItemsWithin = function (containers) {\n    var _a;\n\n    var items = this.getMathItemsWithin(containers);\n\n    (_a = this.math).remove.apply(_a, __spreadArray([], __read(items), false));\n\n    return items;\n  };\n\n  AbstractMathDocument.prototype.getMathItemsWithin = function (elements) {\n    var e_11, _a, e_12, _b;\n\n    if (!Array.isArray(elements)) {\n      elements = [elements];\n    }\n\n    var adaptor = this.adaptor;\n    var items = [];\n    var containers = adaptor.getElements(elements, this.document);\n\n    try {\n      ITEMS: for (var _c = __values(this.math), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var item = _d.value;\n\n        try {\n          for (var containers_1 = (e_12 = void 0, __values(containers)), containers_1_1 = containers_1.next(); !containers_1_1.done; containers_1_1 = containers_1.next()) {\n            var container = containers_1_1.value;\n\n            if (item.start.node && adaptor.contains(container, item.start.node)) {\n              items.push(item);\n              continue ITEMS;\n            }\n          }\n        } catch (e_12_1) {\n          e_12 = {\n            error: e_12_1\n          };\n        } finally {\n          try {\n            if (containers_1_1 && !containers_1_1.done && (_b = containers_1.return)) _b.call(containers_1);\n          } finally {\n            if (e_12) throw e_12.error;\n          }\n        }\n      }\n    } catch (e_11_1) {\n      e_11 = {\n        error: e_11_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_11) throw e_11.error;\n      }\n    }\n\n    return items;\n  };\n\n  AbstractMathDocument.KIND = 'MathDocument';\n  AbstractMathDocument.OPTIONS = {\n    OutputJax: null,\n    InputJax: null,\n    MmlFactory: null,\n    MathList: DefaultMathList,\n    MathItem: DefaultMathItem,\n    compileError: function compileError(doc, math, err) {\n      doc.compileError(math, err);\n    },\n    typesetError: function typesetError(doc, math, err) {\n      doc.typesetError(math, err);\n    },\n    renderActions: (0, Options_js_1.expandable)({\n      find: [MathItem_js_1.STATE.FINDMATH, 'findMath', '', false],\n      compile: [MathItem_js_1.STATE.COMPILED],\n      metrics: [MathItem_js_1.STATE.METRICS, 'getMetrics', '', false],\n      typeset: [MathItem_js_1.STATE.TYPESET],\n      update: [MathItem_js_1.STATE.INSERTED, 'updateDocument', false]\n    })\n  };\n  AbstractMathDocument.ProcessBits = (0, BitField_js_1.BitFieldClass)('findMath', 'compile', 'getMetrics', 'typeset', 'updateDocument');\n  return AbstractMathDocument;\n}();\n\nexports.AbstractMathDocument = AbstractMathDocument;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AAEA;;AAEA;;AAyEA;EAAyCA;;EAAzC;;EA4HC;;EApHeC,oBAAd,UAA8BC,OAA9B,EAA6D;;;IAC3D,IAAMC,IAAI,GAAG,IAAI,IAAJ,EAAb;;;MACA,KAAiB,wBAAM,CAACC,IAAP,CAAYF,OAAZ,IAAoBG,cAArC,EAAqC,QAArC,EAAqCA,cAArC,EAAuC;QAAlC,IAAMC,EAAE,WAAR;;QACG,gBAAqB,KAAKC,MAAL,CAAqBD,EAArB,EAAyBJ,OAAO,CAACI,EAAD,CAAhC,CAArB,EAA0D,CAA1D;QAAA,IAACC,MAAM,QAAP;QAAA,IAASC,QAAQ,QAAjB;;QACN,IAAIA,QAAJ,EAAc;UACZL,IAAI,CAACM,GAAL,CAASF,MAAT,EAAiBC,QAAjB;QACD;MACF;;;;;;;;;;;;;IACD,OAAOL,IAAP;EACD,CATa;;EAmBAF,oBAAd,UAA8BK,EAA9B,EAA0CC,MAA1C,EAAuE;;;IACrE,IAAIG,SAAJ,EAAeC,UAAf;IACA,IAAIC,OAAO,GAAG,IAAd;IACA,IAAIJ,QAAQ,GAAGD,MAAM,CAAC,CAAD,CAArB;;IACA,IAAIA,MAAM,CAACM,MAAP,KAAkB,CAAlB,IAAuB,OAAON,MAAM,CAAC,CAAD,CAAb,KAAqB,SAAhD,EAA2D;MACzDA,MAAM,CAACM,MAAP,KAAkB,CAAlB,KAAwBD,OAAO,GAAGL,MAAM,CAAC,CAAD,CAAxC;MACAO,YAA0B,KAAKC,aAAL,CAAmBT,EAAnB,CAA1B,EAAgD,CAAhD,GAACI,SAAS,QAAV,EAAYC,UAAU,QAAtB;IACD,CAHD,MAGO,IAAI,OAAOJ,MAAM,CAAC,CAAD,CAAb,KAAqB,QAAzB,EAAmC;MACxC,IAAI,OAAOA,MAAM,CAAC,CAAD,CAAb,KAAqB,QAAzB,EAAmC;QACjCA,MAAM,CAACM,MAAP,KAAkB,CAAlB,KAAwBD,OAAO,GAAGL,MAAM,CAAC,CAAD,CAAxC;;QACM,gBAAqBA,MAAM,CAACS,KAAP,CAAa,CAAb,CAArB,EAAwD,CAAxD;QAAA,IAACC,OAAO,QAAR;QAAA,IAAUC,OAAO,QAAjB;;QACNC,YAA0B,KAAKJ,aAAL,CAAmBE,OAAnB,EAA4BC,OAA5B,CAA1B,EAA8D,CAA9D,GAACR,SAAS,QAAV,EAAYC,UAAU,QAAtB;MACD,CAJD,MAIO;QACLJ,MAAM,CAACM,MAAP,KAAkB,CAAlB,KAAwBD,OAAO,GAAGL,MAAM,CAAC,CAAD,CAAxC;QACAF,YAA0B,KAAKU,aAAL,CAAmBR,MAAM,CAAC,CAAD,CAAzB,CAA1B,EAAiE,CAAjE,GAACG,SAAS,QAAV,EAAYC,UAAU,QAAtB;MACD;IACF,CATM,MASA;MACLJ,MAAM,CAACM,MAAP,KAAkB,CAAlB,KAAwBD,OAAO,GAAGL,MAAM,CAAC,CAAD,CAAxC;MACAa,YAA0Bb,MAAM,CAACS,KAAP,CAAa,CAAb,CAA1B,EAAsF,CAAtF,GAACN,SAAS,QAAV,EAAYC,UAAU,QAAtB;IACD;;IACD,OAAO,CAAC;MAACL,EAAE,IAAH;MAAKI,SAAS,WAAd;MAAgBC,UAAU,YAA1B;MAA4BC,OAAO;IAAnC,CAAD,EAA8DJ,QAA9D,CAAP;EACD,CArBa;;EA8BGP,2BAAjB,UAA+BgB,OAA/B,EAAgDC,OAAhD,EAAyE;IAAzB;MAAAA;IAAyB;;IACvE,OAAO,CACL,UAACG,QAAD,EAAc;MAAMJ,OAAO,IAAII,QAAQ,CAACJ,OAAD,CAAR,EAAX;MAAgC,OAAO,KAAP;IAAe,CAD9D,EAEL,UAACK,IAAD,EAAYD,QAAZ,EAAyB;MAAMH,OAAO,IAAII,IAAI,CAACJ,OAAD,CAAJ,CAAcG,QAAd,CAAX;MAAoC,OAAO,KAAP;IAAe,CAF7E,CAAP;EAID,CALgB;;EAaVpB,iCAAP,UAAiBoB,QAAjB,EAAkDE,KAAlD,EAAmF;;;IAAjC;MAAAA,QAAgBC,oBAAMC,WAAtB;IAAiC;;;MACjF,KAAmB,uBAAKC,KAAL,GAAUrB,cAA7B,EAA6B,QAA7B,EAA6BA,cAA7B,EAA+B;QAA1B,IAAMsB,IAAI,WAAV;;QACH,IAAIA,IAAI,CAACnB,QAAL,IAAiBe,KAArB,EAA4B;UAC1B,IAAII,IAAI,CAACA,IAAL,CAAUjB,SAAV,CAAoBW,QAApB,CAAJ,EAAmC;QACpC;MACF;;;;;;;;;;;;EACF,CANM;;EAeApB,kCAAP,UAAkBqB,IAAlB,EAA2CD,QAA3C,EAA4EE,KAA5E,EAA6G;;;IAAjC;MAAAA,QAAgBC,oBAAMC,WAAtB;IAAiC;;;MAC3G,KAAmB,uBAAKC,KAAL,GAAUrB,cAA7B,EAA6B,QAA7B,EAA6BA,cAA7B,EAA+B;QAA1B,IAAMsB,IAAI,WAAV;;QACH,IAAIA,IAAI,CAACnB,QAAL,IAAiBe,KAArB,EAA4B;UAC1B,IAAII,IAAI,CAACA,IAAL,CAAUhB,UAAV,CAAqBW,IAArB,EAA2BD,QAA3B,CAAJ,EAA0C;QAC3C;MACF;;;;;;;;;;;;EACF,CANM;;EAeApB,qCAAP,UAAqBqB,IAArB,EAA8CD,QAA9C,EAA+EO,GAA/E,EAAuG;;;IAAxB;MAAAA,MAAcJ,oBAAMK,IAApB;IAAwB;;;MACrG,KAAmB,uBAAKH,KAAL,GAAUrB,cAA7B,EAA6B,QAA7B,EAA6BA,cAA7B,EAA+B;QAA1B,IAAMsB,IAAI,WAAV;QACH,IAAIA,IAAI,CAACnB,QAAL,GAAgBoB,GAApB,EAAyB;;QACzB,IAAID,IAAI,CAACA,IAAL,CAAUf,OAAd,EAAuB;UACrB,IAAIe,IAAI,CAACA,IAAL,CAAUhB,UAAV,CAAqBW,IAArB,EAA2BD,QAA3B,CAAJ,EAA0C;QAC3C;MACF;;;;;;;;;;;;EACF,CAPM;;EAeApB,8BAAP,UAAcK,EAAd,EAAwB;;;;MACtB,KAAmB,uBAAKoB,KAAL,GAAUrB,cAA7B,EAA6B,QAA7B,EAA6BA,cAA7B,EAA+B;QAA1B,IAAMsB,IAAI,WAAV;;QACH,IAAIA,IAAI,CAACA,IAAL,CAAUrB,EAAV,KAAiBA,EAArB,EAAyB;UACvB,OAAOqB,IAAI,CAACA,IAAZ;QACD;MACF;;;;;;;;;;;;;IACD,OAAO,IAAP;EACD,CAPM;;EAST;AAAC,CA5HD,CAAyCG,oCAAzC;;AAAaC;AAqJAA,uBAA0B;EACrCC,GAAG,EAAE,KADgC;EAErCC,SAAS,EAAE,KAF0B;EAGrCC,QAAQ,EAAE,IAH2B;EAIrCC,SAAS,EAAE;AAJ0B,CAA1B;AAUAJ,0BAA6B;EACxCC,GAAG,EAAE,IADmC;EAExCC,SAAS,EAAE,IAF6B;EAGxCC,QAAQ,EAAE,EAH8B;EAIxCC,SAAS,EAAE;AAJ6B,CAA7B;;AAmOb;EAAuCnC;;EAAvC;;EAOC;;EAHQoC,oCAAP,UAAeC,KAAf,EAAuC;IACrC,OAAO,IAAP;EACD,CAFM;;EAGT;AAAC,CAPD,CAAuCC,8BAAvC;;AAgBA;EAAwCtC;;EAAxC;;EAaC;;EATQuC,qCAAP,UAAeF,KAAf,EAAyCG,SAAzC,EAAgF;IAAvC;MAAAA;IAAuC;;IAC9E,OAAO,IAAP;EACD,CAFM;;EAMAD,qCAAP,UAAeF,KAAf,EAAyCG,SAAzC,EAA0E;IACxE,OAAO,IAAP;EACD,CAFM;;EAGT;AAAC,CAbD,CAAwCC,gCAAxC;;AAsBA;EAAuCzC;;EAAvC;;EAAmE;;EAAD;AAAC,CAAnE,CAAuC0C,8BAAvC;;AASA;EAAuC1C;;EAAvC;;EAAmE;;EAAD;AAAC,CAAnE,CAAuCwB,8BAAvC;;AAUA;EAuFE,8BAAaH,QAAb,EAA0BsB,OAA1B,EAAwDC,OAAxD,EAA2E;IAA3E;;IACE,IAAIC,KAAK,GAAG,KAAKC,WAAjB;IACA,KAAKzB,QAAL,GAAgBA,QAAhB;IACA,KAAKuB,OAAL,GAAe,8BAAY,iCAAe,EAAf,EAAmBC,KAAK,CAACE,OAAzB,CAAZ,EAA+CH,OAA/C,CAAf;IACA,KAAKtB,IAAL,GAAY,KAAK,KAAKsB,OAAL,CAAa,UAAb,KAA4BI,eAAjC,GAAZ;IACA,KAAKC,aAAL,GAAqBhD,UAAU,CAACiD,MAAX,CAA2B,KAAKN,OAAL,CAAa,eAAb,CAA3B,CAArB;IACA,KAAKX,SAAL,GAAiB,IAAIkB,oBAAoB,CAACC,WAAzB,EAAjB;IACA,KAAKjB,SAAL,GAAiB,KAAKS,OAAL,CAAa,WAAb,KAA6B,IAAIL,gBAAJ,EAA9C;IACA,IAAIL,QAAQ,GAAG,KAAKU,OAAL,CAAa,UAAb,KAA4B,CAAC,IAAIR,eAAJ,EAAD,CAA3C;;IACA,IAAI,CAACiB,KAAK,CAACC,OAAN,CAAcpB,QAAd,CAAL,EAA8B;MAC5BA,QAAQ,GAAG,CAACA,QAAD,CAAX;IACD;;IACD,KAAKA,QAAL,GAAgBA,QAAhB;IAIA,KAAKS,OAAL,GAAeA,OAAf;IACA,KAAKR,SAAL,CAAeoB,UAAf,CAA0BZ,OAA1B;IACA,KAAKT,QAAL,CAAcsB,GAAd,CAAkB,eAAG;MAAI,UAAG,CAACD,UAAJ,CAAeZ,OAAf;IAAuB,CAAhD;IAIA,KAAKc,UAAL,GAAkB,KAAKb,OAAL,CAAa,YAAb,KAA8B,IAAIc,0BAAJ,EAAhD;IACA,KAAKxB,QAAL,CAAcsB,GAAd,CAAkB,eAAG;MAAI,UAAG,CAACG,aAAJ,CAAkBC,KAAI,CAACH,UAAvB;IAAkC,CAA3D;IAIA,KAAKtB,SAAL,CAAe0B,UAAf;IACA,KAAK3B,QAAL,CAAcsB,GAAd,CAAkB,eAAG;MAAI,UAAG,CAACK,UAAJ;IAAgB,CAAzC;EACD;;EAKDC,sBAAWX,8BAAX,EAAW,MAAX,EAAe;SAAf;MACE,OAAQ,KAAKL,WAAL,CAAiDiB,IAAzD;IACD,CAFc;qBAAA;;EAAA,CAAf;;EAOOZ,iDAAP,UAAuB7C,EAAvB,EAAiC;IAAE;;SAAA,yCAAgB;MAAhBC;;;IAC3B,gBAAUN,UAAU,CAACM,MAAX,CAA2BD,EAA3B,EAA+BC,MAA/B,CAAV,EAAyE,CAAzE;IAAA,IAACyD,EAAE,QAAH;IAAA,IAAKC,CAAC,QAAN;;IACN,KAAKhB,aAAL,CAAmBxC,GAAnB,CAAuBuD,EAAvB,EAA2BC,CAA3B;EACD,CAHM;;EAQAd,oDAAP,UAA0B7C,EAA1B,EAAoC;IAClC,IAAMC,MAAM,GAAG,KAAK0C,aAAL,CAAmBiB,MAAnB,CAA0B5D,EAA1B,CAAf;;IACA,IAAIC,MAAJ,EAAY;MACV,KAAK0C,aAAL,CAAmBkB,MAAnB,CAA0B5D,MAA1B;IACD;EACF,CALM;;EAUA4C,wCAAP;IACE,KAAKF,aAAL,CAAmBvC,SAAnB,CAA6B,IAA7B;IACA,OAAO,IAAP;EACD,CAHM;;EAQAyC,0CAAP,UAAgB5B,KAAhB,EAA8C;IAA9B;MAAAA,QAAgBC,oBAAM4C,QAAtB;IAA8B;;IAC5C,KAAKC,KAAL,CAAW9C,KAAK,GAAG,CAAnB;IACA,KAAK+C,MAAL;IACA,OAAO,IAAP;EACD,CAJM;;EASAnB,yCAAP,UAAe7B,IAAf,EAA6BsB,OAA7B,EAAqD;IAAxB;MAAAA;IAAwB;;IAC/C,SAA2E,8BAAY;MACzF2B,MAAM,EAAE,KAAKrC,QAAL,CAAc,CAAd,EAAiBsC,IADgE;MAC1DC,OAAO,EAAE,IADiD;MAC3C7C,GAAG,EAAEJ,oBAAMK,IADgC;MAEzF6C,EAAE,EAAE,EAFqF;MAEjFC,EAAE,EAAE,CAF6E;MAE1EC,cAAc,EAAE,IAF0D;MAEpDC,SAAS,EAAE,OAFyC;MAEhCC,KAAK,EAAE,CAFyB;MAEtBC,MAAM,EAAE;IAFc,CAAZ,EAG5EnC,OAH4E,CAA3E;IAAA,IAAC2B,MAAM,YAAP;IAAA,IAASE,OAAO,aAAhB;IAAA,IAAkB7C,GAAG,SAArB;IAAA,IAAuB+C,EAAE,QAAzB;IAAA,IAA2BD,EAAE,QAA7B;IAAA,IAA+BE,cAAc,oBAA7C;IAAA,IAA+CC,SAAS,eAAxD;IAAA,IAA0DC,KAAK,WAA/D;IAAA,IAAiEC,MAAM,YAAvE;;IAIJ,IAAIH,cAAc,KAAK,IAAvB,EAA6B;MAC3BA,cAAc,GAAG,KAAKD,EAAtB;IACD;;IACD,IAAMK,GAAG,GAAG,KAAK9C,QAAL,CAAc+C,MAAd,CAAqB,UAACD,GAAD,EAAME,IAAN,EAAU;MAAK,OAACA,IAAI,CAACV,IAAL,KAAcD,MAAd,GAAuBW,IAAvB,GAA8BF,GAA/B;IAAmC,CAAvE,EAAyE,IAAzE,CAAZ;IACA,IAAMG,KAAK,GAAG,IAAI,KAAKvC,OAAL,CAAawC,QAAjB,CAA0B9D,IAA1B,EAAgC0D,GAAhC,EAAqCP,OAArC,CAAd;IACAU,KAAK,CAAC5D,KAAN,CAAY8D,IAAZ,GAAmB,KAAK1C,OAAL,CAAa2C,IAAb,CAAkB,KAAKjE,QAAvB,CAAnB;IACA8D,KAAK,CAACI,UAAN,CAAiBb,EAAjB,EAAqBC,EAArB,EAAyBC,cAAzB,EAAyCC,SAAzC,EAAoDC,KAApD;;IACA,IAAI,KAAK3C,SAAL,CAAeS,OAAf,CAAuB4C,gBAA3B,EAA6C;MAC3CL,KAAK,CAACM,UAAN,CAAiBC,WAAjB,GAA+BX,MAA/B;IACD;;IACD,IAAI,KAAK5C,SAAL,CAAeS,OAAf,CAAuB+C,iBAA3B,EAA8C;MAC5CR,KAAK,CAACM,UAAN,CAAiBG,YAAjB,GAAgCb,MAAhC;IACD;;IACDI,KAAK,CAACvE,OAAN,CAAc,IAAd,EAAoBgB,GAApB;IACA,OAAQuD,KAAK,CAACU,WAAN,IAAqBV,KAAK,CAACW,IAAnC;EACD,CApBM;;EAyBA3C,0CAAP,UAAgB4C,QAAhB,EAA2C;IAA3B;MAAAA;IAA2B;;IACzC,KAAK9D,SAAL,CAAe+D,GAAf,CAAmB,UAAnB;IACA,OAAO,IAAP;EACD,CAHM;;EAQA7C,yCAAP;;;IACE,IAAI,CAAC,KAAKlB,SAAL,CAAegE,KAAf,CAAqB,SAArB,CAAL,EAAsC;MAIpC,IAAMC,SAAS,GAAG,EAAlB;;;QACA,KAAmB,uBAAK5E,IAAL,GAASF,cAA5B,EAA4B,QAA5B,EAA4BA,cAA5B,EAA8B;UAAzB,IAAME,IAAI,WAAV;UACH,KAAK6E,WAAL,CAAiB7E,IAAjB;;UACA,IAAIA,IAAI,CAAC8E,SAAL,CAAeF,SAAf,KAA6BG,SAAjC,EAA4C;YAC1CH,SAAS,CAACI,IAAV,CAAehF,IAAf;UACD;QACF;;;;;;;;;;;;;;QAKD,KAAmB,uCAASiF,kCAA5B,EAA4B,mBAA5B,EAA4BA,kCAA5B,EAA8B;UAAzB,IAAMjF,IAAI,sBAAV;UACH,IAAMkF,IAAI,GAAGlF,IAAI,CAAC8E,SAAL,CAAeF,SAA5B;UACA5E,IAAI,CAAC+C,KAAL,CAAWmC,IAAI,CAACnC,KAAhB;UACA/C,IAAI,CAAC8E,SAAL,CAAeF,SAAf,GAA2BM,IAA3B;UACA,KAAKL,WAAL,CAAiB7E,IAAjB;QACD;;;;;;;;;;;;;MACD,KAAKW,SAAL,CAAe+D,GAAf,CAAmB,SAAnB;IACD;;IACD,OAAO,IAAP;EACD,CAzBM;;EA8BG7C,6CAAV,UAAsB7B,IAAtB,EAA6C;IAC3C,IAAI;MACFA,IAAI,CAACmF,OAAL,CAAa,IAAb;IACD,CAFD,CAEE,OAAOC,GAAP,EAAY;MACZ,IAAIA,GAAG,CAACC,KAAJ,IAAaD,GAAG,CAACE,OAArB,EAA8B;QAC5B,MAAMF,GAAN;MACD;;MACD,KAAK9D,OAAL,CAAa,cAAb,EAA6B,IAA7B,EAAmCtB,IAAnC,EAAyCoF,GAAzC;MACApF,IAAI,CAAC8E,SAAL,CAAe,OAAf,IAA0BM,GAA1B;IACD;EACF,CAVS;;EAkBHvD,8CAAP,UAAoB7B,IAApB,EAA6CoF,GAA7C,EAAuD;IACrDpF,IAAI,CAACwE,IAAL,GAAY,KAAKrC,UAAL,CAAgBP,MAAhB,CAAuB,MAAvB,EAA+B,IAA/B,EAAqC,CAC/C,KAAKO,UAAL,CAAgBP,MAAhB,CAAuB,QAAvB,EAAiC;MAAC,kBAAkBwD,GAAG,CAACG,OAAvB;MAAgCC,KAAK,EAAEJ,GAAG,CAACG;IAA3C,CAAjC,EAAsF,CACpF,KAAKpD,UAAL,CAAgBP,MAAhB,CAAuB,OAAvB,EAAgC,IAAhC,EAAsC,CACnC,KAAKO,UAAL,CAAgBP,MAAhB,CAAuB,MAAvB,EAA4C6D,OAA5C,CAAoD,kBAApD,CADmC,CAAtC,CADoF,CAAtF,CAD+C,CAArC,CAAZ;;IAOA,IAAIzF,IAAI,CAACmD,OAAT,EAAkB;MAChBnD,IAAI,CAACwE,IAAL,CAAUkB,UAAV,CAAqBhB,GAArB,CAAyB,SAAzB,EAAoC,OAApC;IACD;;IACD1E,IAAI,CAAC8E,SAAL,CAAea,KAAf,GAAuBP,GAAG,CAACG,OAA3B;EACD,CAZM;;EAiBA1D,yCAAP;;;IACE,IAAI,CAAC,KAAKlB,SAAL,CAAegE,KAAf,CAAqB,SAArB,CAAL,EAAsC;;QACpC,KAAmB,uBAAK3E,IAAL,GAASjB,cAA5B,EAA4B,QAA5B,EAA4BA,cAA5B,EAA8B;UAAzB,IAAMiB,IAAI,WAAV;;UACH,IAAI;YACFA,IAAI,CAAC4F,OAAL,CAAa,IAAb;UACD,CAFD,CAEE,OAAOR,GAAP,EAAY;YACZ,IAAIA,GAAG,CAACC,KAAJ,IAAaD,GAAG,CAACE,OAArB,EAA8B;cAC5B,MAAMF,GAAN;YACD;;YACD,KAAK9D,OAAL,CAAa,cAAb,EAA6B,IAA7B,EAAmCtB,IAAnC,EAAyCoF,GAAzC;YACApF,IAAI,CAACmE,UAAL,CAAgB,OAAhB,IAA2BiB,GAA3B;UACD;QACF;;;;;;;;;;;;;MACD,KAAKzE,SAAL,CAAe+D,GAAf,CAAmB,SAAnB;IACD;;IACD,OAAO,IAAP;EACD,CAhBM;;EAwBA7C,8CAAP,UAAoB7B,IAApB,EAA6CoF,GAA7C,EAAuD;IACrDpF,IAAI,CAACuE,WAAL,GAAmB,KAAKlD,OAAL,CAAa0C,IAAb,CAAkB,eAAlB,EAAmC;MACpD8B,KAAK,EAAE,0BAD6C;MAEpDnC,GAAG,EAAE,KAAK7C,SAAL,CAAeqC;IAFgC,CAAnC,EAGhB,CACD,KAAK7B,OAAL,CAAa0C,IAAb,CAAkB,MAAlB,EAA0B;MACxB,kBAAkBqB,GAAG,CAACG,OADE;MAExBC,KAAK,EAAEJ,GAAG,CAACG,OAFa;MAGxBO,KAAK,EAAE;QACLC,KAAK,EAAE,KADF;QAEL,oBAAoB,QAFf;QAGL,eAAe;MAHV;IAHiB,CAA1B,EAQG,CACD,KAAK1E,OAAL,CAAa2E,IAAb,CAAkB,mBAAlB,CADC,CARH,CADC,CAHgB,CAAnB;;IAgBA,IAAIhG,IAAI,CAACmD,OAAT,EAAkB;MAChB,KAAK9B,OAAL,CAAa4E,aAAb,CAA2BjG,IAAI,CAACuE,WAAhC,EAA6C;QAC3CuB,KAAK,EAAE;UACL3C,OAAO,EAAE,OADJ;UAEL+C,MAAM,EAAE,OAFH;UAGL,cAAc;QAHT;MADoC,CAA7C;IAOD;;IACDlG,IAAI,CAACmE,UAAL,CAAgBwB,KAAhB,GAAwBP,GAAG,CAACG,OAA5B;EACD,CA3BM;;EAgCA1D,4CAAP;IACE,IAAI,CAAC,KAAKlB,SAAL,CAAegE,KAAf,CAAqB,YAArB,CAAL,EAAyC;MACvC,KAAK9D,SAAL,CAAesF,UAAf,CAA0B,IAA1B;MACA,KAAKxF,SAAL,CAAe+D,GAAf,CAAmB,YAAnB;IACD;;IACD,OAAO,IAAP;EACD,CANM;;EAWA7C,gDAAP;;;IACE,IAAI,CAAC,KAAKlB,SAAL,CAAegE,KAAf,CAAqB,gBAArB,CAAL,EAA6C;;QAC3C,KAAmB,uBAAK3E,IAAL,CAAUoG,QAAV,KAAoBrH,cAAvC,EAAuC,QAAvC,EAAuCA,cAAvC,EAAyC;UAApC,IAAMiB,IAAI,WAAV;UACHA,IAAI,CAACqG,cAAL,CAAoB,IAApB;QACD;;;;;;;;;;;;;MACD,KAAK1F,SAAL,CAAe+D,GAAf,CAAmB,gBAAnB;IACD;;IACD,OAAO,IAAP;EACD,CARM;;EAaA7C,oDAAP,UAA0ByE,QAA1B,EAAmD;IAAzB;MAAAA;IAAyB;;IACjD,OAAO,IAAP;EACD,CAFM;;EAOAzE,uCAAP,UAAakB,KAAb,EAA4BwD,OAA5B,EAAoD;;;IAAxB;MAAAA;IAAwB;;;MAClD,KAAmB,uBAAKvG,IAAL,GAASjB,cAA5B,EAA4B,QAA5B,EAA4BA,cAA5B,EAA8B;QAAzB,IAAMiB,IAAI,WAAV;QACHA,IAAI,CAAC+C,KAAL,CAAWA,KAAX,EAAkBwD,OAAlB;MACD;;;;;;;;;;;;;IACD,IAAIxD,KAAK,GAAG7C,oBAAMsG,QAAlB,EAA4B;MAC1B,KAAK7F,SAAL,CAAe8F,KAAf,CAAqB,gBAArB;IACD;;IACD,IAAI1D,KAAK,GAAG7C,oBAAMwG,OAAlB,EAA2B;MACzB,KAAK/F,SAAL,CAAe8F,KAAf,CAAqB,SAArB;MACA,KAAK9F,SAAL,CAAe8F,KAAf,CAAqB,YAArB;IACD;;IACD,IAAI1D,KAAK,GAAG7C,oBAAMyG,QAAlB,EAA4B;MAC1B,KAAKhG,SAAL,CAAe8F,KAAf,CAAqB,SAArB;IACD;;IACD,OAAO,IAAP;EACD,CAfM;;EAoBA5E,uCAAP,UAAaP,OAAb,EAAmD;;;IAAtC;MAAAA;QAAsBX,SAAS,EAAE;MAAjC;IAAsC;;IACjDW,OAAO,GAAG,8BAAYkB,MAAM,CAACoE,MAAP,CAAc,EAAd,EAAkBnG,oBAAlB,CAAZ,EAA6Ca,OAA7C,CAAV;IACAA,OAAO,CAACZ,GAAR,IAAe8B,MAAM,CAACoE,MAAP,CAActF,OAAd,EAAuBb,uBAAvB,CAAf;IACAa,OAAO,CAACX,SAAR,IAAqB,KAAKA,SAAL,CAAekG,KAAf,EAArB;IACAvF,OAAO,CAACV,QAAR,IAAoB,KAAKA,QAAL,CAAckG,OAAd,CAAsB,eAAG;MAAI,UAAG,CAACD,KAAJ,CAASE,KAAT,MAAGC,yBAAU1F,OAAO,CAACV,QAAlB,GAA0B,KAA1B,CAAH;IAA8B,CAA3D,CAApB;IACAU,OAAO,CAACT,SAAR,IAAqB,WAAKA,SAAL,EAAegG,KAAf,CAAoBE,KAApB,CAAoBvH,EAApB,EAAoBwH,yBAAI1F,OAAO,CAACT,SAAZ,GAAqB,KAArB,CAApB,CAArB;IACA,OAAO,IAAP;EACD,CAPM;;EAYAgB,uCAAP;IACE,KAAKgF,KAAL;IACA,KAAK7G,IAAL,CAAUyG,KAAV;IACA,OAAO,IAAP;EACD,CAJM;;EASA5E,wCAAP,UAAchD,IAAd,EAAqC;IACnC,KAAKmB,IAAL,CAAUiH,KAAV,CAAgBpI,IAAhB;IACA,OAAO,IAAP;EACD,CAHM;;EAQAgD,sDAAP,UAA4BqF,UAA5B,EAAwD;;;IACtD,IAAM9G,KAAK,GAAG,KAAK+G,kBAAL,CAAwBD,UAAxB,CAAd;;IACA,WAAKlH,IAAL,EAAU6C,MAAV,CAAgBkE,KAAhB,CAAgBvH,EAAhB,EAAgBwH,yBAAI5G,KAAJ,GAAS,KAAT,CAAhB;;IACA,OAAOA,KAAP;EACD,CAJM;;EASAyB,oDAAP,UAA0BuF,QAA1B,EAAoD;;;IAClD,IAAI,CAACrF,KAAK,CAACC,OAAN,CAAcoF,QAAd,CAAL,EAA8B;MAC5BA,QAAQ,GAAG,CAACA,QAAD,CAAX;IACD;;IACD,IAAM/F,OAAO,GAAG,KAAKA,OAArB;IACA,IAAMjB,KAAK,GAAG,EAAd;IACA,IAAM8G,UAAU,GAAG7F,OAAO,CAACgG,WAAR,CAAoBD,QAApB,EAA8B,KAAKrH,QAAnC,CAAnB;;;MACAuH,KAAK,EACL,KAAmB,uBAAKtH,IAAL,GAASF,cAA5B,EAA4B,QAA5B,EAA4BA,cAA5B,EAA8B;QAAzB,IAAMO,IAAI,WAAV;;;UACH,KAAwB,0DAAUkH,oCAAlC,EAAkC,oBAAlC,EAAkCA,oCAAlC,EAAoC;YAA/B,IAAMC,SAAS,uBAAf;;YACH,IAAInH,IAAI,CAACJ,KAAL,CAAW8D,IAAX,IAAmB1C,OAAO,CAACoG,QAAR,CAAiBD,SAAjB,EAA4BnH,IAAI,CAACJ,KAAL,CAAW8D,IAAvC,CAAvB,EAAqE;cACnE3D,KAAK,CAAC4E,IAAN,CAAW3E,IAAX;cACA,SAASiH,KAAT;YACD;UACF;;;;;;;;;;;;MACF;;;;;;;;;;;;;IACD,OAAOlH,KAAP;EACD,CAjBM;;EAjZOyB,4BAAe,cAAf;EAKAA,+BAAsB;IAClC6F,SAAS,EAAE,IADuB;IAElCC,QAAQ,EAAE,IAFwB;IAGlCC,UAAU,EAAE,IAHsB;IAIlCC,QAAQ,EAAEnG,eAJwB;IAKlCoC,QAAQ,EAAEgE,eALwB;IAMlCC,YAAY,EAAE,sBAACC,GAAD,EAA2ChI,IAA3C,EAA0EoF,GAA1E,EAAoF;MAChG4C,GAAG,CAACD,YAAJ,CAAiB/H,IAAjB,EAAuBoF,GAAvB;IACD,CARiC;IASlC6C,YAAY,EAAE,sBAACD,GAAD,EAA2ChI,IAA3C,EAA0EoF,GAA1E,EAAoF;MAChG4C,GAAG,CAACC,YAAJ,CAAiBjI,IAAjB,EAAuBoF,GAAvB;IACD,CAXiC;IAYlCzD,aAAa,EAAE,6BAAW;MACxBuG,IAAI,EAAK,CAAChI,oBAAMiI,QAAP,EAAiB,UAAjB,EAA6B,EAA7B,EAAiC,KAAjC,CADe;MAExBhD,OAAO,EAAE,CAACjF,oBAAMyG,QAAP,CAFe;MAGxByB,OAAO,EAAE,CAAClI,oBAAMmI,OAAP,EAAgB,YAAhB,EAA8B,EAA9B,EAAkC,KAAlC,CAHe;MAIxBzC,OAAO,EAAE,CAAC1F,oBAAMwG,OAAP,CAJe;MAKxB4B,MAAM,EAAG,CAACpI,oBAAMsG,QAAP,EAAiB,gBAAjB,EAAmC,KAAnC;IALe,CAAX;EAZmB,CAAtB;EAwBA3E,mCAAc,iCAAc,UAAd,EAA0B,SAA1B,EAAqC,YAArC,EAAmD,SAAnD,EAA8D,gBAA9D,CAAd;EAuYhB;AAAC,CAzaD;;AAAsBpB","names":["__extends","RenderList","actions","list","keys","_c","id","action","priority","add","renderDoc","renderMath","convert","length","_a","methodActions","slice","method1","method2","_b","_d","document","math","start","MathItem_js_1","UNPROCESSED","items","item","end","LAST","PrioritizedList_js_1","exports","all","processed","inputJax","outputJax","DefaultInputJax","_math","InputJax_js_1","DefaultOutputJax","_document","OutputJax_js_1","MathList_js_1","adaptor","options","CLASS","constructor","OPTIONS","DefaultMathList","renderActions","create","AbstractMathDocument","ProcessBits","Array","isArray","setAdaptor","map","mmlFactory","MmlFactory_js_1","setMmlFactory","_this","initialize","Object","KIND","fn","p","findID","remove","RERENDER","state","render","format","name","display","em","ex","containerWidth","lineWidth","scale","family","jax","reduce","ijax","mitem","MathItem","node","body","setMetrics","mtextInheritFont","outputData","mtextFamily","merrorInheritFont","merrorFamily","typesetRoot","root","_options","set","isSet","recompile","compileMath","inputData","undefined","push","recompile_1_1","data","compile","err","retry","restart","message","title","setText","attributes","error","typeset","class","style","color","text","setAttributes","margin","getMetrics","reversed","updateDocument","_restore","restore","INSERTED","clear","TYPESET","COMPILED","assign","reset","forEach","apply","__spreadArray","merge","containers","getMathItemsWithin","elements","getElements","ITEMS","containers_1_1","container","contains","OutputJax","InputJax","MmlFactory","MathList","DefaultMathItem","compileError","doc","typesetError","find","FINDMATH","metrics","METRICS","update"],"sourceRoot":"","sources":["../../ts/core/MathDocument.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}