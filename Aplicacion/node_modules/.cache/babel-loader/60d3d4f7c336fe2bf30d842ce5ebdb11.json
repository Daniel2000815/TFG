{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\daniz\\\\TFG\\\\Aplicacion\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\daniz\\\\TFG\\\\Aplicacion\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from\"react\";import{useCallback,useEffect}from\"react\";import ReactFlow,{addEdge,Background,useNodesState,useEdgesState,MarkerType}from\"react-flow-renderer\";import ButtonEdge from'./ButtonEdge.js';import PrimitiveNode from\"./PrimitiveNode.js\";import BooleanNode from\"./BooleanNode.js\";import\"./styles.css\";var initialNodes=[{id:\"node-0\",type:\"booleanNode\",position:{x:0,y:0},data:{sdf:\"sphere(1.0)\"}},{id:\"node-1\",type:\"primitiveNode\",position:{x:250,y:0},data:{sdf:\"box(1.0, 1.0, 1.0)\"}},{id:\"node-2\",type:\"primitiveNode\",position:{x:250,y:-300},data:{sdf:\"\"}}];var initialEdges=[];var nodeTypes={primitiveNode:PrimitiveNode,booleanNode:BooleanNode};var onInit=function onInit(reactFlowInstance){return console.log('flow loaded:',reactFlowInstance);};export default function Graph(){var _useNodesState=useNodesState([]),_useNodesState2=_slicedToArray(_useNodesState,3),nodes=_useNodesState2[0],setNodes=_useNodesState2[1],onNodesChange=_useNodesState2[2];var _useEdgesState=useEdgesState(initialEdges),_useEdgesState2=_slicedToArray(_useEdgesState,3),edges=_useEdgesState2[0],setEdges=_useEdgesState2[1],onEdgesChange=_useEdgesState2[2];// no funciona: borra todos\nvar onRemoveEdge=function onRemoveEdge(id){console.log(edges);setEdges(edges.filter(function(edge){return edge.id==id;}));onEdgesChange(edges);};var updateNodeSdf=function updateNodeSdf(id,newSdf){console.log(\"ALO\");setNodes(function(nds){return nds.map(function(node){if(node.id===id){node.data=_objectSpread(_objectSpread({},node.data),{},{sdf:newSdf});}return node;});});};var onConnect=useCallback(function(params){return setEdges(function(eds){return addEdge(_objectSpread(_objectSpread({},params),{},{animated:true,markerEnd:{type:MarkerType.Arrow,color:'#000'},data:{}}),eds);});},[]);useEffect(function(){console.log(\"ASASA\");console.log(edges);},[edges]);var newNode=function newNode(){return{id:\"node-\".concat(nodes.length),type:\"primitiveNode\",position:{x:0,y:0},data:{sdf:\"sphere(p, 1.0)\",onChangeSdf:updateNodeSdf}};};var handleKey=function handleKey(e){// SPACE BAR\nif(e.key===\" \"){var node=newNode();nodes.push(node);onNodesChange([node]);// Para actualizar\n}};return/*#__PURE__*/React.createElement(\"div\",{style:{height:\"100vh\"},tabIndex:\"0\",onKeyDown:handleKey},/*#__PURE__*/React.createElement(ReactFlow,{nodes:nodes,edges:edges,onNodesChange:onNodesChange,onEdgesChange:onEdgesChange,onConnect:onConnect// onDisconnect={onDisconnect}\n,nodeTypes:nodeTypes,onInit:onInit,onEdgeClick:function onEdgeClick(ev,edge){return setEdges(edges.filter(function(e){return e.id!=edge.id;}));},snapToGrid:true,fitView:true},/*#__PURE__*/React.createElement(Background,{color:\"#aaa\",gap:10})));}","map":{"version":3,"names":["React","useCallback","useEffect","ReactFlow","addEdge","Background","useNodesState","useEdgesState","MarkerType","ButtonEdge","PrimitiveNode","BooleanNode","initialNodes","id","type","position","x","y","data","sdf","initialEdges","nodeTypes","primitiveNode","booleanNode","onInit","reactFlowInstance","console","log","Graph","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","onRemoveEdge","filter","edge","updateNodeSdf","newSdf","nds","map","node","onConnect","params","eds","animated","markerEnd","Arrow","color","newNode","length","onChangeSdf","handleKey","e","key","push","height","ev"],"sources":["C:/Users/daniz/TFG/Aplicacion/src/Graph.js"],"sourcesContent":["import React from \"react\";\r\nimport { useCallback, useEffect } from \"react\";\r\nimport ReactFlow, {\r\n  addEdge,\r\n  Background,\r\n  useNodesState,\r\n  useEdgesState,\r\n  MarkerType\r\n} from \"react-flow-renderer\";\r\nimport ButtonEdge from './ButtonEdge.js';\r\nimport PrimitiveNode from \"./PrimitiveNode.js\";\r\nimport BooleanNode from \"./BooleanNode.js\";\r\n\r\nimport \"./styles.css\";\r\n\r\nconst initialNodes = [\r\n  {\r\n    id: \"node-0\",\r\n    type: \"booleanNode\",\r\n    position: { x: 0, y: 0 },\r\n    data: { sdf: \"sphere(1.0)\" }\r\n  },\r\n  {\r\n    id: \"node-1\",\r\n    type: \"primitiveNode\",\r\n    position: { x: 250, y: 0 },\r\n    data: { sdf: \"box(1.0, 1.0, 1.0)\" }\r\n  },\r\n  {\r\n    id: \"node-2\",\r\n    type: \"primitiveNode\",\r\n    position: { x: 250, y: -300},\r\n    data: { sdf: \"\" }\r\n  }\r\n];\r\n\r\nconst initialEdges = [\r\n\r\n];\r\n\r\nconst nodeTypes = { primitiveNode: PrimitiveNode, booleanNode: BooleanNode };\r\n\r\nconst onInit = (reactFlowInstance) => console.log('flow loaded:', reactFlowInstance);\r\n\r\nexport default function Graph() {\r\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\r\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\r\n\r\n  // no funciona: borra todos\r\n  const onRemoveEdge = (id) =>{\r\n    console.log(edges);\r\n    setEdges(edges.filter(edge => edge.id == id));\r\n    onEdgesChange(edges);\r\n  }\r\n\r\n  const updateNodeSdf = (id, newSdf) =>{\r\n    console.log(\"ALO\");\r\n    setNodes((nds) =>\r\n      nds.map((node) => {\r\n        if (node.id === id) {\r\n          node.data = {\r\n            ...node.data,\r\n            sdf: newSdf,\r\n          };\r\n        }\r\n\r\n        return node;\r\n      })\r\n    );\r\n  }\r\n\r\n  const onConnect = useCallback(\r\n    \r\n    (params) => setEdges(\r\n      (eds) => addEdge(\r\n        { \r\n          ...params, \r\n          animated:true, \r\n          markerEnd: { type: MarkerType.Arrow, color: '#000' }, \r\n          data: {} \r\n        }, \r\n        eds)\r\n      ),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    console.log(\"ASASA\");\r\n    console.log(edges);\r\n  }, [edges]);\r\n\r\n  const newNode = () =>{\r\n    return {\r\n      id: `node-${nodes.length}`,\r\n      type: \"primitiveNode\",\r\n      position: { x: 0, y: 0 },\r\n      data: { \r\n        sdf: \"sphere(p, 1.0)\",\r\n        onChangeSdf: updateNodeSdf\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleKey= (e) => {\r\n    // SPACE BAR\r\n    if (e.key === \" \") {\r\n      const node = newNode();\r\n      nodes.push(node);\r\n\r\n      onNodesChange([node]);  // Para actualizar\r\n    }\r\n\r\n  };\r\n\r\n  return (\r\n    <div style={{height: \"100vh\"}} tabIndex=\"0\" onKeyDown={handleKey}>\r\n      <ReactFlow\r\n        nodes={nodes}\r\n        edges={edges}\r\n\r\n        onNodesChange={onNodesChange}\r\n        onEdgesChange={onEdgesChange}\r\n        onConnect={onConnect}\r\n        // onDisconnect={onDisconnect}\r\n\r\n        nodeTypes={nodeTypes}\r\n\r\n        onInit={onInit}\r\n        onEdgeClick={(ev, edge)=>setEdges(edges.filter(e => e.id != edge.id))}\r\n\r\n        snapToGrid={true}\r\n        fitView\r\n      >\r\n        <Background color=\"#aaa\" gap={10} />\r\n        </ReactFlow>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}