{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommonMsubsupMixin = exports.CommonMsupMixin = exports.CommonMsubMixin = void 0;\n\nfunction CommonMsubMixin(Base) {\n  var _a;\n\n  return _a = function (_super) {\n    __extends(class_1, _super);\n\n    function class_1() {\n      return _super !== null && _super.apply(this, arguments) || this;\n    }\n\n    Object.defineProperty(class_1.prototype, \"scriptChild\", {\n      get: function get() {\n        return this.childNodes[this.node.sub];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_1.prototype.getOffset = function () {\n      return [0, -this.getV()];\n    };\n\n    return class_1;\n  }(Base), _a.useIC = false, _a;\n}\n\nexports.CommonMsubMixin = CommonMsubMixin;\n\nfunction CommonMsupMixin(Base) {\n  return function (_super) {\n    __extends(class_2, _super);\n\n    function class_2() {\n      return _super !== null && _super.apply(this, arguments) || this;\n    }\n\n    Object.defineProperty(class_2.prototype, \"scriptChild\", {\n      get: function get() {\n        return this.childNodes[this.node.sup];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_2.prototype.getOffset = function () {\n      var x = this.getAdjustedIc() - (this.baseRemoveIc ? 0 : this.baseIc);\n      return [x, this.getU()];\n    };\n\n    return class_2;\n  }(Base);\n}\n\nexports.CommonMsupMixin = CommonMsupMixin;\n\nfunction CommonMsubsupMixin(Base) {\n  var _a;\n\n  return _a = function (_super) {\n    __extends(class_3, _super);\n\n    function class_3() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.UVQ = null;\n      return _this;\n    }\n\n    Object.defineProperty(class_3.prototype, \"subChild\", {\n      get: function get() {\n        return this.childNodes[this.node.sub];\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(class_3.prototype, \"supChild\", {\n      get: function get() {\n        return this.childNodes[this.node.sup];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_3.prototype.computeBBox = function (bbox, recompute) {\n      if (recompute === void 0) {\n        recompute = false;\n      }\n\n      var basebox = this.baseChild.getOuterBBox();\n\n      var _a = __read([this.subChild.getOuterBBox(), this.supChild.getOuterBBox()], 2),\n          subbox = _a[0],\n          supbox = _a[1];\n\n      bbox.empty();\n      bbox.append(basebox);\n      var w = this.getBaseWidth();\n      var x = this.getAdjustedIc();\n\n      var _b = __read(this.getUVQ(), 2),\n          u = _b[0],\n          v = _b[1];\n\n      bbox.combine(subbox, w, v);\n      bbox.combine(supbox, w + x, u);\n      bbox.w += this.font.params.scriptspace;\n      bbox.clean();\n      this.setChildPWidths(recompute);\n    };\n\n    class_3.prototype.getUVQ = function (subbox, supbox) {\n      if (subbox === void 0) {\n        subbox = this.subChild.getOuterBBox();\n      }\n\n      if (supbox === void 0) {\n        supbox = this.supChild.getOuterBBox();\n      }\n\n      var basebox = this.baseCore.getOuterBBox();\n      if (this.UVQ) return this.UVQ;\n      var tex = this.font.params;\n      var t = 3 * tex.rule_thickness;\n      var subscriptshift = this.length2em(this.node.attributes.get('subscriptshift'), tex.sub2);\n      var drop = this.baseCharZero(basebox.d * this.baseScale + tex.sub_drop * subbox.rscale);\n\n      var _a = __read([this.getU(), Math.max(drop, subscriptshift)], 2),\n          u = _a[0],\n          v = _a[1];\n\n      var q = u - supbox.d * supbox.rscale - (subbox.h * subbox.rscale - v);\n\n      if (q < t) {\n        v += t - q;\n        var p = 4 / 5 * tex.x_height - (u - supbox.d * supbox.rscale);\n\n        if (p > 0) {\n          u += p;\n          v -= p;\n        }\n      }\n\n      u = Math.max(this.length2em(this.node.attributes.get('superscriptshift'), u), u);\n      v = Math.max(this.length2em(this.node.attributes.get('subscriptshift'), v), v);\n      q = u - supbox.d * supbox.rscale - (subbox.h * subbox.rscale - v);\n      this.UVQ = [u, -v, q];\n      return this.UVQ;\n    };\n\n    return class_3;\n  }(Base), _a.useIC = false, _a;\n}\n\nexports.CommonMsubsupMixin = CommonMsubsupMixin;","map":{"version":3,"mappings":"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","names":["CommonMsubMixin","Base","__extends","Object","class_1","childNodes","node","sub","getV","_a","exports","CommonMsupMixin","class_2","sup","x","getAdjustedIc","baseRemoveIc","baseIc","getU","CommonMsubsupMixin","_this","class_3","bbox","recompute","basebox","baseChild","getOuterBBox","subChild","supChild","subbox","supbox","empty","append","w","getBaseWidth","getUVQ","u","v","combine","font","params","scriptspace","clean","setChildPWidths","baseCore","UVQ","tex","t","rule_thickness","subscriptshift","length2em","attributes","get","sub2","drop","baseCharZero","d","baseScale","sub_drop","rscale","Math","max","q","h","p","x_height"],"sourceRoot":"","sources":["../../../../ts/output/common/Wrappers/msubsup.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}