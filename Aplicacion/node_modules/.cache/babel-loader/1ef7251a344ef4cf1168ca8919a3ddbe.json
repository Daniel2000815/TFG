{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isNil from \"lodash/isNil\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNumber from \"lodash/isNumber\";\nimport _isString from \"lodash/isString\";\nimport _omit from \"lodash/omit\";\nimport _get from \"lodash/get\";\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport _isArray from \"lodash/isArray\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\nimport { polyfill } from 'react-lifecycles-compat';\nimport shallowEqual from '../utils/shallowEqual';\nimport TreeNode from './TreeNode';\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\nimport { flattenTree, getExpandWhenSearching, getNodeParents, shouldShowNodeByExpanded, getVirtualLisHeight, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction } from '../utils/treeUtils';\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, shouldDisplay } from '../Picker';\nimport { TREE_NODE_DROP_POSITION } from '../constants';\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes'; // default value for virtualized\n\nvar defaultHeight = 360;\nvar defaultWidth = 200;\n\nvar TreePicker = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(TreePicker, _React$Component);\n\n  function TreePicker(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.menuRef = void 0;\n    _this.treeViewRef = void 0;\n    _this.positionRef = void 0;\n    _this.listRef = void 0;\n    _this.triggerRef = void 0;\n    _this.toggleRef = void 0;\n\n    _this.getFocusableMenuItems = function () {\n      var filterData = _this.state.filterData;\n      var _this$props = _this.props,\n          childrenKey = _this$props.childrenKey,\n          _this$props$disabledI = _this$props.disabledItemValues,\n          disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\n          valueKey = _this$props.valueKey;\n      var items = [];\n\n      var loop = function loop(nodes) {\n        nodes.forEach(function (node) {\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\n\n          var disabled = disabledItemValues.some(function (disabledItem) {\n            return shallowEqual(disabledItem, node[valueKey]);\n          });\n\n          if (!disabled) {\n            items.push(node);\n          }\n\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\n            loop(node[childrenKey]);\n          }\n        });\n      };\n\n      loop(filterData);\n      return items;\n    };\n\n    _this.getElementByDataKey = function (dataKey) {\n      var ele = _this.nodeRefs[dataKey];\n\n      if (ele instanceof Element) {\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\n      }\n\n      return null;\n    };\n\n    _this.nodes = {};\n    _this.node = null;\n    _this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      minHeight: 20\n    });\n    _this.nodeRefs = {};\n    _this.dragNode = null;\n\n    _this.bindNodeRefs = function (refKey, ref) {\n      _this.nodeRefs[refKey] = ref;\n    };\n\n    _this.getPositionInstance = function () {\n      return _this.positionRef.current;\n    };\n\n    _this.getToggleInstance = function () {\n      return _this.toggleRef.current;\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.addTreePrefix = function (name) {\n      return prefix(defaultClassPrefix('tree'))(name);\n    };\n\n    _this.selectActiveItem = function (event) {\n      var _this$getActiveItem = _this.getActiveItem(),\n          nodeData = _this$getActiveItem.nodeData;\n\n      _this.handleSelect(nodeData, event);\n    };\n\n    _this.focusNextItem = function () {\n      var _node$focus;\n\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi.items,\n          activeIndex = _this$getItemsAndActi.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\n\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\n    };\n\n    _this.focusPreviousItem = function () {\n      var _node$focus2;\n\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\n          items = _this$getItemsAndActi2.items,\n          activeIndex = _this$getItemsAndActi2.activeIndex;\n\n      if (items.length === 0) {\n        return;\n      }\n\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\n\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\n\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\n    };\n\n    _this.handleCloseDropdown = function () {\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\n\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\n    };\n\n    _this.handleOpenDropdown = function () {\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\n\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleToggleDropdown = function () {\n      var active = _this.state.active;\n\n      if (active) {\n        _this.handleCloseDropdown();\n\n        return;\n      }\n\n      _this.handleOpenDropdown();\n    };\n\n    _this.handleToggle = function (nodeData) {\n      var _this$props2 = _this.props,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey,\n          onExpand = _this$props2.onExpand,\n          expandItemValues = _this$props2.expandItemValues;\n\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\n\n      if (_isUndefined(expandItemValues)) {\n        _this.unserializeLists('expand', nextExpandItemValues);\n\n        _this.setState({\n          expandItemValues: nextExpandItemValues\n        });\n      }\n\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }));\n    };\n\n    _this.handleSelect = function (nodeData, event) {\n      var _this$toggleRef$curre;\n\n      var _this$props3 = _this.props,\n          valueKey = _this$props3.valueKey,\n          onChange = _this$props3.onChange,\n          onSelect = _this$props3.onSelect,\n          value = _this$props3.value;\n      _this.node = nodeData;\n\n      if (_isUndefined(value)) {\n        _this.setState({\n          activeNode: nodeData,\n          selectedValue: nodeData[valueKey]\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeData[valueKey], event);\n\n      _this.handleCloseDropdown();\n\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\n    };\n\n    _this.handleKeyDown = function (event) {\n      onMenuKeyDown(event, {\n        down: _this.focusNextItem,\n        up: _this.focusPreviousItem,\n        enter: _this.selectActiveItem,\n        del: _this.handleClean\n      });\n    };\n\n    _this.handleToggleKeyDown = function (event) {\n      var _this$state = _this.state,\n          activeNode = _this$state.activeNode,\n          active = _this$state.active; // enter\n\n      if ((!activeNode || !active) && event.keyCode === 13) {\n        _this.handleToggleDropdown();\n      } // delete\n\n\n      if (event.keyCode === 8) {\n        _this.handleClean(event);\n      }\n\n      if (!_this.treeViewRef.current) {\n        return;\n      }\n\n      if (event.target instanceof HTMLElement) {\n        var className = event.target.className;\n\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\n          onMenuKeyDown(event, {\n            down: _this.focusNextItem\n          });\n        }\n      }\n    };\n\n    _this.handleSearch = function (value, event) {\n      var filterData = _this.state.filterData;\n      var _this$props4 = _this.props,\n          onSearch = _this$props4.onSearch,\n          searchKeyword = _this$props4.searchKeyword;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: value,\n          filterData: _this.getFilterData(filterData, value)\n        });\n      }\n\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props$onChange, _this$props5;\n\n      _this.setState({\n        activeNode: null,\n        selectedValue: null\n      });\n\n      _this.node = null;\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\n    };\n\n    _this.handleOnOpen = function () {\n      var _this$props$onOpen, _this$props6;\n\n      var activeNode = _this.state.activeNode;\n\n      if (activeNode) {\n        var _node$focus3;\n\n        var node = _this.getElementByDataKey(activeNode.refKey);\n\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\n      }\n\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleOnClose = function () {\n      var filterData = _this.state.filterData;\n      var _this$props7 = _this.props,\n          searchKeyword = _this$props7.searchKeyword,\n          onClose = _this$props7.onClose;\n\n      if (_isUndefined(searchKeyword)) {\n        _this.setState({\n          searchKeyword: '',\n          filterData: _this.getFilterData(filterData, '')\n        });\n      }\n\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n\n      _this.setState({\n        active: false\n      });\n    };\n\n    _this.handleDragStart = function (nodeData, event) {\n      var _this$props8 = _this.props,\n          valueKey = _this$props8.valueKey,\n          childrenKey = _this$props8.childrenKey,\n          onDragStart = _this$props8.onDragStart,\n          draggable = _this$props8.draggable;\n\n      if (draggable) {\n        _this.setState({\n          dragging: true,\n          dragNodeKeys: getDragNodeKeys(nodeData, childrenKey, valueKey)\n        });\n\n        _this.dragNode = _this.nodes[nodeData.refKey];\n        onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\n      }\n    };\n\n    _this.handleDragEnter = function (nodeData, event) {\n      var _this$state2 = _this.state,\n          dragging = _this$state2.dragging,\n          dragNodeKeys = _this$state2.dragNodeKeys;\n      var _this$props9 = _this.props,\n          valueKey = _this$props9.valueKey,\n          onDragEnter = _this$props9.onDragEnter;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n\n      if (dragging && _this.dragNode) {\n        var dropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n\n        _this.setState({\n          dragOverNodeKey: nodeData[valueKey],\n          dropNodePosition: dropNodePosition\n        });\n      }\n\n      onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\n    };\n\n    _this.handleDragOver = function (nodeData, event) {\n      var _this$state3 = _this.state,\n          dragNodeKeys = _this$state3.dragNodeKeys,\n          dragOverNodeKey = _this$state3.dragOverNodeKey,\n          dropNodePosition = _this$state3.dropNodePosition;\n      var _this$props10 = _this.props,\n          valueKey = _this$props10.valueKey,\n          onDragOver = _this$props10.onDragOver;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        return;\n      }\n\n      if (_this.dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\n        var lastDropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\n        if (lastDropNodePosition === dropNodePosition) return;\n\n        _this.setState({\n          dropNodePosition: lastDropNodePosition\n        });\n      }\n\n      onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\n    };\n\n    _this.handleDragLeave = function (nodeData, event) {\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\n    };\n\n    _this.handleDragEnd = function (nodeData, event) {\n      var onDragEnd = _this.props.onDragEnd;\n\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null\n      });\n\n      onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\n    };\n\n    _this.handleDrop = function (nodeData, event) {\n      var dragNodeKeys = _this.state.dragNodeKeys;\n      var _this$props11 = _this.props,\n          valueKey = _this$props11.valueKey,\n          onDrop = _this$props11.onDrop;\n\n      if (dragNodeKeys.some(function (d) {\n        return shallowEqual(d, nodeData[valueKey]);\n      })) {\n        console.error('Cannot drag a node to itself and its children');\n      } else {\n        var dropData = _this.getDropData(nodeData);\n\n        onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\n      }\n\n      _this.setState({\n        dragging: false,\n        dragNodeKeys: [],\n        dragOverNodeKey: null,\n        dropNodePosition: null\n      });\n\n      _this.dragNode = null;\n    };\n\n    _this.measureRowRenderer = function (nodes) {\n      return function (_ref) {\n        var key = _ref.key,\n            index = _ref.index,\n            style = _ref.style,\n            parent = _ref.parent;\n        var node = nodes[index];\n        return React.createElement(CellMeasurer, {\n          cache: _this.cache,\n          columnIndex: 0,\n          key: key,\n          rowIndex: index,\n          parent: parent\n        }, function () {\n          return _this.renderVirtualNode(node, {\n            key: key,\n            style: style\n          });\n        });\n      };\n    };\n\n    var _value = props.value,\n        data = props.data,\n        _valueKey = props.valueKey,\n        _props$searchKeyword = props.searchKeyword,\n        _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\n\n    var nextData = [].concat(data);\n\n    var _nextExpandItemValues = getExpandItemValues(props);\n\n    _this.flattenNodes(nextData);\n\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\n\n    _this.state = {\n      data: data,\n      value: _value,\n      dragging: false,\n      selectedValue: _this.getValue(props),\n      expandAll: getExpandAll(props),\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\n      searchKeyword: _searchKeyword,\n      expandItemValues: _this.serializeList('expand'),\n      dragNodeKeys: [],\n      dragOverNodeKey: null,\n      dropNodePosition: null\n    };\n    _this.treeViewRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.listRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    _this.toggleRef = React.createRef(); // for test\n\n    _this.menuRef = React.createRef();\n    treeDeprecatedWarning(props, ['expandAll']);\n    return _this;\n  }\n\n  var _proto = TreePicker.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var activeNode = this.state.activeNode;\n    this.focusNode(activeNode);\n  };\n\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n        data = nextProps.data,\n        expandAll = nextProps.expandAll,\n        searchKeyword = nextProps.searchKeyword,\n        expandItemValues = nextProps.expandItemValues;\n    var nextState = {};\n\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\n      nextState.data = data;\n    }\n\n    if (!shallowEqual(value, prevState.value)) {\n      nextState.value = value;\n      nextState.selectedValue = value;\n    }\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      nextState.expandItemValues = expandItemValues;\n    }\n\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\n      nextState.searchKeyword = searchKeyword;\n    }\n\n    if (expandAll !== prevState.expandAll) {\n      nextState.expandAll = expandAll;\n    }\n\n    return Object.keys(nextState).length ? nextState : null;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\n    this.updateDataChange(prevState);\n    this.updateValueChange(prevState);\n    this.updateExpandItemValuesChange(prevState);\n    this.updateSearchKeywordChange(prevState);\n\n    if (this.listRef.current) {\n      this.listRef.current.forceUpdateGrid();\n    }\n  };\n\n  _proto.updateDataChange = function updateDataChange(prevState) {\n    var _this$state4 = this.state,\n        searchKeyword = _this$state4.searchKeyword,\n        expandItemValues = _this$state4.expandItemValues;\n    var data = this.props.data;\n\n    if (prevState.data !== data) {\n      var nextData = [].concat(data);\n      this.flattenNodes(nextData);\n      var filterData = this.getFilterData(nextData, searchKeyword);\n      var activeNode = this.getActiveNode(this.getValue());\n      this.focusNode(activeNode);\n      this.unserializeLists('expand', expandItemValues);\n      var newState = {};\n\n      if (activeNode) {\n        newState = {\n          activeNode: activeNode\n        };\n      }\n\n      this.setState(_extends({}, {\n        data: nextData,\n        filterData: filterData,\n        expandItemValues: this.serializeList('expand')\n      }, {}, newState));\n    }\n  };\n\n  _proto.updateValueChange = function updateValueChange(prevState) {\n    var _this$props12 = this.props,\n        value = _this$props12.value,\n        valueKey = _this$props12.valueKey;\n\n    if (!shallowEqual(prevState.value, value)) {\n      var activeNode = null;\n\n      if (this.node === null) {\n        activeNode = this.getActiveNode(value);\n      }\n\n      if (value !== null && this.node !== null) {\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\n      }\n\n      var nextState = {\n        value: value,\n        activeNode: activeNode\n      };\n\n      if (value === null) {\n        nextState.activeNode = null;\n        this.node = null;\n      }\n\n      if (activeNode !== null) {\n        this.focusNode(activeNode);\n      }\n\n      this.setState(nextState);\n    }\n  };\n\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\n    var expandItemValues = this.props.expandItemValues;\n\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\n      this.unserializeLists('expand', expandItemValues);\n      this.setState({\n        expandItemValues: expandItemValues\n      });\n    }\n  };\n\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\n    var filterData = this.state.filterData;\n\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\n      this.setState({\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\n      });\n    }\n  };\n\n  _proto.getValue = function getValue(props) {\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props = props,\n        value = _props.value,\n        defaultValue = _props.defaultValue;\n    return !_isUndefined(value) ? value : defaultValue;\n  };\n\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\n    var _this4 = this;\n\n    if (valueKey === void 0) {\n      valueKey = this.props.valueKey;\n    }\n\n    var activeNode = null;\n\n    if (!_isUndefined(value)) {\n      Object.keys(this.nodes).forEach(function (refKey) {\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\n          activeNode = _this4.nodes[refKey];\n        }\n      });\n    }\n\n    return activeNode;\n  };\n\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\n    var childrenKey = this.props.childrenKey;\n\n    for (var i = 0; i < options.length; i += 1) {\n      var _options$i$childrenKe;\n\n      if (options[i].value === value) {\n        return options[i];\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\n\n        if (!_isEmpty(active)) {\n          return active;\n        }\n      }\n    }\n\n    return {};\n  };\n\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\n    var items = this.getFocusableMenuItems();\n    var activeIndex = -1;\n    items.forEach(function (item, index) {\n      if (document.activeElement !== null) {\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\n          activeIndex = index;\n        }\n      }\n    });\n    return {\n      items: items,\n      activeIndex: activeIndex\n    };\n  };\n\n  _proto.getActiveItem = function getActiveItem() {\n    var nodeData = {};\n    var activeItem = document.activeElement;\n\n    if (activeItem !== null) {\n      var _get2 = _get(activeItem, 'dataset'),\n          key = _get2.key,\n          layer = _get2.layer;\n\n      var activeNode = this.nodes[key];\n\n      if (activeNode) {\n        nodeData = activeNode;\n      }\n\n      return {\n        nodeData: nodeData,\n        layer: layer\n      };\n    }\n\n    return {};\n  };\n\n  _proto.getFilterData = function getFilterData(data, word, props) {\n    if (word === void 0) {\n      word = '';\n    }\n\n    var _ref2 = props || this.props,\n        labelKey = _ref2.labelKey,\n        childrenKey = _ref2.childrenKey,\n        searchBy = _ref2.searchBy;\n\n    var setVisible = function setVisible(nodes) {\n      if (nodes === void 0) {\n        nodes = [];\n      }\n\n      return nodes.forEach(function (item) {\n        item.visible = searchBy ? searchBy(word, item[labelKey], item) : shouldDisplay(item[labelKey], word);\n\n        if (_isArray(item[childrenKey])) {\n          setVisible(item[childrenKey]);\n          item[childrenKey].forEach(function (child) {\n            if (child.visible) {\n              item.visible = child.visible;\n            }\n          });\n        }\n      });\n    };\n\n    if (!_isUndefined(word)) {\n      setVisible(data);\n    }\n\n    return data;\n  };\n\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\n    var _this5 = this;\n\n    var expandItemValues = this.state.expandItemValues;\n    var _this$props13 = this.props,\n        childrenKey = _this$props13.childrenKey,\n        valueKey = _this$props13.valueKey;\n    return flattenTree(nodes, childrenKey, function (node) {\n      var formatted = {};\n      var curNode = _this5.nodes[node.refKey];\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\n\n      if (curNode) {\n        formatted = _extends({}, node, {\n          expand: curNode.expand,\n          layer: curNode.layer,\n          parentNode: curNode.parentNode,\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\n        });\n      }\n\n      return formatted;\n    });\n  };\n\n  _proto.getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\n    var _this$state5 = this.state,\n        dragOverNodeKey = _this$state5.dragOverNodeKey,\n        selectedValue = _this$state5.selectedValue,\n        dropNodePosition = _this$state5.dropNodePosition;\n    var dragNode = this.dragNode || {};\n    var _this$props14 = this.props,\n        locale = _this$props14.locale,\n        valueKey = _this$props14.valueKey,\n        labelKey = _this$props14.labelKey,\n        draggable = _this$props14.draggable,\n        childrenKey = _this$props14.childrenKey,\n        _this$props14$disable = _this$props14.disabledItemValues,\n        disabledItemValues = _this$props14$disable === void 0 ? [] : _this$props14$disable,\n        renderTreeNode = _this$props14.renderTreeNode,\n        renderTreeIcon = _this$props14.renderTreeIcon;\n    return {\n      rtl: locale.rtl,\n      value: node[valueKey],\n      label: node[labelKey],\n      index: index,\n      layer: layer,\n      expand: node.expand,\n      active: shallowEqual(node[valueKey], selectedValue),\n      visible: node.visible,\n      draggable: draggable,\n      dragging: shallowEqual(node[valueKey], dragNode[valueKey]),\n      children: node[childrenKey],\n      nodeData: node,\n      disabled: disabledItemValues.some(function (disabledItem) {\n        return shallowEqual(disabledItem, node[valueKey]);\n      }),\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\n      onSelect: this.handleSelect,\n      onDragStart: this.handleDragStart,\n      onDragEnter: this.handleDragEnter,\n      onDragOver: this.handleDragOver,\n      onDragLeave: this.handleDragLeave,\n      onDragEnd: this.handleDragEnd,\n      onDrop: this.handleDrop,\n      onTreeToggle: this.handleToggle,\n      onRenderTreeNode: renderTreeNode,\n      onRenderTreeIcon: renderTreeIcon\n    };\n  }\n  /**\r\n   * 获取 onDrop 的回调数据\r\n   */\n  ;\n\n  _proto.getDropData = function getDropData(nodeData) {\n    var dropNodePosition = this.state.dropNodePosition;\n    var _this$props15 = this.props,\n        valueKey = _this$props15.valueKey,\n        childrenKey = _this$props15.childrenKey;\n    var options = {\n      valueKey: valueKey,\n      childrenKey: childrenKey\n    };\n\n    var dragNode = _omit(this.dragNode, 'parentNode');\n\n    return {\n      /** 拖拽节点 */\n      dragNode: dragNode,\n\n      /** 释放所在节点的父节点 */\n      dropNode: nodeData,\n\n      /** 拖拽节点的类型 */\n      dropNodePosition: dropNodePosition,\n      createUpdateDataFunction: createUpdateTreeDataFunction({\n        /** 拖拽节点 */\n        dragNode: dragNode,\n\n        /** 释放所在节点的父节点 */\n        dropNode: nodeData,\n\n        /** 拖拽节点的类型 */\n        dropNodePosition: dropNodePosition\n      }, options)\n    };\n  };\n\n  _proto.focusNode = function focusNode(activeNode) {\n    var inline = this.props.inline;\n\n    if (activeNode && inline) {\n      var _node$focus4;\n\n      var node = this.getElementByDataKey(activeNode.refKey);\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\n    }\n  };\n\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\n    var _this6 = this;\n\n    if (ref === void 0) {\n      ref = '0';\n    }\n\n    if (layer === void 0) {\n      layer = 0;\n    }\n\n    var _ref3 = props || this.props,\n        labelKey = _ref3.labelKey,\n        valueKey = _ref3.valueKey,\n        childrenKey = _ref3.childrenKey;\n\n    if (!Array.isArray(nodes) || nodes.length === 0) {\n      return [];\n    }\n\n    nodes.map(function (node, index) {\n      var _extends2;\n\n      var refKey = ref + \"-\" + index;\n      node.refKey = refKey;\n      _this6.nodes[refKey] = _extends((_extends2 = {\n        layer: layer\n      }, _extends2[labelKey] = node[labelKey], _extends2[valueKey] = node[valueKey], _extends2.expand = getExpandState(node, props || _this6.props), _extends2.refKey = refKey, _extends2), node);\n\n      if (parentNode) {\n        _this6.nodes[refKey].parentNode = parentNode;\n      }\n\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\n    });\n  };\n\n  _proto.serializeList = function serializeList(key, nodes) {\n    if (nodes === void 0) {\n      nodes = this.nodes;\n    }\n\n    var valueKey = this.props.valueKey;\n    var list = [];\n    Object.keys(nodes).forEach(function (refKey) {\n      if (nodes[refKey][key]) {\n        list.push(nodes[refKey][valueKey]);\n      }\n    });\n    return list;\n  };\n\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\n    var _this7 = this;\n\n    if (value === void 0) {\n      value = [];\n    }\n\n    if (props === void 0) {\n      props = this.props;\n    }\n\n    var _props2 = props,\n        valueKey = _props2.valueKey;\n    var expandAll = getExpandAll(props);\n    Object.keys(this.nodes).forEach(function (refKey) {\n      _this7.nodes[refKey][key] = false;\n\n      if (value.length) {\n        value.forEach(function (value) {\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\n            _this7.nodes[refKey][key] = true;\n          }\n        });\n      } else {\n        _this7.nodes[refKey][key] = expandAll;\n      }\n    });\n  };\n\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\n    var valueKey = this.props.valueKey;\n    var expandItemValues = new Set(this.serializeList('expand'));\n\n    if (isExpand) {\n      expandItemValues.add(node[valueKey]);\n    } else {\n      expandItemValues.delete(node[valueKey]);\n    }\n\n    return Array.from(expandItemValues);\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _this$props16 = this.props,\n        _this$props16$height = _this$props16.height,\n        height = _this$props16$height === void 0 ? defaultHeight : _this$props16$height,\n        searchable = _this$props16.searchable,\n        searchKeyword = _this$props16.searchKeyword,\n        renderExtraFooter = _this$props16.renderExtraFooter,\n        locale = _this$props16.locale,\n        renderMenu = _this$props16.renderMenu,\n        menuStyle = _this$props16.menuStyle,\n        virtualized = _this$props16.virtualized,\n        menuClassName = _this$props16.menuClassName,\n        menuAutoWidth = _this$props16.menuAutoWidth;\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\n    var styles = virtualized ? _extends({\n      height: height\n    }, menuStyle) : menuStyle;\n    return React.createElement(MenuWrapper, {\n      autoWidth: menuAutoWidth,\n      className: classes,\n      style: styles,\n      ref: this.menuRef,\n      getToggleInstance: this.getToggleInstance,\n      getPositionInstance: this.getPositionInstance\n    }, searchable ? React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      key: \"searchBar\",\n      onChange: this.handleSearch,\n      value: keyword\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.renderNode = function renderNode(node, index, layer) {\n    var _this8 = this;\n\n    var searchKeyword = this.state.searchKeyword;\n    var _this$props17 = this.props,\n        valueKey = _this$props17.valueKey,\n        childrenKey = _this$props17.childrenKey;\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var refKey = node.refKey;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\n\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\n\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer, index), {\n      hasChildren: visibleChildren\n    });\n\n    if (nodeProps.hasChildren) {\n      var _classNames;\n\n      layer += 1; // 是否展开树节点且子节点不为空\n\n      var openClass = this.addTreePrefix('open');\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expand && visibleChildren, _classNames));\n      var nodes = children || [];\n      return React.createElement(\"div\", {\n        className: childrenClass,\n        key: key\n      }, React.createElement(TreeNode, _extends({}, nodeProps, {\n        innerRef: this.bindNodeRefs.bind(this, refKey)\n      })), React.createElement(\"div\", {\n        className: this.addTreePrefix('children')\n      }, nodes.map(function (child, i) {\n        return _this8.renderNode(child, i, layer);\n      })));\n    }\n\n    return React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\n    var searchKeyword = this.state.searchKeyword;\n    var childrenKey = this.props.childrenKey;\n    var key = options.key,\n        style = options.style;\n    var layer = node.layer,\n        refKey = node.refKey,\n        showNode = node.showNode;\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\n\n    if (!node.visible) {\n      return null;\n    }\n\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\n      expand: expand\n    }), layer), {\n      style: style,\n      hasChildren: !!node[childrenKey]\n    });\n\n    return showNode && React.createElement(TreeNode, _extends({\n      key: key,\n      innerRef: this.bindNodeRefs.bind(this, refKey)\n    }, nodeProps));\n  };\n\n  _proto.renderTree = function renderTree() {\n    var _classNames2,\n        _this9 = this;\n\n    var filterData = this.state.filterData;\n    var _this$props18 = this.props,\n        height = _this$props18.height,\n        className = _this$props18.className,\n        inline = _this$props18.inline,\n        style = _this$props18.style,\n        locale = _this$props18.locale,\n        virtualized = _this$props18.virtualized,\n        searchable = _this$props18.searchable;\n    var layer = 0;\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\n    var nodes = [];\n\n    if (!virtualized) {\n      nodes = filterData.map(function (dataItem, index) {\n        return _this9.renderNode(dataItem, index, layer);\n      });\n\n      if (!nodes.some(function (v) {\n        return v !== null;\n      })) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } else {\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\n        return n.showNode && n.visible;\n      });\n\n      if (!nodes.length) {\n        return React.createElement(\"div\", {\n          className: this.addPrefix('none')\n        }, locale.noResultsText);\n      }\n    } // 当未定义 height 且 设置了 virtualized 为 true，treeHeight 设置默认高度\n\n\n    var treeHeight = _isUndefined(height) && virtualized ? defaultHeight : height;\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\n    var styles = inline ? _extends({\n      height: treeHeight\n    }, style) : {};\n    var listHeight = getVirtualLisHeight(inline, searchable, treeHeight);\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      ref: this.treeViewRef,\n      className: classes,\n      style: styles,\n      onKeyDown: this.handleKeyDown\n    }, React.createElement(\"div\", {\n      className: this.addTreePrefix('nodes')\n    }, virtualized ? React.createElement(AutoSizer, {\n      defaultHeight: listHeight,\n      defaultWidth: treeWidth\n    }, function (_ref4) {\n      var height = _ref4.height,\n          width = _ref4.width;\n      return React.createElement(List, {\n        ref: _this9.listRef,\n        width: width || treeWidth,\n        height: height || listHeight,\n        rowHeight: 38,\n        rowCount: nodes.length,\n        rowRenderer: _this9.measureRowRenderer(nodes)\n      });\n    }) : nodes)), this.renderDragNode());\n  };\n\n  _proto.renderDragNode = function renderDragNode() {\n    var _this$props19 = this.props,\n        labelKey = _this$props19.labelKey,\n        draggable = _this$props19.draggable,\n        renderDragNode = _this$props19.renderDragNode;\n    var dragNode = this.dragNode || {};\n\n    if (draggable) {\n      var dragNodeContent = dragNode[labelKey];\n\n      if (_isFunction(renderDragNode)) {\n        dragNodeContent = renderDragNode(dragNode);\n      }\n\n      return React.createElement(\"span\", {\n        id: \"drag-node\",\n        className: this.addTreePrefix('drag-node-mover')\n      }, dragNodeContent);\n    }\n\n    return null;\n  };\n\n  _proto.render = function render() {\n    var _this$props20 = this.props,\n        inline = _this$props20.inline,\n        locale = _this$props20.locale,\n        disabled = _this$props20.disabled,\n        toggleComponentClass = _this$props20.toggleComponentClass,\n        placeholder = _this$props20.placeholder,\n        cleanable = _this$props20.cleanable,\n        renderValue = _this$props20.renderValue,\n        labelKey = _this$props20.labelKey,\n        onEntered = _this$props20.onEntered,\n        onExited = _this$props20.onExited,\n        onClean = _this$props20.onClean,\n        style = _this$props20.style,\n        positionRef = _this$props20.positionRef,\n        rest = _objectWithoutPropertiesLoose(_this$props20, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\", \"positionRef\"]);\n\n    var _this$state6 = this.state,\n        selectedValue = _this$state6.selectedValue,\n        activeNode = _this$state6.activeNode;\n\n    var hasValidValue = !_isNil(activeNode) || !_isNil(selectedValue) && _isFunction(renderValue);\n\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, hasValidValue);\n    var selectedElement = placeholder;\n    var hasValue = !!activeNode;\n    /**\r\n     * if value is invalid and renderValue is undefined, then using placeholder.\r\n     * if value is valid and renderValue is't undefined, then using renderValue()\r\n     */\n\n    if (!_isNil(selectedValue)) {\n      if (hasValue) {\n        selectedElement = activeNode[labelKey];\n      }\n\n      if (_isFunction(renderValue)) {\n        var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\n        selectedElement = renderValue(selectedValue, node, selectedElement);\n      }\n    }\n\n    var unhandled = getUnhandledProps(TreePicker, rest);\n\n    if (inline) {\n      return this.renderTree();\n    }\n\n    return React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: mergeRefs(this.positionRef, positionRef),\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\n      onExited: createChainedFunction(this.handleOnClose, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      ref: this.toggleRef,\n      onKeyDown: this.handleToggleKeyDown,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      componentClass: toggleComponentClass,\n      hasValue: hasValidValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return TreePicker;\n}(React.Component);\n\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\n  height: PropTypes.number,\n  inline: PropTypes.bool,\n  draggable: PropTypes.bool,\n  expandAll: PropTypes.bool,\n  virtualized: PropTypes.bool,\n  searchable: PropTypes.bool,\n  menuAutoWidth: PropTypes.bool,\n  searchKeyword: PropTypes.string,\n  defaultExpandAll: PropTypes.bool,\n  expandItemValues: PropTypes.array,\n  defaultExpandItemValues: PropTypes.array,\n  onSearch: PropTypes.func,\n  onExpand: PropTypes.func,\n  onSelect: PropTypes.func,\n  renderMenu: PropTypes.func,\n  renderTreeNode: PropTypes.func,\n  renderTreeIcon: PropTypes.func,\n  renderExtraFooter: PropTypes.func,\n  renderDragNode: PropTypes.func,\n  searchBy: PropTypes.func\n});\nTreePicker.defaultProps = _extends({}, listPickerDefaultProps, {\n  searchable: true,\n  menuAutoWidth: true,\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  }\n});\npolyfill(TreePicker);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(TreePicker);","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_isNil","_isFunction","_isNumber","_isString","_omit","_get","_isEmpty","_isUndefined","_isArray","React","PropTypes","classNames","List","AutoSizer","CellMeasurerCache","CellMeasurer","polyfill","shallowEqual","TreeNode","defaultProps","prefix","defaultClassPrefix","getUnhandledProps","createChainedFunction","mergeRefs","flattenTree","getExpandWhenSearching","getNodeParents","shouldShowNodeByExpanded","getVirtualLisHeight","treeDeprecatedWarning","hasVisibleChildren","compareArray","getExpandAll","getExpandItemValues","getExpandState","getDragNodeKeys","calDropNodePosition","createUpdateTreeDataFunction","PickerToggle","getToggleWrapperClassName","onMenuKeyDown","MenuWrapper","SearchBar","PickerToggleTrigger","createConcatChildrenFunction","shouldDisplay","TREE_NODE_DROP_POSITION","listPickerPropTypes","listPickerDefaultProps","defaultHeight","defaultWidth","TreePicker","_React$Component","props","_this","call","menuRef","treeViewRef","positionRef","listRef","triggerRef","toggleRef","getFocusableMenuItems","filterData","state","_this$props","childrenKey","_this$props$disabledI","disabledItemValues","valueKey","items","loop","nodes","forEach","node","nodeData","refKey","disabled","some","disabledItem","push","getElementByDataKey","dataKey","ele","nodeRefs","Element","querySelector","addTreePrefix","cache","fixedWidth","minHeight","dragNode","bindNodeRefs","ref","getPositionInstance","current","getToggleInstance","addPrefix","name","classPrefix","selectActiveItem","event","_this$getActiveItem","getActiveItem","handleSelect","focusNextItem","_node$focus","_this$getItemsAndActi","getItemsAndActiveIndex","activeIndex","length","nextIndex","focus","focusPreviousItem","_node$focus2","_this$getItemsAndActi2","prevIndex","handleCloseDropdown","_this$triggerRef$curr","_this$triggerRef$curr2","hide","handleOpenDropdown","_this$triggerRef$curr3","_this$triggerRef$curr4","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleToggleDropdown","active","handleToggle","_this$props2","onExpand","expandItemValues","nextExpandItemValues","toggleExpand","expand","unserializeLists","setState","_this$toggleRef$curre","_this$props3","onChange","onSelect","value","activeNode","selectedValue","onFocus","handleKeyDown","down","up","enter","del","handleClean","handleToggleKeyDown","_this$state","keyCode","target","HTMLElement","className","includes","handleSearch","_this$props4","onSearch","searchKeyword","getFilterData","_this$props$onChange","_this$props5","handleOnOpen","_this$props$onOpen","_this$props6","_node$focus3","onOpen","handleOnClose","_this$props7","onClose","handleDragStart","_this$props8","onDragStart","draggable","dragging","dragNodeKeys","handleDragEnter","_this$state2","_this$props9","onDragEnter","d","dropNodePosition","dragOverNodeKey","handleDragOver","_this$state3","_this$props10","onDragOver","lastDropNodePosition","handleDragLeave","onDragLeave","handleDragEnd","onDragEnd","handleDrop","_this$props11","onDrop","console","error","dropData","getDropData","measureRowRenderer","_ref","key","index","style","parent","createElement","columnIndex","rowIndex","renderVirtualNode","_value","data","_valueKey","_props$searchKeyword","_searchKeyword","nextData","concat","_nextExpandItemValues","flattenNodes","getValue","expandAll","getActiveNode","serializeList","createRef","_proto","prototype","componentDidMount","focusNode","getDerivedStateFromProps","nextProps","prevState","nextState","Object","keys","componentDidUpdate","_prevProps","updateDataChange","updateValueChange","updateExpandItemValuesChange","updateSearchKeywordChange","forceUpdateGrid","_this$state4","newState","_this$props12","_props","defaultValue","_this4","getActiveElementOption","options","i","_options$i$childrenKe","item","document","activeElement","getAttribute","activeItem","_get2","layer","word","_ref2","labelKey","searchBy","setVisible","visible","child","getFlattenTreeData","_this5","_this$props13","formatted","curNode","parentKeys","parentNode","showNode","getTreeNodeProps","_this$state5","_this$props14","locale","_this$props14$disable","renderTreeNode","renderTreeIcon","rtl","label","children","dragOver","DRAG_OVER","dragOverTop","DRAG_OVER_TOP","dragOverBottom","DRAG_OVER_BOTTOM","onTreeToggle","onRenderTreeNode","onRenderTreeIcon","_this$props15","dropNode","createUpdateDataFunction","inline","_node$focus4","_this6","_ref3","Array","isArray","map","_extends2","list","_this7","_props2","isExpand","Set","add","delete","from","renderDropdownMenu","_this$props16","_this$props16$height","height","searchable","renderExtraFooter","renderMenu","menuStyle","virtualized","menuClassName","menuAutoWidth","keyword","classes","styles","autoWidth","placeholder","searchPlaceholder","renderTree","renderNode","_this8","_this$props17","visibleChildren","nodeProps","hasChildren","_classNames","openClass","childrenClass","innerRef","bind","_classNames2","_this9","_this$props18","dataItem","v","noResultsText","filter","n","treeHeight","treeWidth","width","listHeight","Fragment","onKeyDown","_ref4","rowHeight","rowCount","rowRenderer","renderDragNode","_this$props19","dragNodeContent","id","render","_this$props20","toggleComponentClass","cleanable","renderValue","onEntered","onExited","onClean","rest","_this$state6","hasValidValue","selectedElement","hasValue","unhandled","pickerProps","speaker","componentClass","Component","propTypes","number","bool","string","defaultExpandAll","array","defaultExpandItemValues","func"],"sources":["G:/gitlab/TFG/Aplicacion/node_modules/rsuite/es/TreePicker/TreePicker.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\r\nimport _isNil from \"lodash/isNil\";\r\nimport _isFunction from \"lodash/isFunction\";\r\nimport _isNumber from \"lodash/isNumber\";\r\nimport _isString from \"lodash/isString\";\r\nimport _omit from \"lodash/omit\";\r\nimport _get from \"lodash/get\";\r\nimport _isEmpty from \"lodash/isEmpty\";\r\nimport _isUndefined from \"lodash/isUndefined\";\r\nimport _isArray from \"lodash/isArray\";\r\nimport * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport List from 'react-virtualized/dist/commonjs/List';\r\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\r\nimport { CellMeasurerCache, CellMeasurer } from 'react-virtualized/dist/commonjs/CellMeasurer';\r\nimport { polyfill } from 'react-lifecycles-compat';\r\nimport shallowEqual from '../utils/shallowEqual';\r\nimport TreeNode from './TreeNode';\r\nimport { defaultProps, prefix, defaultClassPrefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\r\nimport { flattenTree, getExpandWhenSearching, getNodeParents, shouldShowNodeByExpanded, getVirtualLisHeight, treeDeprecatedWarning, hasVisibleChildren, compareArray, getExpandAll, getExpandItemValues, getExpandState, getDragNodeKeys, calDropNodePosition, createUpdateTreeDataFunction } from '../utils/treeUtils';\r\nimport { PickerToggle, getToggleWrapperClassName, onMenuKeyDown, MenuWrapper, SearchBar, PickerToggleTrigger, createConcatChildrenFunction, shouldDisplay } from '../Picker';\r\nimport { TREE_NODE_DROP_POSITION } from '../constants';\r\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes'; // default value for virtualized\r\n\r\nvar defaultHeight = 360;\r\nvar defaultWidth = 200;\r\n\r\nvar TreePicker =\r\n/*#__PURE__*/\r\nfunction (_React$Component) {\r\n  _inheritsLoose(TreePicker, _React$Component);\r\n\r\n  function TreePicker(props) {\r\n    var _this;\r\n\r\n    _this = _React$Component.call(this, props) || this;\r\n    _this.menuRef = void 0;\r\n    _this.treeViewRef = void 0;\r\n    _this.positionRef = void 0;\r\n    _this.listRef = void 0;\r\n    _this.triggerRef = void 0;\r\n    _this.toggleRef = void 0;\r\n\r\n    _this.getFocusableMenuItems = function () {\r\n      var filterData = _this.state.filterData;\r\n      var _this$props = _this.props,\r\n          childrenKey = _this$props.childrenKey,\r\n          _this$props$disabledI = _this$props.disabledItemValues,\r\n          disabledItemValues = _this$props$disabledI === void 0 ? [] : _this$props$disabledI,\r\n          valueKey = _this$props.valueKey;\r\n      var items = [];\r\n\r\n      var loop = function loop(nodes) {\r\n        nodes.forEach(function (node) {\r\n          var nodeData = _extends({}, node, {}, _this.nodes[node.refKey]);\r\n\r\n          var disabled = disabledItemValues.some(function (disabledItem) {\r\n            return shallowEqual(disabledItem, node[valueKey]);\r\n          });\r\n\r\n          if (!disabled) {\r\n            items.push(node);\r\n          }\r\n\r\n          if (node[childrenKey] && getExpandState(nodeData, _this.props)) {\r\n            loop(node[childrenKey]);\r\n          }\r\n        });\r\n      };\r\n\r\n      loop(filterData);\r\n      return items;\r\n    };\r\n\r\n    _this.getElementByDataKey = function (dataKey) {\r\n      var ele = _this.nodeRefs[dataKey];\r\n\r\n      if (ele instanceof Element) {\r\n        return ele.querySelector(\".\" + _this.addTreePrefix('node-label'));\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n    _this.nodes = {};\r\n    _this.node = null;\r\n    _this.cache = new CellMeasurerCache({\r\n      fixedWidth: true,\r\n      minHeight: 20\r\n    });\r\n    _this.nodeRefs = {};\r\n    _this.dragNode = null;\r\n\r\n    _this.bindNodeRefs = function (refKey, ref) {\r\n      _this.nodeRefs[refKey] = ref;\r\n    };\r\n\r\n    _this.getPositionInstance = function () {\r\n      return _this.positionRef.current;\r\n    };\r\n\r\n    _this.getToggleInstance = function () {\r\n      return _this.toggleRef.current;\r\n    };\r\n\r\n    _this.addPrefix = function (name) {\r\n      return prefix(_this.props.classPrefix)(name);\r\n    };\r\n\r\n    _this.addTreePrefix = function (name) {\r\n      return prefix(defaultClassPrefix('tree'))(name);\r\n    };\r\n\r\n    _this.selectActiveItem = function (event) {\r\n      var _this$getActiveItem = _this.getActiveItem(),\r\n          nodeData = _this$getActiveItem.nodeData;\r\n\r\n      _this.handleSelect(nodeData, event);\r\n    };\r\n\r\n    _this.focusNextItem = function () {\r\n      var _node$focus;\r\n\r\n      var _this$getItemsAndActi = _this.getItemsAndActiveIndex(),\r\n          items = _this$getItemsAndActi.items,\r\n          activeIndex = _this$getItemsAndActi.activeIndex;\r\n\r\n      if (items.length === 0) {\r\n        return;\r\n      }\r\n\r\n      var nextIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;\r\n\r\n      var node = _this.getElementByDataKey(items[nextIndex].refKey);\r\n\r\n      node === null || node === void 0 ? void 0 : (_node$focus = node.focus) === null || _node$focus === void 0 ? void 0 : _node$focus.call(node);\r\n    };\r\n\r\n    _this.focusPreviousItem = function () {\r\n      var _node$focus2;\r\n\r\n      var _this$getItemsAndActi2 = _this.getItemsAndActiveIndex(),\r\n          items = _this$getItemsAndActi2.items,\r\n          activeIndex = _this$getItemsAndActi2.activeIndex;\r\n\r\n      if (items.length === 0) {\r\n        return;\r\n      }\r\n\r\n      var prevIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;\r\n      prevIndex = prevIndex >= 0 ? prevIndex : 0;\r\n\r\n      var node = _this.getElementByDataKey(items[prevIndex].refKey);\r\n\r\n      node === null || node === void 0 ? void 0 : (_node$focus2 = node.focus) === null || _node$focus2 === void 0 ? void 0 : _node$focus2.call(node);\r\n    };\r\n\r\n    _this.handleCloseDropdown = function () {\r\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\r\n\r\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\r\n    };\r\n\r\n    _this.handleOpenDropdown = function () {\r\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\r\n\r\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\r\n    };\r\n\r\n    _this.open = function () {\r\n      var _this$handleOpenDropd, _this2;\r\n\r\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\r\n    };\r\n\r\n    _this.close = function () {\r\n      var _this$handleCloseDrop, _this3;\r\n\r\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\r\n    };\r\n\r\n    _this.handleToggleDropdown = function () {\r\n      var active = _this.state.active;\r\n\r\n      if (active) {\r\n        _this.handleCloseDropdown();\r\n\r\n        return;\r\n      }\r\n\r\n      _this.handleOpenDropdown();\r\n    };\r\n\r\n    _this.handleToggle = function (nodeData) {\r\n      var _this$props2 = _this.props,\r\n          valueKey = _this$props2.valueKey,\r\n          childrenKey = _this$props2.childrenKey,\r\n          onExpand = _this$props2.onExpand,\r\n          expandItemValues = _this$props2.expandItemValues;\r\n\r\n      var nextExpandItemValues = _this.toggleExpand(nodeData, !nodeData.expand);\r\n\r\n      if (_isUndefined(expandItemValues)) {\r\n        _this.unserializeLists('expand', nextExpandItemValues);\r\n\r\n        _this.setState({\r\n          expandItemValues: nextExpandItemValues\r\n        });\r\n      }\r\n\r\n      onExpand === null || onExpand === void 0 ? void 0 : onExpand(nextExpandItemValues, nodeData, createConcatChildrenFunction(nodeData, nodeData[valueKey], {\r\n        valueKey: valueKey,\r\n        childrenKey: childrenKey\r\n      }));\r\n    };\r\n\r\n    _this.handleSelect = function (nodeData, event) {\r\n      var _this$toggleRef$curre;\r\n\r\n      var _this$props3 = _this.props,\r\n          valueKey = _this$props3.valueKey,\r\n          onChange = _this$props3.onChange,\r\n          onSelect = _this$props3.onSelect,\r\n          value = _this$props3.value;\r\n      _this.node = nodeData;\r\n\r\n      if (_isUndefined(value)) {\r\n        _this.setState({\r\n          activeNode: nodeData,\r\n          selectedValue: nodeData[valueKey]\r\n        });\r\n      }\r\n\r\n      onChange === null || onChange === void 0 ? void 0 : onChange(nodeData[valueKey], event);\r\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(nodeData, nodeData[valueKey], event);\r\n\r\n      _this.handleCloseDropdown();\r\n\r\n      (_this$toggleRef$curre = _this.toggleRef.current) === null || _this$toggleRef$curre === void 0 ? void 0 : _this$toggleRef$curre.onFocus();\r\n    };\r\n\r\n    _this.handleKeyDown = function (event) {\r\n      onMenuKeyDown(event, {\r\n        down: _this.focusNextItem,\r\n        up: _this.focusPreviousItem,\r\n        enter: _this.selectActiveItem,\r\n        del: _this.handleClean\r\n      });\r\n    };\r\n\r\n    _this.handleToggleKeyDown = function (event) {\r\n      var _this$state = _this.state,\r\n          activeNode = _this$state.activeNode,\r\n          active = _this$state.active; // enter\r\n\r\n      if ((!activeNode || !active) && event.keyCode === 13) {\r\n        _this.handleToggleDropdown();\r\n      } // delete\r\n\r\n\r\n      if (event.keyCode === 8) {\r\n        _this.handleClean(event);\r\n      }\r\n\r\n      if (!_this.treeViewRef.current) {\r\n        return;\r\n      }\r\n\r\n      if (event.target instanceof HTMLElement) {\r\n        var className = event.target.className;\r\n\r\n        if (className.includes(_this.addPrefix('toggle')) || className.includes(_this.addPrefix('toggle-custom')) || className.includes(_this.addPrefix('search-bar-input'))) {\r\n          onMenuKeyDown(event, {\r\n            down: _this.focusNextItem\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    _this.handleSearch = function (value, event) {\r\n      var filterData = _this.state.filterData;\r\n      var _this$props4 = _this.props,\r\n          onSearch = _this$props4.onSearch,\r\n          searchKeyword = _this$props4.searchKeyword;\r\n\r\n      if (_isUndefined(searchKeyword)) {\r\n        _this.setState({\r\n          searchKeyword: value,\r\n          filterData: _this.getFilterData(filterData, value)\r\n        });\r\n      }\r\n\r\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value, event);\r\n    };\r\n\r\n    _this.handleClean = function (event) {\r\n      var _this$props$onChange, _this$props5;\r\n\r\n      _this.setState({\r\n        activeNode: null,\r\n        selectedValue: null\r\n      });\r\n\r\n      _this.node = null;\r\n      (_this$props$onChange = (_this$props5 = _this.props).onChange) === null || _this$props$onChange === void 0 ? void 0 : _this$props$onChange.call(_this$props5, null, event);\r\n    };\r\n\r\n    _this.handleOnOpen = function () {\r\n      var _this$props$onOpen, _this$props6;\r\n\r\n      var activeNode = _this.state.activeNode;\r\n\r\n      if (activeNode) {\r\n        var _node$focus3;\r\n\r\n        var node = _this.getElementByDataKey(activeNode.refKey);\r\n\r\n        node === null || node === void 0 ? void 0 : (_node$focus3 = node.focus) === null || _node$focus3 === void 0 ? void 0 : _node$focus3.call(node);\r\n      }\r\n\r\n      (_this$props$onOpen = (_this$props6 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props6);\r\n\r\n      _this.setState({\r\n        active: true\r\n      });\r\n    };\r\n\r\n    _this.handleOnClose = function () {\r\n      var filterData = _this.state.filterData;\r\n      var _this$props7 = _this.props,\r\n          searchKeyword = _this$props7.searchKeyword,\r\n          onClose = _this$props7.onClose;\r\n\r\n      if (_isUndefined(searchKeyword)) {\r\n        _this.setState({\r\n          searchKeyword: '',\r\n          filterData: _this.getFilterData(filterData, '')\r\n        });\r\n      }\r\n\r\n      onClose === null || onClose === void 0 ? void 0 : onClose();\r\n\r\n      _this.setState({\r\n        active: false\r\n      });\r\n    };\r\n\r\n    _this.handleDragStart = function (nodeData, event) {\r\n      var _this$props8 = _this.props,\r\n          valueKey = _this$props8.valueKey,\r\n          childrenKey = _this$props8.childrenKey,\r\n          onDragStart = _this$props8.onDragStart,\r\n          draggable = _this$props8.draggable;\r\n\r\n      if (draggable) {\r\n        _this.setState({\r\n          dragging: true,\r\n          dragNodeKeys: getDragNodeKeys(nodeData, childrenKey, valueKey)\r\n        });\r\n\r\n        _this.dragNode = _this.nodes[nodeData.refKey];\r\n        onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(nodeData, event);\r\n      }\r\n    };\r\n\r\n    _this.handleDragEnter = function (nodeData, event) {\r\n      var _this$state2 = _this.state,\r\n          dragging = _this$state2.dragging,\r\n          dragNodeKeys = _this$state2.dragNodeKeys;\r\n      var _this$props9 = _this.props,\r\n          valueKey = _this$props9.valueKey,\r\n          onDragEnter = _this$props9.onDragEnter;\r\n\r\n      if (dragNodeKeys.some(function (d) {\r\n        return shallowEqual(d, nodeData[valueKey]);\r\n      })) {\r\n        return;\r\n      }\r\n\r\n      if (dragging && _this.dragNode) {\r\n        var dropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\r\n\r\n        _this.setState({\r\n          dragOverNodeKey: nodeData[valueKey],\r\n          dropNodePosition: dropNodePosition\r\n        });\r\n      }\r\n\r\n      onDragEnter === null || onDragEnter === void 0 ? void 0 : onDragEnter(nodeData, event);\r\n    };\r\n\r\n    _this.handleDragOver = function (nodeData, event) {\r\n      var _this$state3 = _this.state,\r\n          dragNodeKeys = _this$state3.dragNodeKeys,\r\n          dragOverNodeKey = _this$state3.dragOverNodeKey,\r\n          dropNodePosition = _this$state3.dropNodePosition;\r\n      var _this$props10 = _this.props,\r\n          valueKey = _this$props10.valueKey,\r\n          onDragOver = _this$props10.onDragOver;\r\n\r\n      if (dragNodeKeys.some(function (d) {\r\n        return shallowEqual(d, nodeData[valueKey]);\r\n      })) {\r\n        return;\r\n      }\r\n\r\n      if (_this.dragNode && shallowEqual(nodeData[valueKey], dragOverNodeKey)) {\r\n        var lastDropNodePosition = calDropNodePosition(event, _this.nodeRefs[nodeData.refKey]);\r\n        if (lastDropNodePosition === dropNodePosition) return;\r\n\r\n        _this.setState({\r\n          dropNodePosition: lastDropNodePosition\r\n        });\r\n      }\r\n\r\n      onDragOver === null || onDragOver === void 0 ? void 0 : onDragOver(nodeData, event);\r\n    };\r\n\r\n    _this.handleDragLeave = function (nodeData, event) {\r\n      var onDragLeave = _this.props.onDragLeave;\r\n      onDragLeave === null || onDragLeave === void 0 ? void 0 : onDragLeave(nodeData, event);\r\n    };\r\n\r\n    _this.handleDragEnd = function (nodeData, event) {\r\n      var onDragEnd = _this.props.onDragEnd;\r\n\r\n      _this.setState({\r\n        dragging: false,\r\n        dragNodeKeys: [],\r\n        dragOverNodeKey: null\r\n      });\r\n\r\n      onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(nodeData, event);\r\n    };\r\n\r\n    _this.handleDrop = function (nodeData, event) {\r\n      var dragNodeKeys = _this.state.dragNodeKeys;\r\n      var _this$props11 = _this.props,\r\n          valueKey = _this$props11.valueKey,\r\n          onDrop = _this$props11.onDrop;\r\n\r\n      if (dragNodeKeys.some(function (d) {\r\n        return shallowEqual(d, nodeData[valueKey]);\r\n      })) {\r\n        console.error('Cannot drag a node to itself and its children');\r\n      } else {\r\n        var dropData = _this.getDropData(nodeData);\r\n\r\n        onDrop === null || onDrop === void 0 ? void 0 : onDrop(dropData, event);\r\n      }\r\n\r\n      _this.setState({\r\n        dragging: false,\r\n        dragNodeKeys: [],\r\n        dragOverNodeKey: null,\r\n        dropNodePosition: null\r\n      });\r\n\r\n      _this.dragNode = null;\r\n    };\r\n\r\n    _this.measureRowRenderer = function (nodes) {\r\n      return function (_ref) {\r\n        var key = _ref.key,\r\n            index = _ref.index,\r\n            style = _ref.style,\r\n            parent = _ref.parent;\r\n        var node = nodes[index];\r\n        return React.createElement(CellMeasurer, {\r\n          cache: _this.cache,\r\n          columnIndex: 0,\r\n          key: key,\r\n          rowIndex: index,\r\n          parent: parent\r\n        }, function () {\r\n          return _this.renderVirtualNode(node, {\r\n            key: key,\r\n            style: style\r\n          });\r\n        });\r\n      };\r\n    };\r\n\r\n    var _value = props.value,\r\n        data = props.data,\r\n        _valueKey = props.valueKey,\r\n        _props$searchKeyword = props.searchKeyword,\r\n        _searchKeyword = _props$searchKeyword === void 0 ? '' : _props$searchKeyword;\r\n\r\n    var nextData = [].concat(data);\r\n\r\n    var _nextExpandItemValues = getExpandItemValues(props);\r\n\r\n    _this.flattenNodes(nextData);\r\n\r\n    _this.unserializeLists('expand', _nextExpandItemValues, props);\r\n\r\n    _this.state = {\r\n      data: data,\r\n      value: _value,\r\n      dragging: false,\r\n      selectedValue: _this.getValue(props),\r\n      expandAll: getExpandAll(props),\r\n      filterData: _this.getFilterData(nextData, _searchKeyword, props),\r\n      activeNode: _this.getActiveNode(_this.getValue(props), _valueKey),\r\n      searchKeyword: _searchKeyword,\r\n      expandItemValues: _this.serializeList('expand'),\r\n      dragNodeKeys: [],\r\n      dragOverNodeKey: null,\r\n      dropNodePosition: null\r\n    };\r\n    _this.treeViewRef = React.createRef();\r\n    _this.positionRef = React.createRef();\r\n    _this.listRef = React.createRef();\r\n    _this.triggerRef = React.createRef();\r\n    _this.toggleRef = React.createRef(); // for test\r\n\r\n    _this.menuRef = React.createRef();\r\n    treeDeprecatedWarning(props, ['expandAll']);\r\n    return _this;\r\n  }\r\n\r\n  var _proto = TreePicker.prototype;\r\n\r\n  _proto.componentDidMount = function componentDidMount() {\r\n    var activeNode = this.state.activeNode;\r\n    this.focusNode(activeNode);\r\n  };\r\n\r\n  TreePicker.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\r\n    var value = nextProps.value,\r\n        data = nextProps.data,\r\n        expandAll = nextProps.expandAll,\r\n        searchKeyword = nextProps.searchKeyword,\r\n        expandItemValues = nextProps.expandItemValues;\r\n    var nextState = {};\r\n\r\n    if (_isArray(data) && _isArray(prevState.data) && prevState.data !== data) {\r\n      nextState.data = data;\r\n    }\r\n\r\n    if (!shallowEqual(value, prevState.value)) {\r\n      nextState.value = value;\r\n      nextState.selectedValue = value;\r\n    }\r\n\r\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\r\n      nextState.expandItemValues = expandItemValues;\r\n    }\r\n\r\n    if (!_isUndefined(searchKeyword) && searchKeyword !== prevState.searchKeyword) {\r\n      nextState.searchKeyword = searchKeyword;\r\n    }\r\n\r\n    if (expandAll !== prevState.expandAll) {\r\n      nextState.expandAll = expandAll;\r\n    }\r\n\r\n    return Object.keys(nextState).length ? nextState : null;\r\n  };\r\n\r\n  _proto.componentDidUpdate = function componentDidUpdate(_prevProps, prevState) {\r\n    this.updateDataChange(prevState);\r\n    this.updateValueChange(prevState);\r\n    this.updateExpandItemValuesChange(prevState);\r\n    this.updateSearchKeywordChange(prevState);\r\n\r\n    if (this.listRef.current) {\r\n      this.listRef.current.forceUpdateGrid();\r\n    }\r\n  };\r\n\r\n  _proto.updateDataChange = function updateDataChange(prevState) {\r\n    var _this$state4 = this.state,\r\n        searchKeyword = _this$state4.searchKeyword,\r\n        expandItemValues = _this$state4.expandItemValues;\r\n    var data = this.props.data;\r\n\r\n    if (prevState.data !== data) {\r\n      var nextData = [].concat(data);\r\n      this.flattenNodes(nextData);\r\n      var filterData = this.getFilterData(nextData, searchKeyword);\r\n      var activeNode = this.getActiveNode(this.getValue());\r\n      this.focusNode(activeNode);\r\n      this.unserializeLists('expand', expandItemValues);\r\n      var newState = {};\r\n\r\n      if (activeNode) {\r\n        newState = {\r\n          activeNode: activeNode\r\n        };\r\n      }\r\n\r\n      this.setState(_extends({}, {\r\n        data: nextData,\r\n        filterData: filterData,\r\n        expandItemValues: this.serializeList('expand')\r\n      }, {}, newState));\r\n    }\r\n  };\r\n\r\n  _proto.updateValueChange = function updateValueChange(prevState) {\r\n    var _this$props12 = this.props,\r\n        value = _this$props12.value,\r\n        valueKey = _this$props12.valueKey;\r\n\r\n    if (!shallowEqual(prevState.value, value)) {\r\n      var activeNode = null;\r\n\r\n      if (this.node === null) {\r\n        activeNode = this.getActiveNode(value);\r\n      }\r\n\r\n      if (value !== null && this.node !== null) {\r\n        activeNode = shallowEqual(this.node[valueKey], value) ? this.node : this.getActiveNode(value);\r\n      }\r\n\r\n      var nextState = {\r\n        value: value,\r\n        activeNode: activeNode\r\n      };\r\n\r\n      if (value === null) {\r\n        nextState.activeNode = null;\r\n        this.node = null;\r\n      }\r\n\r\n      if (activeNode !== null) {\r\n        this.focusNode(activeNode);\r\n      }\r\n\r\n      this.setState(nextState);\r\n    }\r\n  };\r\n\r\n  _proto.updateExpandItemValuesChange = function updateExpandItemValuesChange(prevState) {\r\n    var expandItemValues = this.props.expandItemValues;\r\n\r\n    if (compareArray(expandItemValues, prevState.expandItemValues)) {\r\n      this.unserializeLists('expand', expandItemValues);\r\n      this.setState({\r\n        expandItemValues: expandItemValues\r\n      });\r\n    }\r\n  };\r\n\r\n  _proto.updateSearchKeywordChange = function updateSearchKeywordChange(prevState) {\r\n    var filterData = this.state.filterData;\r\n\r\n    if (!_isUndefined(this.props.searchKeyword) && prevState.searchKeyword !== this.props.searchKeyword) {\r\n      this.setState({\r\n        filterData: this.getFilterData(filterData, this.props.searchKeyword)\r\n      });\r\n    }\r\n  };\r\n\r\n  _proto.getValue = function getValue(props) {\r\n    if (props === void 0) {\r\n      props = this.props;\r\n    }\r\n\r\n    var _props = props,\r\n        value = _props.value,\r\n        defaultValue = _props.defaultValue;\r\n    return !_isUndefined(value) ? value : defaultValue;\r\n  };\r\n\r\n  _proto.getActiveNode = function getActiveNode(value, valueKey) {\r\n    var _this4 = this;\r\n\r\n    if (valueKey === void 0) {\r\n      valueKey = this.props.valueKey;\r\n    }\r\n\r\n    var activeNode = null;\r\n\r\n    if (!_isUndefined(value)) {\r\n      Object.keys(this.nodes).forEach(function (refKey) {\r\n        if (shallowEqual(_this4.nodes[refKey][valueKey], value)) {\r\n          activeNode = _this4.nodes[refKey];\r\n        }\r\n      });\r\n    }\r\n\r\n    return activeNode;\r\n  };\r\n\r\n  _proto.getActiveElementOption = function getActiveElementOption(options, value) {\r\n    var childrenKey = this.props.childrenKey;\r\n\r\n    for (var i = 0; i < options.length; i += 1) {\r\n      var _options$i$childrenKe;\r\n\r\n      if (options[i].value === value) {\r\n        return options[i];\r\n      } else if ((_options$i$childrenKe = options[i][childrenKey]) === null || _options$i$childrenKe === void 0 ? void 0 : _options$i$childrenKe.length) {\r\n        var active = this.getActiveElementOption(options[i][childrenKey], value);\r\n\r\n        if (!_isEmpty(active)) {\r\n          return active;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {};\r\n  };\r\n\r\n  _proto.getItemsAndActiveIndex = function getItemsAndActiveIndex() {\r\n    var items = this.getFocusableMenuItems();\r\n    var activeIndex = -1;\r\n    items.forEach(function (item, index) {\r\n      if (document.activeElement !== null) {\r\n        if (item.refKey === document.activeElement.getAttribute('data-key')) {\r\n          activeIndex = index;\r\n        }\r\n      }\r\n    });\r\n    return {\r\n      items: items,\r\n      activeIndex: activeIndex\r\n    };\r\n  };\r\n\r\n  _proto.getActiveItem = function getActiveItem() {\r\n    var nodeData = {};\r\n    var activeItem = document.activeElement;\r\n\r\n    if (activeItem !== null) {\r\n      var _get2 = _get(activeItem, 'dataset'),\r\n          key = _get2.key,\r\n          layer = _get2.layer;\r\n\r\n      var activeNode = this.nodes[key];\r\n\r\n      if (activeNode) {\r\n        nodeData = activeNode;\r\n      }\r\n\r\n      return {\r\n        nodeData: nodeData,\r\n        layer: layer\r\n      };\r\n    }\r\n\r\n    return {};\r\n  };\r\n\r\n  _proto.getFilterData = function getFilterData(data, word, props) {\r\n    if (word === void 0) {\r\n      word = '';\r\n    }\r\n\r\n    var _ref2 = props || this.props,\r\n        labelKey = _ref2.labelKey,\r\n        childrenKey = _ref2.childrenKey,\r\n        searchBy = _ref2.searchBy;\r\n\r\n    var setVisible = function setVisible(nodes) {\r\n      if (nodes === void 0) {\r\n        nodes = [];\r\n      }\r\n\r\n      return nodes.forEach(function (item) {\r\n        item.visible = searchBy ? searchBy(word, item[labelKey], item) : shouldDisplay(item[labelKey], word);\r\n\r\n        if (_isArray(item[childrenKey])) {\r\n          setVisible(item[childrenKey]);\r\n          item[childrenKey].forEach(function (child) {\r\n            if (child.visible) {\r\n              item.visible = child.visible;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    };\r\n\r\n    if (!_isUndefined(word)) {\r\n      setVisible(data);\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  _proto.getFlattenTreeData = function getFlattenTreeData(nodes) {\r\n    var _this5 = this;\r\n\r\n    var expandItemValues = this.state.expandItemValues;\r\n    var _this$props13 = this.props,\r\n        childrenKey = _this$props13.childrenKey,\r\n        valueKey = _this$props13.valueKey;\r\n    return flattenTree(nodes, childrenKey, function (node) {\r\n      var formatted = {};\r\n      var curNode = _this5.nodes[node.refKey];\r\n      var parentKeys = getNodeParents(curNode, 'parentNode', valueKey);\r\n\r\n      if (curNode) {\r\n        formatted = _extends({}, node, {\r\n          expand: curNode.expand,\r\n          layer: curNode.layer,\r\n          parentNode: curNode.parentNode,\r\n          showNode: shouldShowNodeByExpanded(expandItemValues, parentKeys)\r\n        });\r\n      }\r\n\r\n      return formatted;\r\n    });\r\n  };\r\n\r\n  _proto.getTreeNodeProps = function getTreeNodeProps(node, layer, index) {\r\n    var _this$state5 = this.state,\r\n        dragOverNodeKey = _this$state5.dragOverNodeKey,\r\n        selectedValue = _this$state5.selectedValue,\r\n        dropNodePosition = _this$state5.dropNodePosition;\r\n    var dragNode = this.dragNode || {};\r\n    var _this$props14 = this.props,\r\n        locale = _this$props14.locale,\r\n        valueKey = _this$props14.valueKey,\r\n        labelKey = _this$props14.labelKey,\r\n        draggable = _this$props14.draggable,\r\n        childrenKey = _this$props14.childrenKey,\r\n        _this$props14$disable = _this$props14.disabledItemValues,\r\n        disabledItemValues = _this$props14$disable === void 0 ? [] : _this$props14$disable,\r\n        renderTreeNode = _this$props14.renderTreeNode,\r\n        renderTreeIcon = _this$props14.renderTreeIcon;\r\n    return {\r\n      rtl: locale.rtl,\r\n      value: node[valueKey],\r\n      label: node[labelKey],\r\n      index: index,\r\n      layer: layer,\r\n      expand: node.expand,\r\n      active: shallowEqual(node[valueKey], selectedValue),\r\n      visible: node.visible,\r\n      draggable: draggable,\r\n      dragging: shallowEqual(node[valueKey], dragNode[valueKey]),\r\n      children: node[childrenKey],\r\n      nodeData: node,\r\n      disabled: disabledItemValues.some(function (disabledItem) {\r\n        return shallowEqual(disabledItem, node[valueKey]);\r\n      }),\r\n      dragOver: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER,\r\n      dragOverTop: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_TOP,\r\n      dragOverBottom: shallowEqual(node[valueKey], dragOverNodeKey) && dropNodePosition === TREE_NODE_DROP_POSITION.DRAG_OVER_BOTTOM,\r\n      onSelect: this.handleSelect,\r\n      onDragStart: this.handleDragStart,\r\n      onDragEnter: this.handleDragEnter,\r\n      onDragOver: this.handleDragOver,\r\n      onDragLeave: this.handleDragLeave,\r\n      onDragEnd: this.handleDragEnd,\r\n      onDrop: this.handleDrop,\r\n      onTreeToggle: this.handleToggle,\r\n      onRenderTreeNode: renderTreeNode,\r\n      onRenderTreeIcon: renderTreeIcon\r\n    };\r\n  }\r\n  /**\r\n   * 获取 onDrop 的回调数据\r\n   */\r\n  ;\r\n\r\n  _proto.getDropData = function getDropData(nodeData) {\r\n    var dropNodePosition = this.state.dropNodePosition;\r\n    var _this$props15 = this.props,\r\n        valueKey = _this$props15.valueKey,\r\n        childrenKey = _this$props15.childrenKey;\r\n    var options = {\r\n      valueKey: valueKey,\r\n      childrenKey: childrenKey\r\n    };\r\n\r\n    var dragNode = _omit(this.dragNode, 'parentNode');\r\n\r\n    return {\r\n      /** 拖拽节点 */\r\n      dragNode: dragNode,\r\n\r\n      /** 释放所在节点的父节点 */\r\n      dropNode: nodeData,\r\n\r\n      /** 拖拽节点的类型 */\r\n      dropNodePosition: dropNodePosition,\r\n      createUpdateDataFunction: createUpdateTreeDataFunction({\r\n        /** 拖拽节点 */\r\n        dragNode: dragNode,\r\n\r\n        /** 释放所在节点的父节点 */\r\n        dropNode: nodeData,\r\n\r\n        /** 拖拽节点的类型 */\r\n        dropNodePosition: dropNodePosition\r\n      }, options)\r\n    };\r\n  };\r\n\r\n  _proto.focusNode = function focusNode(activeNode) {\r\n    var inline = this.props.inline;\r\n\r\n    if (activeNode && inline) {\r\n      var _node$focus4;\r\n\r\n      var node = this.getElementByDataKey(activeNode.refKey);\r\n      node === null || node === void 0 ? void 0 : (_node$focus4 = node.focus) === null || _node$focus4 === void 0 ? void 0 : _node$focus4.call(node);\r\n    }\r\n  };\r\n\r\n  _proto.flattenNodes = function flattenNodes(nodes, props, ref, parentNode, layer) {\r\n    var _this6 = this;\r\n\r\n    if (ref === void 0) {\r\n      ref = '0';\r\n    }\r\n\r\n    if (layer === void 0) {\r\n      layer = 0;\r\n    }\r\n\r\n    var _ref3 = props || this.props,\r\n        labelKey = _ref3.labelKey,\r\n        valueKey = _ref3.valueKey,\r\n        childrenKey = _ref3.childrenKey;\r\n\r\n    if (!Array.isArray(nodes) || nodes.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    nodes.map(function (node, index) {\r\n      var _extends2;\r\n\r\n      var refKey = ref + \"-\" + index;\r\n      node.refKey = refKey;\r\n      _this6.nodes[refKey] = _extends((_extends2 = {\r\n        layer: layer\r\n      }, _extends2[labelKey] = node[labelKey], _extends2[valueKey] = node[valueKey], _extends2.expand = getExpandState(node, props || _this6.props), _extends2.refKey = refKey, _extends2), node);\r\n\r\n      if (parentNode) {\r\n        _this6.nodes[refKey].parentNode = parentNode;\r\n      }\r\n\r\n      _this6.flattenNodes(node[childrenKey], props, refKey, _this6.nodes[refKey], layer + 1);\r\n    });\r\n  };\r\n\r\n  _proto.serializeList = function serializeList(key, nodes) {\r\n    if (nodes === void 0) {\r\n      nodes = this.nodes;\r\n    }\r\n\r\n    var valueKey = this.props.valueKey;\r\n    var list = [];\r\n    Object.keys(nodes).forEach(function (refKey) {\r\n      if (nodes[refKey][key]) {\r\n        list.push(nodes[refKey][valueKey]);\r\n      }\r\n    });\r\n    return list;\r\n  };\r\n\r\n  _proto.unserializeLists = function unserializeLists(key, value, props) {\r\n    var _this7 = this;\r\n\r\n    if (value === void 0) {\r\n      value = [];\r\n    }\r\n\r\n    if (props === void 0) {\r\n      props = this.props;\r\n    }\r\n\r\n    var _props2 = props,\r\n        valueKey = _props2.valueKey;\r\n    var expandAll = getExpandAll(props);\r\n    Object.keys(this.nodes).forEach(function (refKey) {\r\n      _this7.nodes[refKey][key] = false;\r\n\r\n      if (value.length) {\r\n        value.forEach(function (value) {\r\n          if (shallowEqual(_this7.nodes[refKey][valueKey], value)) {\r\n            _this7.nodes[refKey][key] = true;\r\n          }\r\n        });\r\n      } else {\r\n        _this7.nodes[refKey][key] = expandAll;\r\n      }\r\n    });\r\n  };\r\n\r\n  _proto.toggleExpand = function toggleExpand(node, isExpand) {\r\n    var valueKey = this.props.valueKey;\r\n    var expandItemValues = new Set(this.serializeList('expand'));\r\n\r\n    if (isExpand) {\r\n      expandItemValues.add(node[valueKey]);\r\n    } else {\r\n      expandItemValues.delete(node[valueKey]);\r\n    }\r\n\r\n    return Array.from(expandItemValues);\r\n  };\r\n\r\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\r\n    var _this$props16 = this.props,\r\n        _this$props16$height = _this$props16.height,\r\n        height = _this$props16$height === void 0 ? defaultHeight : _this$props16$height,\r\n        searchable = _this$props16.searchable,\r\n        searchKeyword = _this$props16.searchKeyword,\r\n        renderExtraFooter = _this$props16.renderExtraFooter,\r\n        locale = _this$props16.locale,\r\n        renderMenu = _this$props16.renderMenu,\r\n        menuStyle = _this$props16.menuStyle,\r\n        virtualized = _this$props16.virtualized,\r\n        menuClassName = _this$props16.menuClassName,\r\n        menuAutoWidth = _this$props16.menuAutoWidth;\r\n    var keyword = !_isUndefined(searchKeyword) ? searchKeyword : this.state.searchKeyword;\r\n    var classes = classNames(menuClassName, this.addPrefix('tree-menu'));\r\n    var styles = virtualized ? _extends({\r\n      height: height\r\n    }, menuStyle) : menuStyle;\r\n    return React.createElement(MenuWrapper, {\r\n      autoWidth: menuAutoWidth,\r\n      className: classes,\r\n      style: styles,\r\n      ref: this.menuRef,\r\n      getToggleInstance: this.getToggleInstance,\r\n      getPositionInstance: this.getPositionInstance\r\n    }, searchable ? React.createElement(SearchBar, {\r\n      placeholder: locale.searchPlaceholder,\r\n      key: \"searchBar\",\r\n      onChange: this.handleSearch,\r\n      value: keyword\r\n    }) : null, renderMenu ? renderMenu(this.renderTree()) : this.renderTree(), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\r\n  };\r\n\r\n  _proto.renderNode = function renderNode(node, index, layer) {\r\n    var _this8 = this;\r\n\r\n    var searchKeyword = this.state.searchKeyword;\r\n    var _this$props17 = this.props,\r\n        valueKey = _this$props17.valueKey,\r\n        childrenKey = _this$props17.childrenKey;\r\n\r\n    if (!node.visible) {\r\n      return null;\r\n    }\r\n\r\n    var refKey = node.refKey;\r\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\r\n    var key = _isString(node[valueKey]) || _isNumber(node[valueKey]) ? node[valueKey] : refKey;\r\n    var children = node[childrenKey]; // 当用户进行搜索时，hasChildren的判断要变成判断是否存在 visible 为 true 的子节点\r\n\r\n    var visibleChildren = _isUndefined(searchKeyword) || searchKeyword.length === 0 ? !!children : hasVisibleChildren(node, childrenKey);\r\n\r\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\r\n      expand: expand\r\n    }), layer, index), {\r\n      hasChildren: visibleChildren\r\n    });\r\n\r\n    if (nodeProps.hasChildren) {\r\n      var _classNames;\r\n\r\n      layer += 1; // 是否展开树节点且子节点不为空\r\n\r\n      var openClass = this.addTreePrefix('open');\r\n      var childrenClass = classNames(this.addTreePrefix('node-children'), (_classNames = {}, _classNames[openClass] = expand && visibleChildren, _classNames));\r\n      var nodes = children || [];\r\n      return React.createElement(\"div\", {\r\n        className: childrenClass,\r\n        key: key\r\n      }, React.createElement(TreeNode, _extends({}, nodeProps, {\r\n        innerRef: this.bindNodeRefs.bind(this, refKey)\r\n      })), React.createElement(\"div\", {\r\n        className: this.addTreePrefix('children')\r\n      }, nodes.map(function (child, i) {\r\n        return _this8.renderNode(child, i, layer);\r\n      })));\r\n    }\r\n\r\n    return React.createElement(TreeNode, _extends({\r\n      key: key,\r\n      innerRef: this.bindNodeRefs.bind(this, refKey)\r\n    }, nodeProps));\r\n  };\r\n\r\n  _proto.renderVirtualNode = function renderVirtualNode(node, options) {\r\n    var searchKeyword = this.state.searchKeyword;\r\n    var childrenKey = this.props.childrenKey;\r\n    var key = options.key,\r\n        style = options.style;\r\n    var layer = node.layer,\r\n        refKey = node.refKey,\r\n        showNode = node.showNode;\r\n    var expand = getExpandWhenSearching(searchKeyword, this.nodes[refKey].expand);\r\n\r\n    if (!node.visible) {\r\n      return null;\r\n    }\r\n\r\n    var nodeProps = _extends({}, this.getTreeNodeProps(_extends({}, node, {\r\n      expand: expand\r\n    }), layer), {\r\n      style: style,\r\n      hasChildren: !!node[childrenKey]\r\n    });\r\n\r\n    return showNode && React.createElement(TreeNode, _extends({\r\n      key: key,\r\n      innerRef: this.bindNodeRefs.bind(this, refKey)\r\n    }, nodeProps));\r\n  };\r\n\r\n  _proto.renderTree = function renderTree() {\r\n    var _classNames2,\r\n        _this9 = this;\r\n\r\n    var filterData = this.state.filterData;\r\n    var _this$props18 = this.props,\r\n        height = _this$props18.height,\r\n        className = _this$props18.className,\r\n        inline = _this$props18.inline,\r\n        style = _this$props18.style,\r\n        locale = _this$props18.locale,\r\n        virtualized = _this$props18.virtualized,\r\n        searchable = _this$props18.searchable;\r\n    var layer = 0;\r\n    var classes = classNames(defaultClassPrefix('tree'), (_classNames2 = {}, _classNames2[className] = inline, _classNames2));\r\n    var nodes = [];\r\n\r\n    if (!virtualized) {\r\n      nodes = filterData.map(function (dataItem, index) {\r\n        return _this9.renderNode(dataItem, index, layer);\r\n      });\r\n\r\n      if (!nodes.some(function (v) {\r\n        return v !== null;\r\n      })) {\r\n        return React.createElement(\"div\", {\r\n          className: this.addPrefix('none')\r\n        }, locale.noResultsText);\r\n      }\r\n    } else {\r\n      nodes = this.getFlattenTreeData(filterData).filter(function (n) {\r\n        return n.showNode && n.visible;\r\n      });\r\n\r\n      if (!nodes.length) {\r\n        return React.createElement(\"div\", {\r\n          className: this.addPrefix('none')\r\n        }, locale.noResultsText);\r\n      }\r\n    } // 当未定义 height 且 设置了 virtualized 为 true，treeHeight 设置默认高度\r\n\r\n\r\n    var treeHeight = _isUndefined(height) && virtualized ? defaultHeight : height;\r\n    var treeWidth = _isUndefined(style === null || style === void 0 ? void 0 : style.width) ? defaultWidth : style.width;\r\n    var styles = inline ? _extends({\r\n      height: treeHeight\r\n    }, style) : {};\r\n    var listHeight = getVirtualLisHeight(inline, searchable, treeHeight);\r\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\r\n      ref: this.treeViewRef,\r\n      className: classes,\r\n      style: styles,\r\n      onKeyDown: this.handleKeyDown\r\n    }, React.createElement(\"div\", {\r\n      className: this.addTreePrefix('nodes')\r\n    }, virtualized ? React.createElement(AutoSizer, {\r\n      defaultHeight: listHeight,\r\n      defaultWidth: treeWidth\r\n    }, function (_ref4) {\r\n      var height = _ref4.height,\r\n          width = _ref4.width;\r\n      return React.createElement(List, {\r\n        ref: _this9.listRef,\r\n        width: width || treeWidth,\r\n        height: height || listHeight,\r\n        rowHeight: 38,\r\n        rowCount: nodes.length,\r\n        rowRenderer: _this9.measureRowRenderer(nodes)\r\n      });\r\n    }) : nodes)), this.renderDragNode());\r\n  };\r\n\r\n  _proto.renderDragNode = function renderDragNode() {\r\n    var _this$props19 = this.props,\r\n        labelKey = _this$props19.labelKey,\r\n        draggable = _this$props19.draggable,\r\n        renderDragNode = _this$props19.renderDragNode;\r\n    var dragNode = this.dragNode || {};\r\n\r\n    if (draggable) {\r\n      var dragNodeContent = dragNode[labelKey];\r\n\r\n      if (_isFunction(renderDragNode)) {\r\n        dragNodeContent = renderDragNode(dragNode);\r\n      }\r\n\r\n      return React.createElement(\"span\", {\r\n        id: \"drag-node\",\r\n        className: this.addTreePrefix('drag-node-mover')\r\n      }, dragNodeContent);\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  _proto.render = function render() {\r\n    var _this$props20 = this.props,\r\n        inline = _this$props20.inline,\r\n        locale = _this$props20.locale,\r\n        disabled = _this$props20.disabled,\r\n        toggleComponentClass = _this$props20.toggleComponentClass,\r\n        placeholder = _this$props20.placeholder,\r\n        cleanable = _this$props20.cleanable,\r\n        renderValue = _this$props20.renderValue,\r\n        labelKey = _this$props20.labelKey,\r\n        onEntered = _this$props20.onEntered,\r\n        onExited = _this$props20.onExited,\r\n        onClean = _this$props20.onClean,\r\n        style = _this$props20.style,\r\n        positionRef = _this$props20.positionRef,\r\n        rest = _objectWithoutPropertiesLoose(_this$props20, [\"inline\", \"locale\", \"disabled\", \"toggleComponentClass\", \"placeholder\", \"cleanable\", \"renderValue\", \"labelKey\", \"onEntered\", \"onExited\", \"onClean\", \"style\", \"positionRef\"]);\r\n\r\n    var _this$state6 = this.state,\r\n        selectedValue = _this$state6.selectedValue,\r\n        activeNode = _this$state6.activeNode;\r\n\r\n    var hasValidValue = !_isNil(activeNode) || !_isNil(selectedValue) && _isFunction(renderValue);\r\n\r\n    var classes = getToggleWrapperClassName('tree', this.addPrefix, this.props, hasValidValue);\r\n    var selectedElement = placeholder;\r\n    var hasValue = !!activeNode;\r\n    /**\r\n     * if value is invalid and renderValue is undefined, then using placeholder.\r\n     * if value is valid and renderValue is't undefined, then using renderValue()\r\n     */\r\n\r\n    if (!_isNil(selectedValue)) {\r\n      if (hasValue) {\r\n        selectedElement = activeNode[labelKey];\r\n      }\r\n\r\n      if (_isFunction(renderValue)) {\r\n        var node = activeNode !== null && activeNode !== void 0 ? activeNode : {};\r\n        selectedElement = renderValue(selectedValue, node, selectedElement);\r\n      }\r\n    }\r\n\r\n    var unhandled = getUnhandledProps(TreePicker, rest);\r\n\r\n    if (inline) {\r\n      return this.renderTree();\r\n    }\r\n\r\n    return React.createElement(PickerToggleTrigger, {\r\n      pickerProps: this.props,\r\n      ref: this.triggerRef,\r\n      positionRef: mergeRefs(this.positionRef, positionRef),\r\n      onEntered: createChainedFunction(this.handleOnOpen, onEntered),\r\n      onExited: createChainedFunction(this.handleOnClose, onExited),\r\n      speaker: this.renderDropdownMenu()\r\n    }, React.createElement(\"div\", {\r\n      className: classes,\r\n      style: style\r\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\r\n      ref: this.toggleRef,\r\n      onKeyDown: this.handleToggleKeyDown,\r\n      onClean: createChainedFunction(this.handleClean, onClean),\r\n      cleanable: cleanable && !disabled,\r\n      componentClass: toggleComponentClass,\r\n      hasValue: hasValidValue,\r\n      active: this.state.active\r\n    }), selectedElement || locale.placeholder)));\r\n  };\r\n\r\n  return TreePicker;\r\n}(React.Component);\r\n\r\nTreePicker.propTypes = _extends({}, listPickerPropTypes, {\r\n  height: PropTypes.number,\r\n  inline: PropTypes.bool,\r\n  draggable: PropTypes.bool,\r\n  expandAll: PropTypes.bool,\r\n  virtualized: PropTypes.bool,\r\n  searchable: PropTypes.bool,\r\n  menuAutoWidth: PropTypes.bool,\r\n  searchKeyword: PropTypes.string,\r\n  defaultExpandAll: PropTypes.bool,\r\n  expandItemValues: PropTypes.array,\r\n  defaultExpandItemValues: PropTypes.array,\r\n  onSearch: PropTypes.func,\r\n  onExpand: PropTypes.func,\r\n  onSelect: PropTypes.func,\r\n  renderMenu: PropTypes.func,\r\n  renderTreeNode: PropTypes.func,\r\n  renderTreeIcon: PropTypes.func,\r\n  renderExtraFooter: PropTypes.func,\r\n  renderDragNode: PropTypes.func,\r\n  searchBy: PropTypes.func\r\n});\r\nTreePicker.defaultProps = _extends({}, listPickerDefaultProps, {\r\n  searchable: true,\r\n  menuAutoWidth: true,\r\n  locale: {\r\n    placeholder: 'Select',\r\n    searchPlaceholder: 'Search',\r\n    noResultsText: 'No results found'\r\n  }\r\n});\r\npolyfill(TreePicker);\r\nexport default defaultProps({\r\n  classPrefix: 'picker'\r\n})(TreePicker);"],"mappings":"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"},"metadata":{},"sourceType":"module"}