{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EquationItem = exports.EqnArrayItem = exports.ArrayItem = exports.DotsItem = exports.NonscriptItem = exports.NotItem = exports.FnItem = exports.MmlItem = exports.CellItem = exports.PositionItem = exports.StyleItem = exports.EndItem = exports.BeginItem = exports.RightItem = exports.Middle = exports.LeftItem = exports.OverItem = exports.SubsupItem = exports.PrimeItem = exports.CloseItem = exports.OpenItem = exports.StopItem = exports.StartItem = void 0;\n\nvar MapHandler_js_1 = require(\"../MapHandler.js\");\n\nvar Entities_js_1 = require(\"../../../util/Entities.js\");\n\nvar MmlNode_js_1 = require(\"../../../core/MmlTree/MmlNode.js\");\n\nvar TexError_js_1 = __importDefault(require(\"../TexError.js\"));\n\nvar ParseUtil_js_1 = __importDefault(require(\"../ParseUtil.js\"));\n\nvar NodeUtil_js_1 = __importDefault(require(\"../NodeUtil.js\"));\n\nvar StackItem_js_1 = require(\"../StackItem.js\");\n\nvar StartItem = function (_super) {\n  __extends(StartItem, _super);\n\n  function StartItem(factory, global) {\n    var _this = _super.call(this, factory) || this;\n\n    _this.global = global;\n    return _this;\n  }\n\n  Object.defineProperty(StartItem.prototype, \"kind\", {\n    get: function get() {\n      return 'start';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StartItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StartItem.prototype.checkItem = function (item) {\n    if (item.isKind('stop')) {\n      var node = this.toMml();\n\n      if (!this.global.isInner) {\n        node = this.factory.configuration.tags.finalize(node, this.env);\n      }\n\n      return [[this.factory.create('mml', node)], true];\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  return StartItem;\n}(StackItem_js_1.BaseItem);\n\nexports.StartItem = StartItem;\n\nvar StopItem = function (_super) {\n  __extends(StopItem, _super);\n\n  function StopItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(StopItem.prototype, \"kind\", {\n    get: function get() {\n      return 'stop';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StopItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return StopItem;\n}(StackItem_js_1.BaseItem);\n\nexports.StopItem = StopItem;\n\nvar OpenItem = function (_super) {\n  __extends(OpenItem, _super);\n\n  function OpenItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(OpenItem.prototype, \"kind\", {\n    get: function get() {\n      return 'open';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(OpenItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  OpenItem.prototype.checkItem = function (item) {\n    if (item.isKind('close')) {\n      var mml = this.toMml();\n      var node = this.create('node', 'TeXAtom', [mml]);\n      return [[this.factory.create('mml', node)], true];\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  OpenItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {\n    'stop': ['ExtraOpenMissingClose', 'Extra open brace or missing close brace']\n  });\n  return OpenItem;\n}(StackItem_js_1.BaseItem);\n\nexports.OpenItem = OpenItem;\n\nvar CloseItem = function (_super) {\n  __extends(CloseItem, _super);\n\n  function CloseItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(CloseItem.prototype, \"kind\", {\n    get: function get() {\n      return 'close';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CloseItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return CloseItem;\n}(StackItem_js_1.BaseItem);\n\nexports.CloseItem = CloseItem;\n\nvar PrimeItem = function (_super) {\n  __extends(PrimeItem, _super);\n\n  function PrimeItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(PrimeItem.prototype, \"kind\", {\n    get: function get() {\n      return 'prime';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  PrimeItem.prototype.checkItem = function (item) {\n    var _a = __read(this.Peek(2), 2),\n        top0 = _a[0],\n        top1 = _a[1];\n\n    if (!NodeUtil_js_1.default.isType(top0, 'msubsup') || NodeUtil_js_1.default.isType(top0, 'msup')) {\n      var node = this.create('node', 'msup', [top0, top1]);\n      return [[node, item], true];\n    }\n\n    NodeUtil_js_1.default.setChild(top0, top0.sup, top1);\n    return [[top0, item], true];\n  };\n\n  return PrimeItem;\n}(StackItem_js_1.BaseItem);\n\nexports.PrimeItem = PrimeItem;\n\nvar SubsupItem = function (_super) {\n  __extends(SubsupItem, _super);\n\n  function SubsupItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(SubsupItem.prototype, \"kind\", {\n    get: function get() {\n      return 'subsup';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  SubsupItem.prototype.checkItem = function (item) {\n    if (item.isKind('open') || item.isKind('left')) {\n      return StackItem_js_1.BaseItem.success;\n    }\n\n    var top = this.First;\n    var position = this.getProperty('position');\n\n    if (item.isKind('mml')) {\n      if (this.getProperty('primes')) {\n        if (position !== 2) {\n          NodeUtil_js_1.default.setChild(top, 2, this.getProperty('primes'));\n        } else {\n          NodeUtil_js_1.default.setProperty(this.getProperty('primes'), 'variantForm', true);\n          var node = this.create('node', 'mrow', [this.getProperty('primes'), item.First]);\n          item.First = node;\n        }\n      }\n\n      NodeUtil_js_1.default.setChild(top, position, item.First);\n\n      if (this.getProperty('movesupsub') != null) {\n        NodeUtil_js_1.default.setProperty(top, 'movesupsub', this.getProperty('movesupsub'));\n      }\n\n      var result = this.factory.create('mml', top);\n      return [[result], true];\n    }\n\n    if (_super.prototype.checkItem.call(this, item)[1]) {\n      var error = this.getErrors(['', 'sub', 'sup'][position]);\n      throw new (TexError_js_1.default.bind.apply(TexError_js_1.default, __spreadArray([void 0, error[0], error[1]], __read(error.splice(2)), false)))();\n    }\n\n    return null;\n  };\n\n  SubsupItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {\n    'stop': ['MissingScript', 'Missing superscript or subscript argument'],\n    'sup': ['MissingOpenForSup', 'Missing open brace for superscript'],\n    'sub': ['MissingOpenForSub', 'Missing open brace for subscript']\n  });\n  return SubsupItem;\n}(StackItem_js_1.BaseItem);\n\nexports.SubsupItem = SubsupItem;\n\nvar OverItem = function (_super) {\n  __extends(OverItem, _super);\n\n  function OverItem(factory) {\n    var _this = _super.call(this, factory) || this;\n\n    _this.setProperty('name', '\\\\over');\n\n    return _this;\n  }\n\n  Object.defineProperty(OverItem.prototype, \"kind\", {\n    get: function get() {\n      return 'over';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(OverItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  OverItem.prototype.checkItem = function (item) {\n    if (item.isKind('over')) {\n      throw new TexError_js_1.default('AmbiguousUseOf', 'Ambiguous use of %1', item.getName());\n    }\n\n    if (item.isClose) {\n      var mml = this.create('node', 'mfrac', [this.getProperty('num'), this.toMml(false)]);\n\n      if (this.getProperty('thickness') != null) {\n        NodeUtil_js_1.default.setAttribute(mml, 'linethickness', this.getProperty('thickness'));\n      }\n\n      if (this.getProperty('open') || this.getProperty('close')) {\n        NodeUtil_js_1.default.setProperty(mml, 'withDelims', true);\n        mml = ParseUtil_js_1.default.fixedFence(this.factory.configuration, this.getProperty('open'), mml, this.getProperty('close'));\n      }\n\n      return [[this.factory.create('mml', mml), item], true];\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  OverItem.prototype.toString = function () {\n    return 'over[' + this.getProperty('num') + ' / ' + this.nodes.join('; ') + ']';\n  };\n\n  return OverItem;\n}(StackItem_js_1.BaseItem);\n\nexports.OverItem = OverItem;\n\nvar LeftItem = function (_super) {\n  __extends(LeftItem, _super);\n\n  function LeftItem(factory, delim) {\n    var _this = _super.call(this, factory) || this;\n\n    _this.setProperty('delim', delim);\n\n    return _this;\n  }\n\n  Object.defineProperty(LeftItem.prototype, \"kind\", {\n    get: function get() {\n      return 'left';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(LeftItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  LeftItem.prototype.checkItem = function (item) {\n    if (item.isKind('right')) {\n      return [[this.factory.create('mml', ParseUtil_js_1.default.fenced(this.factory.configuration, this.getProperty('delim'), this.toMml(), item.getProperty('delim'), '', item.getProperty('color')))], true];\n    }\n\n    if (item.isKind('middle')) {\n      var def = {\n        stretchy: true\n      };\n\n      if (item.getProperty('color')) {\n        def.mathcolor = item.getProperty('color');\n      }\n\n      this.Push(this.create('node', 'TeXAtom', [], {\n        texClass: MmlNode_js_1.TEXCLASS.CLOSE\n      }), this.create('token', 'mo', def, item.getProperty('delim')), this.create('node', 'TeXAtom', [], {\n        texClass: MmlNode_js_1.TEXCLASS.OPEN\n      }));\n      this.env = {};\n      return [[this], true];\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  LeftItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {\n    'stop': ['ExtraLeftMissingRight', 'Extra \\\\left or missing \\\\right']\n  });\n  return LeftItem;\n}(StackItem_js_1.BaseItem);\n\nexports.LeftItem = LeftItem;\n\nvar Middle = function (_super) {\n  __extends(Middle, _super);\n\n  function Middle(factory, delim, color) {\n    var _this = _super.call(this, factory) || this;\n\n    _this.setProperty('delim', delim);\n\n    color && _this.setProperty('color', color);\n    return _this;\n  }\n\n  Object.defineProperty(Middle.prototype, \"kind\", {\n    get: function get() {\n      return 'middle';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Middle.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return Middle;\n}(StackItem_js_1.BaseItem);\n\nexports.Middle = Middle;\n\nvar RightItem = function (_super) {\n  __extends(RightItem, _super);\n\n  function RightItem(factory, delim, color) {\n    var _this = _super.call(this, factory) || this;\n\n    _this.setProperty('delim', delim);\n\n    color && _this.setProperty('color', color);\n    return _this;\n  }\n\n  Object.defineProperty(RightItem.prototype, \"kind\", {\n    get: function get() {\n      return 'right';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(RightItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return RightItem;\n}(StackItem_js_1.BaseItem);\n\nexports.RightItem = RightItem;\n\nvar BeginItem = function (_super) {\n  __extends(BeginItem, _super);\n\n  function BeginItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(BeginItem.prototype, \"kind\", {\n    get: function get() {\n      return 'begin';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(BeginItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  BeginItem.prototype.checkItem = function (item) {\n    if (item.isKind('end')) {\n      if (item.getName() !== this.getName()) {\n        throw new TexError_js_1.default('EnvBadEnd', '\\\\begin{%1} ended with \\\\end{%2}', this.getName(), item.getName());\n      }\n\n      if (!this.getProperty('end')) {\n        return [[this.factory.create('mml', this.toMml())], true];\n      }\n\n      return StackItem_js_1.BaseItem.fail;\n    }\n\n    if (item.isKind('stop')) {\n      throw new TexError_js_1.default('EnvMissingEnd', 'Missing \\\\end{%1}', this.getName());\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  return BeginItem;\n}(StackItem_js_1.BaseItem);\n\nexports.BeginItem = BeginItem;\n\nvar EndItem = function (_super) {\n  __extends(EndItem, _super);\n\n  function EndItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(EndItem.prototype, \"kind\", {\n    get: function get() {\n      return 'end';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(EndItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return EndItem;\n}(StackItem_js_1.BaseItem);\n\nexports.EndItem = EndItem;\n\nvar StyleItem = function (_super) {\n  __extends(StyleItem, _super);\n\n  function StyleItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(StyleItem.prototype, \"kind\", {\n    get: function get() {\n      return 'style';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StyleItem.prototype.checkItem = function (item) {\n    if (!item.isClose) {\n      return _super.prototype.checkItem.call(this, item);\n    }\n\n    var mml = this.create('node', 'mstyle', this.nodes, this.getProperty('styles'));\n    return [[this.factory.create('mml', mml), item], true];\n  };\n\n  return StyleItem;\n}(StackItem_js_1.BaseItem);\n\nexports.StyleItem = StyleItem;\n\nvar PositionItem = function (_super) {\n  __extends(PositionItem, _super);\n\n  function PositionItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(PositionItem.prototype, \"kind\", {\n    get: function get() {\n      return 'position';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  PositionItem.prototype.checkItem = function (item) {\n    if (item.isClose) {\n      throw new TexError_js_1.default('MissingBoxFor', 'Missing box for %1', this.getName());\n    }\n\n    if (item.isFinal) {\n      var mml = item.toMml();\n\n      switch (this.getProperty('move')) {\n        case 'vertical':\n          mml = this.create('node', 'mpadded', [mml], {\n            height: this.getProperty('dh'),\n            depth: this.getProperty('dd'),\n            voffset: this.getProperty('dh')\n          });\n          return [[this.factory.create('mml', mml)], true];\n\n        case 'horizontal':\n          return [[this.factory.create('mml', this.getProperty('left')), item, this.factory.create('mml', this.getProperty('right'))], true];\n      }\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  return PositionItem;\n}(StackItem_js_1.BaseItem);\n\nexports.PositionItem = PositionItem;\n\nvar CellItem = function (_super) {\n  __extends(CellItem, _super);\n\n  function CellItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(CellItem.prototype, \"kind\", {\n    get: function get() {\n      return 'cell';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CellItem.prototype, \"isClose\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return CellItem;\n}(StackItem_js_1.BaseItem);\n\nexports.CellItem = CellItem;\n\nvar MmlItem = function (_super) {\n  __extends(MmlItem, _super);\n\n  function MmlItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(MmlItem.prototype, \"isFinal\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(MmlItem.prototype, \"kind\", {\n    get: function get() {\n      return 'mml';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return MmlItem;\n}(StackItem_js_1.BaseItem);\n\nexports.MmlItem = MmlItem;\n\nvar FnItem = function (_super) {\n  __extends(FnItem, _super);\n\n  function FnItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(FnItem.prototype, \"kind\", {\n    get: function get() {\n      return 'fn';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  FnItem.prototype.checkItem = function (item) {\n    var top = this.First;\n\n    if (top) {\n      if (item.isOpen) {\n        return StackItem_js_1.BaseItem.success;\n      }\n\n      if (!item.isKind('fn')) {\n        var mml = item.First;\n\n        if (!item.isKind('mml') || !mml) {\n          return [[top, item], true];\n        }\n\n        if (NodeUtil_js_1.default.isType(mml, 'mstyle') && mml.childNodes.length && NodeUtil_js_1.default.isType(mml.childNodes[0].childNodes[0], 'mspace') || NodeUtil_js_1.default.isType(mml, 'mspace')) {\n          return [[top, item], true];\n        }\n\n        if (NodeUtil_js_1.default.isEmbellished(mml)) {\n          mml = NodeUtil_js_1.default.getCoreMO(mml);\n        }\n\n        var form = NodeUtil_js_1.default.getForm(mml);\n\n        if (form != null && [0, 0, 1, 1, 0, 1, 1, 0, 0, 0][form[2]]) {\n          return [[top, item], true];\n        }\n      }\n\n      var node = this.create('token', 'mo', {\n        texClass: MmlNode_js_1.TEXCLASS.NONE\n      }, Entities_js_1.entities.ApplyFunction);\n      return [[top, node, item], true];\n    }\n\n    return _super.prototype.checkItem.apply(this, arguments);\n  };\n\n  return FnItem;\n}(StackItem_js_1.BaseItem);\n\nexports.FnItem = FnItem;\n\nvar NotItem = function (_super) {\n  __extends(NotItem, _super);\n\n  function NotItem() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.remap = MapHandler_js_1.MapHandler.getMap('not_remap');\n    return _this;\n  }\n\n  Object.defineProperty(NotItem.prototype, \"kind\", {\n    get: function get() {\n      return 'not';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  NotItem.prototype.checkItem = function (item) {\n    var mml;\n    var c;\n    var textNode;\n\n    if (item.isKind('open') || item.isKind('left')) {\n      return StackItem_js_1.BaseItem.success;\n    }\n\n    if (item.isKind('mml') && (NodeUtil_js_1.default.isType(item.First, 'mo') || NodeUtil_js_1.default.isType(item.First, 'mi') || NodeUtil_js_1.default.isType(item.First, 'mtext'))) {\n      mml = item.First;\n      c = NodeUtil_js_1.default.getText(mml);\n\n      if (c.length === 1 && !NodeUtil_js_1.default.getProperty(mml, 'movesupsub') && NodeUtil_js_1.default.getChildren(mml).length === 1) {\n        if (this.remap.contains(c)) {\n          textNode = this.create('text', this.remap.lookup(c).char);\n          NodeUtil_js_1.default.setChild(mml, 0, textNode);\n        } else {\n          textNode = this.create('text', \"\\u0338\");\n          NodeUtil_js_1.default.appendChildren(mml, [textNode]);\n        }\n\n        return [[item], true];\n      }\n    }\n\n    textNode = this.create('text', \"\\u29F8\");\n    var mtextNode = this.create('node', 'mtext', [], {}, textNode);\n    var paddedNode = this.create('node', 'mpadded', [mtextNode], {\n      width: 0\n    });\n    mml = this.create('node', 'TeXAtom', [paddedNode], {\n      texClass: MmlNode_js_1.TEXCLASS.REL\n    });\n    return [[mml, item], true];\n  };\n\n  return NotItem;\n}(StackItem_js_1.BaseItem);\n\nexports.NotItem = NotItem;\n\nvar NonscriptItem = function (_super) {\n  __extends(NonscriptItem, _super);\n\n  function NonscriptItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(NonscriptItem.prototype, \"kind\", {\n    get: function get() {\n      return 'nonscript';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  NonscriptItem.prototype.checkItem = function (item) {\n    if (item.isKind('mml') && item.Size() === 1) {\n      var mml = item.First;\n\n      if (mml.isKind('mstyle') && mml.notParent) {\n        mml = NodeUtil_js_1.default.getChildren(NodeUtil_js_1.default.getChildren(mml)[0])[0];\n      }\n\n      if (mml.isKind('mspace')) {\n        if (mml !== item.First) {\n          var mrow = this.create('node', 'mrow', [item.Pop()]);\n          item.Push(mrow);\n        }\n\n        this.factory.configuration.addNode('nonscript', item.First);\n      }\n    }\n\n    return [[item], true];\n  };\n\n  return NonscriptItem;\n}(StackItem_js_1.BaseItem);\n\nexports.NonscriptItem = NonscriptItem;\n\nvar DotsItem = function (_super) {\n  __extends(DotsItem, _super);\n\n  function DotsItem() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(DotsItem.prototype, \"kind\", {\n    get: function get() {\n      return 'dots';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DotsItem.prototype.checkItem = function (item) {\n    if (item.isKind('open') || item.isKind('left')) {\n      return StackItem_js_1.BaseItem.success;\n    }\n\n    var dots = this.getProperty('ldots');\n    var top = item.First;\n\n    if (item.isKind('mml') && NodeUtil_js_1.default.isEmbellished(top)) {\n      var tclass = NodeUtil_js_1.default.getTexClass(NodeUtil_js_1.default.getCoreMO(top));\n\n      if (tclass === MmlNode_js_1.TEXCLASS.BIN || tclass === MmlNode_js_1.TEXCLASS.REL) {\n        dots = this.getProperty('cdots');\n      }\n    }\n\n    return [[dots, item], true];\n  };\n\n  return DotsItem;\n}(StackItem_js_1.BaseItem);\n\nexports.DotsItem = DotsItem;\n\nvar ArrayItem = function (_super) {\n  __extends(ArrayItem, _super);\n\n  function ArrayItem() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.table = [];\n    _this.row = [];\n    _this.frame = [];\n    _this.hfill = [];\n    _this.arraydef = {};\n    _this.dashed = false;\n    return _this;\n  }\n\n  Object.defineProperty(ArrayItem.prototype, \"kind\", {\n    get: function get() {\n      return 'array';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ArrayItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ArrayItem.prototype, \"copyEnv\", {\n    get: function get() {\n      return false;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ArrayItem.prototype.checkItem = function (item) {\n    if (item.isClose && !item.isKind('over')) {\n      if (item.getProperty('isEntry')) {\n        this.EndEntry();\n        this.clearEnv();\n        return StackItem_js_1.BaseItem.fail;\n      }\n\n      if (item.getProperty('isCR')) {\n        this.EndEntry();\n        this.EndRow();\n        this.clearEnv();\n        return StackItem_js_1.BaseItem.fail;\n      }\n\n      this.EndTable();\n      this.clearEnv();\n      var newItem = this.factory.create('mml', this.createMml());\n\n      if (this.getProperty('requireClose')) {\n        if (item.isKind('close')) {\n          return [[newItem], true];\n        }\n\n        throw new TexError_js_1.default('MissingCloseBrace', 'Missing close brace');\n      }\n\n      return [[newItem, item], true];\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  ArrayItem.prototype.createMml = function () {\n    var scriptlevel = this.arraydef['scriptlevel'];\n    delete this.arraydef['scriptlevel'];\n    var mml = this.create('node', 'mtable', this.table, this.arraydef);\n\n    if (scriptlevel) {\n      mml.setProperty('scriptlevel', scriptlevel);\n    }\n\n    if (this.frame.length === 4) {\n      NodeUtil_js_1.default.setAttribute(mml, 'frame', this.dashed ? 'dashed' : 'solid');\n    } else if (this.frame.length) {\n      if (this.arraydef['rowlines']) {\n        this.arraydef['rowlines'] = this.arraydef['rowlines'].replace(/none( none)+$/, 'none');\n      }\n\n      NodeUtil_js_1.default.setAttribute(mml, 'frame', '');\n      mml = this.create('node', 'menclose', [mml], {\n        notation: this.frame.join(' ')\n      });\n\n      if ((this.arraydef['columnlines'] || 'none') !== 'none' || (this.arraydef['rowlines'] || 'none') !== 'none') {\n        NodeUtil_js_1.default.setAttribute(mml, 'data-padding', 0);\n      }\n    }\n\n    if (this.getProperty('open') || this.getProperty('close')) {\n      mml = ParseUtil_js_1.default.fenced(this.factory.configuration, this.getProperty('open'), mml, this.getProperty('close'));\n    }\n\n    return mml;\n  };\n\n  ArrayItem.prototype.EndEntry = function () {\n    var mtd = this.create('node', 'mtd', this.nodes);\n\n    if (this.hfill.length) {\n      if (this.hfill[0] === 0) {\n        NodeUtil_js_1.default.setAttribute(mtd, 'columnalign', 'right');\n      }\n\n      if (this.hfill[this.hfill.length - 1] === this.Size()) {\n        NodeUtil_js_1.default.setAttribute(mtd, 'columnalign', NodeUtil_js_1.default.getAttribute(mtd, 'columnalign') ? 'center' : 'left');\n      }\n    }\n\n    this.row.push(mtd);\n    this.Clear();\n    this.hfill = [];\n  };\n\n  ArrayItem.prototype.EndRow = function () {\n    var node;\n\n    if (this.getProperty('isNumbered') && this.row.length === 3) {\n      this.row.unshift(this.row.pop());\n      node = this.create('node', 'mlabeledtr', this.row);\n    } else {\n      node = this.create('node', 'mtr', this.row);\n    }\n\n    this.table.push(node);\n    this.row = [];\n  };\n\n  ArrayItem.prototype.EndTable = function () {\n    if (this.Size() || this.row.length) {\n      this.EndEntry();\n      this.EndRow();\n    }\n\n    this.checkLines();\n  };\n\n  ArrayItem.prototype.checkLines = function () {\n    if (this.arraydef['rowlines']) {\n      var lines = this.arraydef['rowlines'].split(/ /);\n\n      if (lines.length === this.table.length) {\n        this.frame.push('bottom');\n        lines.pop();\n        this.arraydef['rowlines'] = lines.join(' ');\n      } else if (lines.length < this.table.length - 1) {\n        this.arraydef['rowlines'] += ' none';\n      }\n    }\n\n    if (this.getProperty('rowspacing')) {\n      var rows = this.arraydef['rowspacing'].split(/ /);\n\n      while (rows.length < this.table.length) {\n        rows.push(this.getProperty('rowspacing') + 'em');\n      }\n\n      this.arraydef['rowspacing'] = rows.join(' ');\n    }\n  };\n\n  ArrayItem.prototype.addRowSpacing = function (spacing) {\n    if (this.arraydef['rowspacing']) {\n      var rows = this.arraydef['rowspacing'].split(/ /);\n\n      if (!this.getProperty('rowspacing')) {\n        var dimem = ParseUtil_js_1.default.dimen2em(rows[0]);\n        this.setProperty('rowspacing', dimem);\n      }\n\n      var rowspacing = this.getProperty('rowspacing');\n\n      while (rows.length < this.table.length) {\n        rows.push(ParseUtil_js_1.default.Em(rowspacing));\n      }\n\n      rows[this.table.length - 1] = ParseUtil_js_1.default.Em(Math.max(0, rowspacing + ParseUtil_js_1.default.dimen2em(spacing)));\n      this.arraydef['rowspacing'] = rows.join(' ');\n    }\n  };\n\n  return ArrayItem;\n}(StackItem_js_1.BaseItem);\n\nexports.ArrayItem = ArrayItem;\n\nvar EqnArrayItem = function (_super) {\n  __extends(EqnArrayItem, _super);\n\n  function EqnArrayItem(factory) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    var _this = _super.call(this, factory) || this;\n\n    _this.maxrow = 0;\n\n    _this.factory.configuration.tags.start(args[0], args[2], args[1]);\n\n    return _this;\n  }\n\n  Object.defineProperty(EqnArrayItem.prototype, \"kind\", {\n    get: function get() {\n      return 'eqnarray';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  EqnArrayItem.prototype.EndEntry = function () {\n    if (this.row.length) {\n      ParseUtil_js_1.default.fixInitialMO(this.factory.configuration, this.nodes);\n    }\n\n    var node = this.create('node', 'mtd', this.nodes);\n    this.row.push(node);\n    this.Clear();\n  };\n\n  EqnArrayItem.prototype.EndRow = function () {\n    if (this.row.length > this.maxrow) {\n      this.maxrow = this.row.length;\n    }\n\n    var mtr = 'mtr';\n    var tag = this.factory.configuration.tags.getTag();\n\n    if (tag) {\n      this.row = [tag].concat(this.row);\n      mtr = 'mlabeledtr';\n    }\n\n    this.factory.configuration.tags.clearTag();\n    var node = this.create('node', mtr, this.row);\n    this.table.push(node);\n    this.row = [];\n  };\n\n  EqnArrayItem.prototype.EndTable = function () {\n    _super.prototype.EndTable.call(this);\n\n    this.factory.configuration.tags.end();\n    this.extendArray('columnalign', this.maxrow);\n    this.extendArray('columnwidth', this.maxrow);\n    this.extendArray('columnspacing', this.maxrow - 1);\n  };\n\n  EqnArrayItem.prototype.extendArray = function (name, max) {\n    if (!this.arraydef[name]) return;\n    var repeat = this.arraydef[name].split(/ /);\n\n    var columns = __spreadArray([], __read(repeat), false);\n\n    if (columns.length > 1) {\n      while (columns.length < max) {\n        columns.push.apply(columns, __spreadArray([], __read(repeat), false));\n      }\n\n      this.arraydef[name] = columns.slice(0, max).join(' ');\n    }\n  };\n\n  return EqnArrayItem;\n}(ArrayItem);\n\nexports.EqnArrayItem = EqnArrayItem;\n\nvar EquationItem = function (_super) {\n  __extends(EquationItem, _super);\n\n  function EquationItem(factory) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    var _this = _super.call(this, factory) || this;\n\n    _this.factory.configuration.tags.start('equation', true, args[0]);\n\n    return _this;\n  }\n\n  Object.defineProperty(EquationItem.prototype, \"kind\", {\n    get: function get() {\n      return 'equation';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(EquationItem.prototype, \"isOpen\", {\n    get: function get() {\n      return true;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  EquationItem.prototype.checkItem = function (item) {\n    if (item.isKind('end')) {\n      var mml = this.toMml();\n      var tag = this.factory.configuration.tags.getTag();\n      this.factory.configuration.tags.end();\n      return [[tag ? this.factory.configuration.tags.enTag(mml, tag) : mml, item], true];\n    }\n\n    if (item.isKind('stop')) {\n      throw new TexError_js_1.default('EnvMissingEnd', 'Missing \\\\end{%1}', this.getName());\n    }\n\n    return _super.prototype.checkItem.call(this, item);\n  };\n\n  return EquationItem;\n}(StackItem_js_1.BaseItem);\n\nexports.EquationItem = EquationItem;","map":{"version":3,"mappings":"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","names":["__extends","factory","global","_super","_this","Object","StartItem","item","isKind","node","toMml","isInner","configuration","tags","finalize","env","create","checkItem","call","StackItem_js_1","exports","StopItem","OpenItem","mml","assign","errors","CloseItem","PrimeItem","Peek","top0","top1","NodeUtil_js_1","isType","setChild","sup","SubsupItem","success","top","First","position","getProperty","setProperty","result","error","getErrors","TexError_js_1","bind","apply","__spreadArray","__read","splice","OverItem","getName","isClose","setAttribute","ParseUtil_js_1","fixedFence","nodes","join","delim","LeftItem","fenced","def","stretchy","mathcolor","Push","texClass","MmlNode_js_1","CLOSE","OPEN","color","Middle","RightItem","BeginItem","fail","EndItem","StyleItem","PositionItem","isFinal","height","depth","voffset","CellItem","MmlItem","FnItem","isOpen","childNodes","length","isEmbellished","getCoreMO","form","getForm","NONE","Entities_js_1","ApplyFunction","arguments","MapHandler_js_1","getMap","NotItem","c","textNode","getText","getChildren","remap","contains","lookup","char","appendChildren","mtextNode","paddedNode","width","REL","NonscriptItem","Size","notParent","mrow","Pop","addNode","DotsItem","dots","tclass","getTexClass","BIN","ArrayItem","EndEntry","clearEnv","EndRow","EndTable","newItem","createMml","scriptlevel","arraydef","table","frame","dashed","replace","notation","mtd","hfill","getAttribute","row","push","Clear","unshift","pop","checkLines","lines","split","rows","spacing","dimem","dimen2em","rowspacing","Em","Math","max","args","start","EqnArrayItem","fixInitialMO","maxrow","mtr","tag","getTag","concat","clearTag","end","extendArray","name","repeat","columns","slice","EquationItem","enTag"],"sourceRoot":"","sources":["../../../../ts/input/tex/base/BaseItems.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}