{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommonWrapper = void 0;\n\nvar Wrapper_js_1 = require(\"../../core/Tree/Wrapper.js\");\n\nvar MmlNode_js_1 = require(\"../../core/MmlTree/MmlNode.js\");\n\nvar string_js_1 = require(\"../../util/string.js\");\n\nvar LENGTHS = __importStar(require(\"../../util/lengths.js\"));\n\nvar Styles_js_1 = require(\"../../util/Styles.js\");\n\nvar BBox_js_1 = require(\"../../util/BBox.js\");\n\nvar FontData_js_1 = require(\"./FontData.js\");\n\nvar SMALLSIZE = 2 / 18;\n\nfunction MathMLSpace(script, size) {\n  return script ? size < SMALLSIZE ? 0 : SMALLSIZE : size;\n}\n\nvar CommonWrapper = function (_super) {\n  __extends(CommonWrapper, _super);\n\n  function CommonWrapper(factory, node, parent) {\n    if (parent === void 0) {\n      parent = null;\n    }\n\n    var _this = _super.call(this, factory, node) || this;\n\n    _this.parent = null;\n    _this.removedStyles = null;\n    _this.styles = null;\n    _this.variant = '';\n    _this.bboxComputed = false;\n    _this.stretch = FontData_js_1.NOSTRETCH;\n    _this.font = null;\n    _this.parent = parent;\n    _this.font = factory.jax.font;\n    _this.bbox = BBox_js_1.BBox.zero();\n\n    _this.getStyles();\n\n    _this.getVariant();\n\n    _this.getScale();\n\n    _this.getSpace();\n\n    _this.childNodes = node.childNodes.map(function (child) {\n      var wrapped = _this.wrap(child);\n\n      if (wrapped.bbox.pwidth && (node.notParent || node.isKind('math'))) {\n        _this.bbox.pwidth = BBox_js_1.BBox.fullWidth;\n      }\n\n      return wrapped;\n    });\n    return _this;\n  }\n\n  Object.defineProperty(CommonWrapper.prototype, \"jax\", {\n    get: function get() {\n      return this.factory.jax;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CommonWrapper.prototype, \"adaptor\", {\n    get: function get() {\n      return this.factory.jax.adaptor;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CommonWrapper.prototype, \"metrics\", {\n    get: function get() {\n      return this.factory.jax.math.metrics;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(CommonWrapper.prototype, \"fixesPWidth\", {\n    get: function get() {\n      return !this.node.notParent && !this.node.isToken;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  CommonWrapper.prototype.wrap = function (node, parent) {\n    if (parent === void 0) {\n      parent = null;\n    }\n\n    var wrapped = this.factory.wrap(node, parent || this);\n\n    if (parent) {\n      parent.childNodes.push(wrapped);\n    }\n\n    this.jax.nodeMap.set(node, wrapped);\n    return wrapped;\n  };\n\n  CommonWrapper.prototype.getBBox = function (save) {\n    if (save === void 0) {\n      save = true;\n    }\n\n    if (this.bboxComputed) {\n      return this.bbox;\n    }\n\n    var bbox = save ? this.bbox : BBox_js_1.BBox.zero();\n    this.computeBBox(bbox);\n    this.bboxComputed = save;\n    return bbox;\n  };\n\n  CommonWrapper.prototype.getOuterBBox = function (save) {\n    var e_1, _a;\n\n    if (save === void 0) {\n      save = true;\n    }\n\n    var bbox = this.getBBox(save);\n    if (!this.styles) return bbox;\n    var obox = new BBox_js_1.BBox();\n    Object.assign(obox, bbox);\n\n    try {\n      for (var _b = __values(BBox_js_1.BBox.StyleAdjust), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var _d = __read(_c.value, 2),\n            name_1 = _d[0],\n            side = _d[1];\n\n        var x = this.styles.get(name_1);\n\n        if (x) {\n          obox[side] += this.length2em(x, 1, obox.rscale);\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    return obox;\n  };\n\n  CommonWrapper.prototype.computeBBox = function (bbox, recompute) {\n    var e_2, _a;\n\n    if (recompute === void 0) {\n      recompute = false;\n    }\n\n    bbox.empty();\n\n    try {\n      for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var child = _c.value;\n        bbox.append(child.getOuterBBox());\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    bbox.clean();\n\n    if (this.fixesPWidth && this.setChildPWidths(recompute)) {\n      this.computeBBox(bbox, true);\n    }\n  };\n\n  CommonWrapper.prototype.setChildPWidths = function (recompute, w, clear) {\n    var e_3, _a;\n\n    if (w === void 0) {\n      w = null;\n    }\n\n    if (clear === void 0) {\n      clear = true;\n    }\n\n    if (recompute) {\n      return false;\n    }\n\n    if (clear) {\n      this.bbox.pwidth = '';\n    }\n\n    var changed = false;\n\n    try {\n      for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var child = _c.value;\n        var cbox = child.getOuterBBox();\n\n        if (cbox.pwidth && child.setChildPWidths(recompute, w === null ? cbox.w : w, clear)) {\n          changed = true;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return changed;\n  };\n\n  CommonWrapper.prototype.invalidateBBox = function () {\n    if (this.bboxComputed) {\n      this.bboxComputed = false;\n\n      if (this.parent) {\n        this.parent.invalidateBBox();\n      }\n    }\n  };\n\n  CommonWrapper.prototype.copySkewIC = function (bbox) {\n    var first = this.childNodes[0];\n\n    if (first === null || first === void 0 ? void 0 : first.bbox.sk) {\n      bbox.sk = first.bbox.sk;\n    }\n\n    if (first === null || first === void 0 ? void 0 : first.bbox.dx) {\n      bbox.dx = first.bbox.dx;\n    }\n\n    var last = this.childNodes[this.childNodes.length - 1];\n\n    if (last === null || last === void 0 ? void 0 : last.bbox.ic) {\n      bbox.ic = last.bbox.ic;\n      bbox.w += bbox.ic;\n    }\n  };\n\n  CommonWrapper.prototype.getStyles = function () {\n    var styleString = this.node.attributes.getExplicit('style');\n    if (!styleString) return;\n    var style = this.styles = new Styles_js_1.Styles(styleString);\n\n    for (var i = 0, m = CommonWrapper.removeStyles.length; i < m; i++) {\n      var id = CommonWrapper.removeStyles[i];\n\n      if (style.get(id)) {\n        if (!this.removedStyles) this.removedStyles = {};\n        this.removedStyles[id] = style.get(id);\n        style.set(id, '');\n      }\n    }\n  };\n\n  CommonWrapper.prototype.getVariant = function () {\n    if (!this.node.isToken) return;\n    var attributes = this.node.attributes;\n    var variant = attributes.get('mathvariant');\n\n    if (!attributes.getExplicit('mathvariant')) {\n      var values = attributes.getList('fontfamily', 'fontweight', 'fontstyle');\n\n      if (this.removedStyles) {\n        var style = this.removedStyles;\n        if (style.fontFamily) values.family = style.fontFamily;\n        if (style.fontWeight) values.weight = style.fontWeight;\n        if (style.fontStyle) values.style = style.fontStyle;\n      }\n\n      if (values.fontfamily) values.family = values.fontfamily;\n      if (values.fontweight) values.weight = values.fontweight;\n      if (values.fontstyle) values.style = values.fontstyle;\n\n      if (values.weight && values.weight.match(/^\\d+$/)) {\n        values.weight = parseInt(values.weight) > 600 ? 'bold' : 'normal';\n      }\n\n      if (values.family) {\n        variant = this.explicitVariant(values.family, values.weight, values.style);\n      } else {\n        if (this.node.getProperty('variantForm')) variant = '-tex-variant';\n        variant = (CommonWrapper.BOLDVARIANTS[values.weight] || {})[variant] || variant;\n        variant = (CommonWrapper.ITALICVARIANTS[values.style] || {})[variant] || variant;\n      }\n    }\n\n    this.variant = variant;\n  };\n\n  CommonWrapper.prototype.explicitVariant = function (fontFamily, fontWeight, fontStyle) {\n    var style = this.styles;\n    if (!style) style = this.styles = new Styles_js_1.Styles();\n    style.set('fontFamily', fontFamily);\n    if (fontWeight) style.set('fontWeight', fontWeight);\n    if (fontStyle) style.set('fontStyle', fontStyle);\n    return '-explicitFont';\n  };\n\n  CommonWrapper.prototype.getScale = function () {\n    var scale = 1,\n        parent = this.parent;\n    var pscale = parent ? parent.bbox.scale : 1;\n    var attributes = this.node.attributes;\n    var scriptlevel = Math.min(attributes.get('scriptlevel'), 2);\n    var fontsize = attributes.get('fontsize');\n    var mathsize = this.node.isToken || this.node.isKind('mstyle') ? attributes.get('mathsize') : attributes.getInherited('mathsize');\n\n    if (scriptlevel !== 0) {\n      scale = Math.pow(attributes.get('scriptsizemultiplier'), scriptlevel);\n      var scriptminsize = this.length2em(attributes.get('scriptminsize'), .8, 1);\n      if (scale < scriptminsize) scale = scriptminsize;\n    }\n\n    if (this.removedStyles && this.removedStyles.fontSize && !fontsize) {\n      fontsize = this.removedStyles.fontSize;\n    }\n\n    if (fontsize && !attributes.getExplicit('mathsize')) {\n      mathsize = fontsize;\n    }\n\n    if (mathsize !== '1') {\n      scale *= this.length2em(mathsize, 1, 1);\n    }\n\n    this.bbox.scale = scale;\n    this.bbox.rscale = scale / pscale;\n  };\n\n  CommonWrapper.prototype.getSpace = function () {\n    var isTop = this.isTopEmbellished();\n    var hasSpacing = this.node.hasSpacingAttributes();\n\n    if (this.jax.options.mathmlSpacing || hasSpacing) {\n      isTop && this.getMathMLSpacing();\n    } else {\n      this.getTeXSpacing(isTop, hasSpacing);\n    }\n  };\n\n  CommonWrapper.prototype.getMathMLSpacing = function () {\n    var node = this.node.coreMO();\n    var child = node.coreParent();\n    var parent = child.parent;\n    if (!parent || !parent.isKind('mrow') || parent.childNodes.length === 1) return;\n    var attributes = node.attributes;\n    var isScript = attributes.get('scriptlevel') > 0;\n    this.bbox.L = attributes.isSet('lspace') ? Math.max(0, this.length2em(attributes.get('lspace'))) : MathMLSpace(isScript, node.lspace);\n    this.bbox.R = attributes.isSet('rspace') ? Math.max(0, this.length2em(attributes.get('rspace'))) : MathMLSpace(isScript, node.rspace);\n    var n = parent.childIndex(child);\n    if (n === 0) return;\n    var prev = parent.childNodes[n - 1];\n    if (!prev.isEmbellished) return;\n    var bbox = this.jax.nodeMap.get(prev).getBBox();\n\n    if (bbox.R) {\n      this.bbox.L = Math.max(0, this.bbox.L - bbox.R);\n    }\n  };\n\n  CommonWrapper.prototype.getTeXSpacing = function (isTop, hasSpacing) {\n    if (!hasSpacing) {\n      var space = this.node.texSpacing();\n\n      if (space) {\n        this.bbox.L = this.length2em(space);\n      }\n    }\n\n    if (isTop || hasSpacing) {\n      var attributes = this.node.coreMO().attributes;\n\n      if (attributes.isSet('lspace')) {\n        this.bbox.L = Math.max(0, this.length2em(attributes.get('lspace')));\n      }\n\n      if (attributes.isSet('rspace')) {\n        this.bbox.R = Math.max(0, this.length2em(attributes.get('rspace')));\n      }\n    }\n  };\n\n  CommonWrapper.prototype.isTopEmbellished = function () {\n    return this.node.isEmbellished && !(this.node.parent && this.node.parent.isEmbellished);\n  };\n\n  CommonWrapper.prototype.core = function () {\n    return this.jax.nodeMap.get(this.node.core());\n  };\n\n  CommonWrapper.prototype.coreMO = function () {\n    return this.jax.nodeMap.get(this.node.coreMO());\n  };\n\n  CommonWrapper.prototype.getText = function () {\n    var e_4, _a;\n\n    var text = '';\n\n    if (this.node.isToken) {\n      try {\n        for (var _b = __values(this.node.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n\n          if (child instanceof MmlNode_js_1.TextNode) {\n            text += child.getText();\n          }\n        }\n      } catch (e_4_1) {\n        e_4 = {\n          error: e_4_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_4) throw e_4.error;\n        }\n      }\n    }\n\n    return text;\n  };\n\n  CommonWrapper.prototype.canStretch = function (direction) {\n    this.stretch = FontData_js_1.NOSTRETCH;\n\n    if (this.node.isEmbellished) {\n      var core = this.core();\n\n      if (core && core.node !== this.node) {\n        if (core.canStretch(direction)) {\n          this.stretch = core.stretch;\n        }\n      }\n    }\n\n    return this.stretch.dir !== 0;\n  };\n\n  CommonWrapper.prototype.getAlignShift = function () {\n    var _a;\n\n    var _b = (_a = this.node.attributes).getList.apply(_a, __spreadArray([], __read(MmlNode_js_1.indentAttributes), false)),\n        indentalign = _b.indentalign,\n        indentshift = _b.indentshift,\n        indentalignfirst = _b.indentalignfirst,\n        indentshiftfirst = _b.indentshiftfirst;\n\n    if (indentalignfirst !== 'indentalign') {\n      indentalign = indentalignfirst;\n    }\n\n    if (indentalign === 'auto') {\n      indentalign = this.jax.options.displayAlign;\n    }\n\n    if (indentshiftfirst !== 'indentshift') {\n      indentshift = indentshiftfirst;\n    }\n\n    if (indentshift === 'auto') {\n      indentshift = this.jax.options.displayIndent;\n\n      if (indentalign === 'right' && !indentshift.match(/^\\s*0[a-z]*\\s*$/)) {\n        indentshift = ('-' + indentshift.trim()).replace(/^--/, '');\n      }\n    }\n\n    var shift = this.length2em(indentshift, this.metrics.containerWidth);\n    return [indentalign, shift];\n  };\n\n  CommonWrapper.prototype.getAlignX = function (W, bbox, align) {\n    return align === 'right' ? W - (bbox.w + bbox.R) * bbox.rscale : align === 'left' ? bbox.L * bbox.rscale : (W - bbox.w * bbox.rscale) / 2;\n  };\n\n  CommonWrapper.prototype.getAlignY = function (H, D, h, d, align) {\n    return align === 'top' ? H - h : align === 'bottom' ? d - D : align === 'center' ? (H - h - (D - d)) / 2 : 0;\n  };\n\n  CommonWrapper.prototype.getWrapWidth = function (i) {\n    return this.childNodes[i].getBBox().w;\n  };\n\n  CommonWrapper.prototype.getChildAlign = function (_i) {\n    return 'left';\n  };\n\n  CommonWrapper.prototype.percent = function (m) {\n    return LENGTHS.percent(m);\n  };\n\n  CommonWrapper.prototype.em = function (m) {\n    return LENGTHS.em(m);\n  };\n\n  CommonWrapper.prototype.px = function (m, M) {\n    if (M === void 0) {\n      M = -LENGTHS.BIGDIMEN;\n    }\n\n    return LENGTHS.px(m, M, this.metrics.em);\n  };\n\n  CommonWrapper.prototype.length2em = function (length, size, scale) {\n    if (size === void 0) {\n      size = 1;\n    }\n\n    if (scale === void 0) {\n      scale = null;\n    }\n\n    if (scale === null) {\n      scale = this.bbox.scale;\n    }\n\n    return LENGTHS.length2em(length, size, scale, this.jax.pxPerEm);\n  };\n\n  CommonWrapper.prototype.unicodeChars = function (text, name) {\n    if (name === void 0) {\n      name = this.variant;\n    }\n\n    var chars = (0, string_js_1.unicodeChars)(text);\n    var variant = this.font.getVariant(name);\n\n    if (variant && variant.chars) {\n      var map_1 = variant.chars;\n      chars = chars.map(function (n) {\n        return ((map_1[n] || [])[3] || {}).smp || n;\n      });\n    }\n\n    return chars;\n  };\n\n  CommonWrapper.prototype.remapChars = function (chars) {\n    return chars;\n  };\n\n  CommonWrapper.prototype.mmlText = function (text) {\n    return this.node.factory.create('text').setText(text);\n  };\n\n  CommonWrapper.prototype.mmlNode = function (kind, properties, children) {\n    if (properties === void 0) {\n      properties = {};\n    }\n\n    if (children === void 0) {\n      children = [];\n    }\n\n    return this.node.factory.create(kind, properties, children);\n  };\n\n  CommonWrapper.prototype.createMo = function (text) {\n    var mmlFactory = this.node.factory;\n    var textNode = mmlFactory.create('text').setText(text);\n    var mml = mmlFactory.create('mo', {\n      stretchy: true\n    }, [textNode]);\n    mml.inheritAttributesFrom(this.node);\n    var node = this.wrap(mml);\n    node.parent = this;\n    return node;\n  };\n\n  CommonWrapper.prototype.getVariantChar = function (variant, n) {\n    var char = this.font.getChar(variant, n) || [0, 0, 0, {\n      unknown: true\n    }];\n\n    if (char.length === 3) {\n      char[3] = {};\n    }\n\n    return char;\n  };\n\n  CommonWrapper.kind = 'unknown';\n  CommonWrapper.styles = {};\n  CommonWrapper.removeStyles = ['fontSize', 'fontFamily', 'fontWeight', 'fontStyle', 'fontVariant', 'font'];\n  CommonWrapper.skipAttributes = {\n    fontfamily: true,\n    fontsize: true,\n    fontweight: true,\n    fontstyle: true,\n    color: true,\n    background: true,\n    'class': true,\n    href: true,\n    style: true,\n    xmlns: true\n  };\n  CommonWrapper.BOLDVARIANTS = {\n    bold: {\n      normal: 'bold',\n      italic: 'bold-italic',\n      fraktur: 'bold-fraktur',\n      script: 'bold-script',\n      'sans-serif': 'bold-sans-serif',\n      'sans-serif-italic': 'sans-serif-bold-italic'\n    },\n    normal: {\n      bold: 'normal',\n      'bold-italic': 'italic',\n      'bold-fraktur': 'fraktur',\n      'bold-script': 'script',\n      'bold-sans-serif': 'sans-serif',\n      'sans-serif-bold-italic': 'sans-serif-italic'\n    }\n  };\n  CommonWrapper.ITALICVARIANTS = {\n    italic: {\n      normal: 'italic',\n      bold: 'bold-italic',\n      'sans-serif': 'sans-serif-italic',\n      'bold-sans-serif': 'sans-serif-bold-italic'\n    },\n    normal: {\n      italic: 'normal',\n      'bold-italic': 'bold',\n      'sans-serif-italic': 'sans-serif',\n      'sans-serif-bold-italic': 'bold-sans-serif'\n    }\n  };\n  return CommonWrapper;\n}(Wrapper_js_1.AbstractWrapper);\n\nexports.CommonWrapper = CommonWrapper;","map":{"version":3,"mappings":"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","names":["SMALLSIZE","MathMLSpace","script","size","__extends","factory","node","parent","_super","_this","FontData_js_1","font","jax","bbox","BBox_js_1","zero","getStyles","getVariant","getScale","getSpace","childNodes","map","child","wrapped","wrap","pwidth","notParent","isKind","fullWidth","Object","CommonWrapper","adaptor","math","metrics","isToken","push","nodeMap","set","save","bboxComputed","computeBBox","getBBox","styles","obox","assign","StyleAdjust","_c","name_1","side","x","get","length2em","rscale","recompute","empty","append","getOuterBBox","clean","fixesPWidth","setChildPWidths","w","clear","changed","cbox","invalidateBBox","first","sk","dx","last","length","ic","styleString","attributes","getExplicit","style","Styles_js_1","i","m","removeStyles","id","removedStyles","variant","values","getList","fontFamily","family","fontWeight","weight","fontStyle","fontfamily","fontweight","fontstyle","match","parseInt","explicitVariant","getProperty","BOLDVARIANTS","ITALICVARIANTS","scale","pscale","scriptlevel","Math","min","fontsize","mathsize","getInherited","pow","scriptminsize","fontSize","isTop","isTopEmbellished","hasSpacing","hasSpacingAttributes","options","mathmlSpacing","getMathMLSpacing","getTeXSpacing","coreMO","coreParent","isScript","L","isSet","max","lspace","R","rspace","n","childIndex","prev","isEmbellished","space","texSpacing","core","text","MmlNode_js_1","getText","direction","stretch","canStretch","dir","apply","_a","__spreadArray","indentalign","indentshift","indentalignfirst","indentshiftfirst","displayAlign","displayIndent","trim","replace","shift","containerWidth","W","align","H","D","h","d","_i","LENGTHS","percent","em","M","BIGDIMEN","px","pxPerEm","name","chars","map_1","smp","create","setText","kind","properties","children","mmlFactory","textNode","mml","stretchy","inheritAttributesFrom","char","getChar","unknown","color","background","href","xmlns","bold","normal","italic","fraktur","Wrapper_js_1","exports"],"sourceRoot":"","sources":["../../../ts/output/common/Wrapper.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}