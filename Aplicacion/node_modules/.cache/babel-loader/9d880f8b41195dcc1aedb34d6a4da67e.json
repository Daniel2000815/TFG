{"ast":null,"code":"\"use strict\";\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SubHandlers = exports.SubHandler = exports.MapHandler = void 0;\n\nvar PrioritizedList_js_1 = require(\"../../util/PrioritizedList.js\");\n\nvar FunctionList_js_1 = require(\"../../util/FunctionList.js\");\n\nvar MapHandler;\n\n(function (MapHandler) {\n  var maps = new Map();\n\n  MapHandler.register = function (map) {\n    maps.set(map.name, map);\n  };\n\n  MapHandler.getMap = function (name) {\n    return maps.get(name);\n  };\n})(MapHandler = exports.MapHandler || (exports.MapHandler = {}));\n\nvar SubHandler = function () {\n  function SubHandler() {\n    this._configuration = new PrioritizedList_js_1.PrioritizedList();\n    this._fallback = new FunctionList_js_1.FunctionList();\n  }\n\n  SubHandler.prototype.add = function (maps, fallback, priority) {\n    var e_1, _a;\n\n    if (priority === void 0) {\n      priority = PrioritizedList_js_1.PrioritizedList.DEFAULTPRIORITY;\n    }\n\n    try {\n      for (var _b = __values(maps.slice().reverse()), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var name_1 = _c.value;\n        var map = MapHandler.getMap(name_1);\n\n        if (!map) {\n          this.warn('Configuration ' + name_1 + ' not found! Omitted.');\n          return;\n        }\n\n        this._configuration.add(map, priority);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n\n    if (fallback) {\n      this._fallback.add(fallback, priority);\n    }\n  };\n\n  SubHandler.prototype.parse = function (input) {\n    var e_2, _a;\n\n    try {\n      for (var _b = __values(this._configuration), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var map = _c.value.item;\n        var result = map.parse(input);\n\n        if (result) {\n          return result;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var _d = __read(input, 2),\n        env = _d[0],\n        symbol = _d[1];\n\n    Array.from(this._fallback)[0].item(env, symbol);\n  };\n\n  SubHandler.prototype.lookup = function (symbol) {\n    var map = this.applicable(symbol);\n    return map ? map.lookup(symbol) : null;\n  };\n\n  SubHandler.prototype.contains = function (symbol) {\n    return this.applicable(symbol) ? true : false;\n  };\n\n  SubHandler.prototype.toString = function () {\n    var e_3, _a;\n\n    var names = [];\n\n    try {\n      for (var _b = __values(this._configuration), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var map = _c.value.item;\n        names.push(map.name);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return names.join(', ');\n  };\n\n  SubHandler.prototype.applicable = function (symbol) {\n    var e_4, _a;\n\n    try {\n      for (var _b = __values(this._configuration), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var map = _c.value.item;\n\n        if (map.contains(symbol)) {\n          return map;\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    return null;\n  };\n\n  SubHandler.prototype.retrieve = function (name) {\n    var e_5, _a;\n\n    try {\n      for (var _b = __values(this._configuration), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var map = _c.value.item;\n\n        if (map.name === name) {\n          return map;\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    return null;\n  };\n\n  SubHandler.prototype.warn = function (message) {\n    console.log('TexParser Warning: ' + message);\n  };\n\n  return SubHandler;\n}();\n\nexports.SubHandler = SubHandler;\n\nvar SubHandlers = function () {\n  function SubHandlers() {\n    this.map = new Map();\n  }\n\n  SubHandlers.prototype.add = function (handlers, fallbacks, priority) {\n    var e_6, _a;\n\n    if (priority === void 0) {\n      priority = PrioritizedList_js_1.PrioritizedList.DEFAULTPRIORITY;\n    }\n\n    try {\n      for (var _b = __values(Object.keys(handlers)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var key = _c.value;\n        var name_2 = key;\n        var subHandler = this.get(name_2);\n\n        if (!subHandler) {\n          subHandler = new SubHandler();\n          this.set(name_2, subHandler);\n        }\n\n        subHandler.add(handlers[name_2], fallbacks[name_2], priority);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n  };\n\n  SubHandlers.prototype.set = function (name, subHandler) {\n    this.map.set(name, subHandler);\n  };\n\n  SubHandlers.prototype.get = function (name) {\n    return this.map.get(name);\n  };\n\n  SubHandlers.prototype.retrieve = function (name) {\n    var e_7, _a;\n\n    try {\n      for (var _b = __values(this.map.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var handler = _c.value;\n        var map = handler.retrieve(name);\n\n        if (map) {\n          return map;\n        }\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    return null;\n  };\n\n  SubHandlers.prototype.keys = function () {\n    return this.map.keys();\n  };\n\n  return SubHandlers;\n}();\n\nexports.SubHandlers = SubHandlers;","map":{"version":3,"mappings":"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","names":["MapHandler","maps","Map","map","set","name","get","exports","PrioritizedList_js_1","FunctionList_js_1","SubHandler","fallback","priority","DEFAULTPRIORITY","slice","reverse","_c","name_1","getMap","warn","_configuration","add","_fallback","input","result","parse","env","symbol","Array","from","item","applicable","lookup","names","push","join","contains","message","console","log","SubHandlers","handlers","fallbacks","keys","key","name_2","subHandler","values","handler","retrieve"],"sourceRoot":"","sources":["../../../ts/input/tex/MapHandler.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}