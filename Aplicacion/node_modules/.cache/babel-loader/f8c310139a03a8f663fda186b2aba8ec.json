{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SVGWrapper = void 0;\n\nvar BBox_js_1 = require(\"../../util/BBox.js\");\n\nvar Wrapper_js_1 = require(\"../common/Wrapper.js\");\n\nvar svg_js_1 = require(\"../svg.js\");\n\nvar SVGWrapper = function (_super) {\n  __extends(SVGWrapper, _super);\n\n  function SVGWrapper() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.element = null;\n    _this.dx = 0;\n    return _this;\n  }\n\n  SVGWrapper.prototype.toSVG = function (parent) {\n    this.addChildren(this.standardSVGnode(parent));\n  };\n\n  SVGWrapper.prototype.addChildren = function (parent) {\n    var e_1, _a;\n\n    var x = 0;\n\n    try {\n      for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var child = _c.value;\n        child.toSVG(parent);\n        var bbox = child.getOuterBBox();\n\n        if (child.element) {\n          child.place(x + bbox.L * bbox.rscale, 0);\n        }\n\n        x += (bbox.L + bbox.w + bbox.R) * bbox.rscale;\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  SVGWrapper.prototype.standardSVGnode = function (parent) {\n    var svg = this.createSVGnode(parent);\n    this.handleStyles();\n    this.handleScale();\n    this.handleBorder();\n    this.handleColor();\n    this.handleAttributes();\n    return svg;\n  };\n\n  SVGWrapper.prototype.createSVGnode = function (parent) {\n    this.element = this.svg('g', {\n      'data-mml-node': this.node.kind\n    });\n    var href = this.node.attributes.get('href');\n\n    if (href) {\n      parent = this.adaptor.append(parent, this.svg('a', {\n        href: href\n      }));\n\n      var _a = this.getOuterBBox(),\n          h = _a.h,\n          d = _a.d,\n          w = _a.w;\n\n      this.adaptor.append(this.element, this.svg('rect', {\n        'data-hitbox': true,\n        fill: 'none',\n        stroke: 'none',\n        'pointer-events': 'all',\n        width: this.fixed(w),\n        height: this.fixed(h + d),\n        y: this.fixed(-d)\n      }));\n    }\n\n    this.adaptor.append(parent, this.element);\n    return this.element;\n  };\n\n  SVGWrapper.prototype.handleStyles = function () {\n    var _this = this;\n\n    if (!this.styles) return;\n    var styles = this.styles.cssText;\n\n    if (styles) {\n      this.adaptor.setAttribute(this.element, 'style', styles);\n    }\n\n    BBox_js_1.BBox.StyleAdjust.forEach(function (_a) {\n      var _b = __read(_a, 3),\n          name = _b[0],\n          lr = _b[2];\n\n      if (lr !== 0) return;\n\n      var x = _this.styles.get(name);\n\n      if (x) {\n        _this.dx += _this.length2em(x, 1, _this.bbox.rscale);\n      }\n    });\n  };\n\n  SVGWrapper.prototype.handleScale = function () {\n    if (this.bbox.rscale !== 1) {\n      var scale = 'scale(' + this.fixed(this.bbox.rscale / 1000, 3) + ')';\n      this.adaptor.setAttribute(this.element, 'transform', scale);\n    }\n  };\n\n  SVGWrapper.prototype.handleColor = function () {\n    var _a;\n\n    var adaptor = this.adaptor;\n    var attributes = this.node.attributes;\n    var mathcolor = attributes.getExplicit('mathcolor');\n    var color = attributes.getExplicit('color');\n    var mathbackground = attributes.getExplicit('mathbackground');\n    var background = attributes.getExplicit('background');\n    var bgcolor = ((_a = this.styles) === null || _a === void 0 ? void 0 : _a.get('background-color')) || '';\n\n    if (mathcolor || color) {\n      adaptor.setAttribute(this.element, 'fill', mathcolor || color);\n      adaptor.setAttribute(this.element, 'stroke', mathcolor || color);\n    }\n\n    if (mathbackground || background || bgcolor) {\n      var _b = this.getOuterBBox(),\n          h = _b.h,\n          d = _b.d,\n          w = _b.w;\n\n      var rect = this.svg('rect', {\n        fill: mathbackground || background || bgcolor,\n        x: this.fixed(-this.dx),\n        y: this.fixed(-d),\n        width: this.fixed(w),\n        height: this.fixed(h + d),\n        'data-bgcolor': true\n      });\n      var child = adaptor.firstChild(this.element);\n\n      if (child) {\n        adaptor.insert(rect, child);\n      } else {\n        adaptor.append(this.element, rect);\n      }\n    }\n  };\n\n  SVGWrapper.prototype.handleBorder = function () {\n    var e_2, _a, e_3, _b;\n\n    if (!this.styles) return;\n    var width = Array(4).fill(0);\n    var style = Array(4);\n    var color = Array(4);\n\n    try {\n      for (var _c = __values([['Top', 0], ['Right', 1], ['Bottom', 2], ['Left', 3]]), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var _e = __read(_d.value, 2),\n            name_1 = _e[0],\n            i = _e[1];\n\n        var key = 'border' + name_1;\n        var w_1 = this.styles.get(key + 'Width');\n        if (!w_1) continue;\n        width[i] = Math.max(0, this.length2em(w_1, 1, this.bbox.rscale));\n        style[i] = this.styles.get(key + 'Style') || 'solid';\n        color[i] = this.styles.get(key + 'Color') || 'currentColor';\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var f = SVGWrapper.borderFuzz;\n    var bbox = this.getOuterBBox();\n\n    var _f = __read([bbox.h + f, bbox.d + f, bbox.w + f], 3),\n        h = _f[0],\n        d = _f[1],\n        w = _f[2];\n\n    var outerRT = [w, h];\n    var outerLT = [-f, h];\n    var outerRB = [w, -d];\n    var outerLB = [-f, -d];\n    var innerRT = [w - width[1], h - width[0]];\n    var innerLT = [-f + width[3], h - width[0]];\n    var innerRB = [w - width[1], -d + width[2]];\n    var innerLB = [-f + width[3], -d + width[2]];\n    var paths = [[outerLT, outerRT, innerRT, innerLT], [outerRB, outerRT, innerRT, innerRB], [outerLB, outerRB, innerRB, innerLB], [outerLB, outerLT, innerLT, innerLB]];\n    var adaptor = this.adaptor;\n    var child = adaptor.firstChild(this.element);\n\n    try {\n      for (var _g = __values([0, 1, 2, 3]), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var i = _h.value;\n        if (!width[i]) continue;\n        var path = paths[i];\n\n        if (style[i] === 'dashed' || style[i] === 'dotted') {\n          this.addBorderBroken(path, color[i], style[i], width[i], i);\n        } else {\n          this.addBorderSolid(path, color[i], child);\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n  };\n\n  SVGWrapper.prototype.addBorderSolid = function (path, color, child) {\n    var _this = this;\n\n    var border = this.svg('polygon', {\n      points: path.map(function (_a) {\n        var _b = __read(_a, 2),\n            x = _b[0],\n            y = _b[1];\n\n        return \"\".concat(_this.fixed(x - _this.dx), \",\").concat(_this.fixed(y));\n      }).join(' '),\n      stroke: 'none',\n      fill: color\n    });\n\n    if (child) {\n      this.adaptor.insert(border, child);\n    } else {\n      this.adaptor.append(this.element, border);\n    }\n  };\n\n  SVGWrapper.prototype.addBorderBroken = function (path, color, style, t, i) {\n    var dot = style === 'dotted';\n    var t2 = t / 2;\n\n    var _a = __read([[t2, -t2, -t2, -t2], [-t2, t2, -t2, -t2], [t2, t2, -t2, t2], [t2, t2, t2, -t2]][i], 4),\n        tx1 = _a[0],\n        ty1 = _a[1],\n        tx2 = _a[2],\n        ty2 = _a[3];\n\n    var _b = __read(path, 2),\n        A = _b[0],\n        B = _b[1];\n\n    var x1 = A[0] + tx1 - this.dx,\n        y1 = A[1] + ty1;\n    var x2 = B[0] + tx2 - this.dx,\n        y2 = B[1] + ty2;\n    var W = Math.abs(i % 2 ? y2 - y1 : x2 - x1);\n    var n = dot ? Math.ceil(W / (2 * t)) : Math.ceil((W - t) / (4 * t));\n    var m = W / (4 * n + 1);\n    var line = this.svg('line', {\n      x1: this.fixed(x1),\n      y1: this.fixed(y1),\n      x2: this.fixed(x2),\n      y2: this.fixed(y2),\n      'stroke-width': this.fixed(t),\n      stroke: color,\n      'stroke-linecap': dot ? 'round' : 'square',\n      'stroke-dasharray': dot ? [1, this.fixed(W / n - .002)].join(' ') : [this.fixed(m), this.fixed(3 * m)].join(' ')\n    });\n    var adaptor = this.adaptor;\n    var child = adaptor.firstChild(this.element);\n\n    if (child) {\n      adaptor.insert(line, child);\n    } else {\n      adaptor.append(this.element, line);\n    }\n  };\n\n  SVGWrapper.prototype.handleAttributes = function () {\n    var e_4, _a, e_5, _b;\n\n    var attributes = this.node.attributes;\n    var defaults = attributes.getAllDefaults();\n    var skip = SVGWrapper.skipAttributes;\n\n    try {\n      for (var _c = __values(attributes.getExplicitNames()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var name_2 = _d.value;\n\n        if (skip[name_2] === false || !(name_2 in defaults) && !skip[name_2] && !this.adaptor.hasAttribute(this.element, name_2)) {\n          this.adaptor.setAttribute(this.element, name_2, attributes.getExplicit(name_2));\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    if (attributes.get('class')) {\n      var names = attributes.get('class').trim().split(/ +/);\n\n      try {\n        for (var names_1 = __values(names), names_1_1 = names_1.next(); !names_1_1.done; names_1_1 = names_1.next()) {\n          var name_3 = names_1_1.value;\n          this.adaptor.addClass(this.element, name_3);\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (names_1_1 && !names_1_1.done && (_b = names_1.return)) _b.call(names_1);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n    }\n  };\n\n  SVGWrapper.prototype.place = function (x, y, element) {\n    if (element === void 0) {\n      element = null;\n    }\n\n    x += this.dx;\n    if (!(x || y)) return;\n\n    if (!element) {\n      element = this.element;\n      y = this.handleId(y);\n    }\n\n    var translate = \"translate(\".concat(this.fixed(x), \",\").concat(this.fixed(y), \")\");\n    var transform = this.adaptor.getAttribute(element, 'transform') || '';\n    this.adaptor.setAttribute(element, 'transform', translate + (transform ? ' ' + transform : ''));\n  };\n\n  SVGWrapper.prototype.handleId = function (y) {\n    if (!this.node.attributes || !this.node.attributes.get('id')) {\n      return y;\n    }\n\n    var adaptor = this.adaptor;\n    var h = this.getBBox().h;\n    var children = adaptor.childNodes(this.element);\n    children.forEach(function (child) {\n      return adaptor.remove(child);\n    });\n    var g = this.svg('g', {\n      'data-idbox': true,\n      transform: \"translate(0,\".concat(this.fixed(-h), \")\")\n    }, children);\n    adaptor.append(this.element, this.svg('text', {\n      'data-id-align': true\n    }, [this.text('')]));\n    adaptor.append(this.element, g);\n    return y + h;\n  };\n\n  SVGWrapper.prototype.firstChild = function () {\n    var adaptor = this.adaptor;\n    var child = adaptor.firstChild(this.element);\n\n    if (child && adaptor.kind(child) === 'text' && adaptor.getAttribute(child, 'data-id-align')) {\n      child = adaptor.firstChild(adaptor.next(child));\n    }\n\n    if (child && adaptor.kind(child) === 'rect' && adaptor.getAttribute(child, 'data-hitbox')) {\n      child = adaptor.next(child);\n    }\n\n    return child;\n  };\n\n  SVGWrapper.prototype.placeChar = function (n, x, y, parent, variant) {\n    var e_6, _a;\n\n    if (variant === void 0) {\n      variant = null;\n    }\n\n    if (variant === null) {\n      variant = this.variant;\n    }\n\n    var C = n.toString(16).toUpperCase();\n\n    var _b = __read(this.getVariantChar(variant, n), 4),\n        w = _b[2],\n        data = _b[3];\n\n    if ('p' in data) {\n      var path = data.p ? 'M' + data.p + 'Z' : '';\n      this.place(x, y, this.adaptor.append(parent, this.charNode(variant, C, path)));\n    } else if ('c' in data) {\n      var g = this.adaptor.append(parent, this.svg('g', {\n        'data-c': C\n      }));\n      this.place(x, y, g);\n      x = 0;\n\n      try {\n        for (var _c = __values(this.unicodeChars(data.c, variant)), _d = _c.next(); !_d.done; _d = _c.next()) {\n          var n_1 = _d.value;\n          x += this.placeChar(n_1, x, y, g, variant);\n        }\n      } catch (e_6_1) {\n        e_6 = {\n          error: e_6_1\n        };\n      } finally {\n        try {\n          if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n        } finally {\n          if (e_6) throw e_6.error;\n        }\n      }\n    } else if (data.unknown) {\n      var char = String.fromCodePoint(n);\n      var text = this.adaptor.append(parent, this.jax.unknownText(char, variant));\n      this.place(x, y, text);\n      return this.jax.measureTextNodeWithCache(text, char, variant).w;\n    }\n\n    return w;\n  };\n\n  SVGWrapper.prototype.charNode = function (variant, C, path) {\n    var cache = this.jax.options.fontCache;\n    return cache !== 'none' ? this.useNode(variant, C, path) : this.pathNode(C, path);\n  };\n\n  SVGWrapper.prototype.pathNode = function (C, path) {\n    return this.svg('path', {\n      'data-c': C,\n      d: path\n    });\n  };\n\n  SVGWrapper.prototype.useNode = function (variant, C, path) {\n    var use = this.svg('use', {\n      'data-c': C\n    });\n    var id = '#' + this.jax.fontCache.cachePath(variant, C, path);\n    this.adaptor.setAttribute(use, 'href', id, svg_js_1.XLINKNS);\n    return use;\n  };\n\n  SVGWrapper.prototype.drawBBox = function () {\n    var _a = this.getBBox(),\n        w = _a.w,\n        h = _a.h,\n        d = _a.d;\n\n    var box = this.svg('g', {\n      style: {\n        opacity: .25\n      }\n    }, [this.svg('rect', {\n      fill: 'red',\n      height: this.fixed(h),\n      width: this.fixed(w)\n    }), this.svg('rect', {\n      fill: 'green',\n      height: this.fixed(d),\n      width: this.fixed(w),\n      y: this.fixed(-d)\n    })]);\n    var node = this.element || this.parent.element;\n    this.adaptor.append(node, box);\n  };\n\n  SVGWrapper.prototype.html = function (type, def, content) {\n    if (def === void 0) {\n      def = {};\n    }\n\n    if (content === void 0) {\n      content = [];\n    }\n\n    return this.jax.html(type, def, content);\n  };\n\n  SVGWrapper.prototype.svg = function (type, def, content) {\n    if (def === void 0) {\n      def = {};\n    }\n\n    if (content === void 0) {\n      content = [];\n    }\n\n    return this.jax.svg(type, def, content);\n  };\n\n  SVGWrapper.prototype.text = function (text) {\n    return this.jax.text(text);\n  };\n\n  SVGWrapper.prototype.fixed = function (x, n) {\n    if (n === void 0) {\n      n = 1;\n    }\n\n    return this.jax.fixed(x * 1000, n);\n  };\n\n  SVGWrapper.kind = 'unknown';\n  SVGWrapper.borderFuzz = 0.005;\n  return SVGWrapper;\n}(Wrapper_js_1.CommonWrapper);\n\nexports.SVGWrapper = SVGWrapper;","map":{"version":3,"mappings":"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","names":["__extends","_this","SVGWrapper","parent","addChildren","standardSVGnode","x","childNodes","_c","child","toSVG","bbox","getOuterBBox","element","place","L","rscale","w","R","svg","createSVGnode","handleStyles","handleScale","handleBorder","handleColor","handleAttributes","node","kind","href","attributes","get","adaptor","append","h","d","fill","stroke","width","fixed","height","y","styles","cssText","setAttribute","BBox_js_1","StyleAdjust","forEach","_a","_b","name","lr","dx","length2em","scale","mathcolor","getExplicit","color","mathbackground","background","bgcolor","rect","firstChild","insert","Array","style","_d","name_1","i","key","w_1","Math","max","f","borderFuzz","outerRT","outerLT","outerRB","outerLB","innerRT","innerLT","innerRB","innerLB","paths","_h","path","addBorderBroken","addBorderSolid","border","points","map","concat","join","t","dot","t2","tx1","ty1","tx2","ty2","A","B","x1","y1","x2","y2","W","abs","n","ceil","m","line","defaults","getAllDefaults","skip","skipAttributes","getExplicitNames","name_2","hasAttribute","names","trim","split","names_1_1","name_3","addClass","handleId","translate","transform","getAttribute","getBBox","children","remove","g","text","next","variant","C","toString","toUpperCase","getVariantChar","data","p","charNode","unicodeChars","c","n_1","placeChar","unknown","char","String","fromCodePoint","jax","unknownText","measureTextNodeWithCache","cache","options","fontCache","useNode","pathNode","use","id","cachePath","svg_js_1","box","opacity","type","def","content","html","Wrapper_js_1","exports"],"sourceRoot":"","sources":["../../../ts/output/svg/Wrapper.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}