{"ast":null,"code":"\"use strict\";\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar NodeUtil_js_1 = __importDefault(require(\"./NodeUtil.js\"));\n\nvar Stack = function () {\n  function Stack(_factory, _env, inner) {\n    this._factory = _factory;\n    this._env = _env;\n    this.global = {};\n    this.stack = [];\n    this.global = {\n      isInner: inner\n    };\n    this.stack = [this._factory.create('start', this.global)];\n\n    if (_env) {\n      this.stack[0].env = _env;\n    }\n\n    this.env = this.stack[0].env;\n  }\n\n  Object.defineProperty(Stack.prototype, \"env\", {\n    get: function get() {\n      return this._env;\n    },\n    set: function set(env) {\n      this._env = env;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  Stack.prototype.Push = function () {\n    var e_1, _a;\n\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    try {\n      for (var args_1 = __values(args), args_1_1 = args_1.next(); !args_1_1.done; args_1_1 = args_1.next()) {\n        var node = args_1_1.value;\n\n        if (!node) {\n          continue;\n        }\n\n        var item = NodeUtil_js_1.default.isNode(node) ? this._factory.create('mml', node) : node;\n        item.global = this.global;\n\n        var _b = __read(this.stack.length ? this.Top().checkItem(item) : [null, true], 2),\n            top_1 = _b[0],\n            success = _b[1];\n\n        if (!success) {\n          continue;\n        }\n\n        if (top_1) {\n          this.Pop();\n          this.Push.apply(this, __spreadArray([], __read(top_1), false));\n          continue;\n        }\n\n        this.stack.push(item);\n\n        if (item.env) {\n          if (item.copyEnv) {\n            Object.assign(item.env, this.env);\n          }\n\n          this.env = item.env;\n        } else {\n          item.env = this.env;\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (args_1_1 && !args_1_1.done && (_a = args_1.return)) _a.call(args_1);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Stack.prototype.Pop = function () {\n    var item = this.stack.pop();\n\n    if (!item.isOpen) {\n      delete item.env;\n    }\n\n    this.env = this.stack.length ? this.Top().env : {};\n    return item;\n  };\n\n  Stack.prototype.Top = function (n) {\n    if (n === void 0) {\n      n = 1;\n    }\n\n    return this.stack.length < n ? null : this.stack[this.stack.length - n];\n  };\n\n  Stack.prototype.Prev = function (noPop) {\n    var top = this.Top();\n    return noPop ? top.First : top.Pop();\n  };\n\n  Stack.prototype.toString = function () {\n    return 'stack[\\n  ' + this.stack.join('\\n  ') + '\\n]';\n  };\n\n  return Stack;\n}();\n\nexports.default = Stack;","map":{"version":3,"mappings":"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","names":["_factory","_env","inner","global","isInner","stack","create","env","Object","Stack","args","args_1_1","node","item","NodeUtil_js_1","isNode","length","Top","checkItem","top_1","success","Pop","Push","apply","__spreadArray","push","copyEnv","assign","pop","isOpen","n","noPop","top","First","join"],"sourceRoot":"","sources":["../../../ts/input/tex/Stack.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}