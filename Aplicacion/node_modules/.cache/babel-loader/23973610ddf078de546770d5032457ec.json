{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isFunction from \"lodash/isFunction\";\nimport _isNil from \"lodash/isNil\";\nimport _omit from \"lodash/omit\";\nimport _pick from \"lodash/pick\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport shallowEqual from '../utils/shallowEqual';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { findNodeOfTree } from '../utils/treeUtils';\nimport IntlContext from '../IntlProvider/IntlContext';\nimport FormattedMessage from '../IntlProvider/FormattedMessage';\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\nimport _stringToObject from '../utils/stringToObject';\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\nimport { getDerivedStateForCascade } from './utils';\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\nimport { PickerToggle, MenuWrapper, SearchBar, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes';\n\nvar Cascader = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Cascader, _React$Component);\n\n  function Cascader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.triggerRef = void 0;\n    _this.containerRef = void 0;\n    _this.positionRef = void 0;\n    _this.menuContainerRef = void 0;\n    _this.isControlled = void 0;\n\n    _this.handleSelect = function (node, cascadeItems, activePaths, isLeafNode, event) {\n      var _this$props = _this.props,\n          onChange = _this$props.onChange,\n          onSelect = _this$props.onSelect,\n          valueKey = _this$props.valueKey,\n          childrenKey = _this$props.childrenKey,\n          parentSelectable = _this$props.parentSelectable;\n\n      var prevValue = _this.getValue();\n\n      var value = node[valueKey];\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, value, {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }), event);\n      /**\r\n       Determines whether the option is a leaf node, and if so, closes the picker.\r\n       */\n\n      if (isLeafNode) {\n        _this.handleCloseDropdown();\n\n        var _nextState = {\n          selectNode: node\n        };\n\n        if (!_this.isControlled) {\n          _nextState = _extends({}, _nextState, {\n            value: value\n          }, getDerivedStateForCascade(_this.props, _this.state, value));\n        }\n\n        _this.setState(_nextState);\n\n        if (!shallowEqual(value, prevValue)) {\n          onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n        }\n\n        return;\n      }\n\n      var nextState = {\n        selectNode: node,\n        items: cascadeItems,\n        tempActivePaths: activePaths\n      };\n      /** When the parent is optional, the value and the displayed path are updated. */\n\n      if (parentSelectable) {\n        nextState.value = value;\n        nextState.activePaths = activePaths;\n\n        if (!shallowEqual(value, prevValue)) {\n          onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n        }\n      }\n\n      _this.setState(nextState, function () {\n        var _this$positionRef$cur, _this$positionRef$cur2; // Update menu position\n\n\n        (_this$positionRef$cur = _this.positionRef.current) === null || _this$positionRef$cur === void 0 ? void 0 : (_this$positionRef$cur2 = _this$positionRef$cur.updatePosition) === null || _this$positionRef$cur2 === void 0 ? void 0 : _this$positionRef$cur2.call(_this$positionRef$cur);\n      });\n    };\n\n    _this.handleSearchRowSelect = function (item, event) {\n      var _this$props2 = _this.props,\n          valueKey = _this$props2.valueKey,\n          onChange = _this$props2.onChange,\n          onSelect = _this$props2.onSelect;\n      var value = item[valueKey];\n\n      _this.handleCloseDropdown();\n\n      var nextState = {\n        selectNode: item,\n        searchKeyword: ''\n      };\n\n      if (!_this.isControlled) {\n        nextState = _extends({}, nextState, {}, getDerivedStateForCascade(_this.props, _this.state, value), {\n          value: value\n        });\n      }\n\n      _this.setState(nextState);\n\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(item, null, null, event);\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n    };\n\n    _this.handleCloseDropdown = function () {\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\n\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\n    };\n\n    _this.handleOpenDropdown = function () {\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\n\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props3 = _this.props,\n          disabled = _this$props3.disabled,\n          onChange = _this$props3.onChange,\n          data = _this$props3.data;\n\n      if (disabled) {\n        return;\n      }\n\n      var nextState = {\n        items: [data],\n        value: null,\n        selectNode: null,\n        activePaths: [],\n        tempActivePaths: []\n      };\n\n      _this.setState(nextState, function () {\n        onChange === null || onChange === void 0 ? void 0 : onChange(null, event);\n      });\n    };\n\n    _this.handleSearch = function (searchKeyword, event) {\n      var _this$props$onSearch, _this$props4;\n\n      _this.setState({\n        searchKeyword: searchKeyword\n      });\n\n      (_this$props$onSearch = (_this$props4 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props4, searchKeyword, event);\n    };\n\n    _this.handleEntered = function () {\n      var _this$props$onOpen, _this$props5;\n\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleExit = function () {\n      var _this$props$onClose, _this$props6;\n\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\n\n      _this.setState({\n        searchKeyword: '',\n        active: false\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.renderSearchRow = function (item, key) {\n      var _classNames;\n\n      var _this$props7 = _this.props,\n          labelKey = _this$props7.labelKey,\n          valueKey = _this$props7.valueKey,\n          _this$props7$disabled = _this$props7.disabledItemValues,\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\n      var searchKeyword = _this.state.searchKeyword;\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\n      var nodes = getNodeParents(item);\n      nodes.push(item);\n      nodes = nodes.map(function (node) {\n        var _extends2;\n\n        var labelElements = [];\n        var a = node[labelKey].split(regx);\n        var b = node[labelKey].match(regx);\n\n        for (var i = 0; i < a.length; i++) {\n          labelElements.push(a[i]);\n\n          if (b && b[i]) {\n            labelElements.push(React.createElement(\"strong\", {\n              key: i\n            }, b[i]));\n          }\n        }\n\n        return _extends({}, node, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2));\n      });\n      var disabled = disabledItemValues.some(function (value) {\n        return nodes.some(function (node) {\n          return node[valueKey] === value;\n        });\n      });\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\n      return React.createElement(\"div\", {\n        key: key,\n        className: itemClasses,\n        onClick: function onClick(event) {\n          if (!disabled) {\n            _this.handleSearchRowSelect(item, event);\n          }\n        }\n      }, nodes.map(function (node, index) {\n        return React.createElement(\"span\", {\n          key: \"col-\" + index,\n          className: _this.addPrefix('cascader-col')\n        }, node[labelKey]);\n      }));\n    };\n\n    var initState = {\n      searchKeyword: '',\n      selectNode: null,\n      data: props.data,\n      value: props.defaultValue,\n\n      /**\r\n       * 选中值的路径\r\n       */\n      activePaths: [],\n\n      /**\r\n       * 用于展示面板的数据列表，是一个二维的数组\r\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\r\n       */\n      items: []\n    };\n    _this.state = _extends({}, initState, {}, getDerivedStateForCascade(props, initState), {\n      flattenData: flattenTree(props.data)\n    });\n    _this.isControlled = !_isUndefined(props.value);\n    _this.triggerRef = React.createRef();\n    _this.containerRef = React.createRef();\n    _this.positionRef = React.createRef(); // for test\n\n    _this.menuContainerRef = React.createRef();\n    return _this;\n  }\n\n  Cascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var value = nextProps.value,\n        data = nextProps.data,\n        labelKey = nextProps.labelKey,\n        valueKey = nextProps.valueKey;\n\n    if (data !== prevState.data) {\n      var _prevState$selectNode; // First get the value of the clicked node `selectNodeValue`, and then get the new `newChildren`.\n\n\n      var selectNodeValue = prevState === null || prevState === void 0 ? void 0 : (_prevState$selectNode = prevState.selectNode) === null || _prevState$selectNode === void 0 ? void 0 : _prevState$selectNode[valueKey];\n\n      if (selectNodeValue) {\n        var _findNodeOfTree;\n\n        var newChildren = ((_findNodeOfTree = findNodeOfTree(data, function (item) {\n          return shallowEqual(item[valueKey], selectNodeValue);\n        })) === null || _findNodeOfTree === void 0 ? void 0 : _findNodeOfTree.children) || [];\n        return _extends({}, getDerivedStateForCascade(nextProps, prevState, selectNodeValue, newChildren.map(function (item) {\n          return _stringToObject(item, labelKey, valueKey);\n        })), {\n          data: data,\n          flattenData: flattenTree(data)\n        });\n      }\n\n      return _extends({}, getDerivedStateForCascade(nextProps, prevState), {\n        flattenData: flattenTree(data),\n        data: data\n      });\n    }\n\n    if (typeof value !== 'undefined' && !shallowEqual(value, prevState.value)) {\n      return _extends({}, getDerivedStateForCascade(nextProps, prevState), {\n        value: value\n      });\n    }\n\n    return null;\n  };\n\n  var _proto = Cascader.prototype;\n\n  _proto.getValue = function getValue(nextProps) {\n    var _ref = nextProps || this.props,\n        value = _ref.value;\n\n    return _isUndefined(value) ? this.state.value : value;\n  };\n  /**\r\n   * 在 data 对象中的数据类型是字符串比如: ['foo']\r\n   * 通过这个行数可以把值转换成 [{name:'foo':value:'foo'}]\r\n   */\n\n\n  _proto.stringToObject = function stringToObject(value) {\n    var _this$props8 = this.props,\n        labelKey = _this$props8.labelKey,\n        valueKey = _this$props8.valueKey;\n    return _stringToObject(value, labelKey, valueKey);\n  };\n\n  _proto.someKeyword = function someKeyword(item) {\n    var labelKey = this.props.labelKey;\n    var searchKeyword = this.state.searchKeyword;\n\n    if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\n      return true;\n    }\n\n    if (item.parent && this.someKeyword(item.parent)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  _proto.getSearchResult = function getSearchResult() {\n    var _this4 = this;\n\n    var childrenKey = this.props.childrenKey;\n    var flattenData = this.state.flattenData;\n    var items = [];\n    var result = flattenData.filter(function (item) {\n      if (item[childrenKey]) {\n        return false;\n      }\n\n      return _this4.someKeyword(item);\n    });\n\n    for (var i = 0; i < result.length; i++) {\n      items.push(result[i]);\n\n      if (i === 99) {\n        return items;\n      }\n    }\n\n    return items;\n  };\n\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\n    var locale = this.props.locale;\n    var searchKeyword = this.state.searchKeyword;\n\n    if (searchKeyword === '') {\n      return null;\n    }\n\n    var items = this.getSearchResult();\n    return React.createElement(\"div\", {\n      className: this.addPrefix('cascader-search-panel')\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\n      className: this.addPrefix('none')\n    }, locale.noResultsText));\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _classNames2;\n\n    var _this$state = this.state,\n        items = _this$state.items,\n        tempActivePaths = _this$state.tempActivePaths,\n        activePaths = _this$state.activePaths,\n        searchKeyword = _this$state.searchKeyword;\n    var _this$props9 = this.props,\n        renderMenu = _this$props9.renderMenu,\n        renderExtraFooter = _this$props9.renderExtraFooter,\n        menuClassName = _this$props9.menuClassName,\n        menuStyle = _this$props9.menuStyle,\n        searchable = _this$props9.searchable,\n        locale = _this$props9.locale,\n        inline = _this$props9.inline;\n    var classes = classNames(this.addPrefix('cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\n\n    var menuProps = _pick(this.props, Object.keys(_omit(dropdownMenuPropTypes, ['classPrefix'])));\n\n    return React.createElement(MenuWrapper, {\n      className: classes,\n      style: menuStyle\n    }, searchable && React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: this.handleSearch,\n      value: searchKeyword\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\n      classPrefix: this.addPrefix('cascader-menu'),\n      ref: this.menuContainerRef,\n      cascadeItems: items,\n      cascadePathItems: tempActivePaths || activePaths,\n      activeItemValue: this.getValue(),\n      onSelect: this.handleSelect,\n      renderMenu: renderMenu\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.render = function render() {\n    var _this$props10 = this.props,\n        valueKey = _this$props10.valueKey,\n        labelKey = _this$props10.labelKey,\n        placeholder = _this$props10.placeholder,\n        renderValue = _this$props10.renderValue,\n        disabled = _this$props10.disabled,\n        cleanable = _this$props10.cleanable,\n        locale = _this$props10.locale,\n        toggleComponentClass = _this$props10.toggleComponentClass,\n        style = _this$props10.style,\n        onEnter = _this$props10.onEnter,\n        onExited = _this$props10.onExited,\n        onClean = _this$props10.onClean,\n        inline = _this$props10.inline,\n        positionRef = _this$props10.positionRef,\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"inline\", \"positionRef\"]);\n\n    if (inline) {\n      return this.renderDropdownMenu();\n    }\n\n    var _this$state2 = this.state,\n        activePaths = _this$state2.activePaths,\n        active = _this$state2.active;\n    var unhandled = getUnhandledProps(Cascader, rest);\n    var value = this.getValue();\n    /**\r\n     * 1.Have a value and the value is valid.\r\n     * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\r\n     */\n\n    var hasValue = activePaths.length > 0 || !_isNil(value) && _isFunction(renderValue);\n\n    var activeItemLabel = placeholder;\n\n    if (activePaths.length > 0) {\n      activeItemLabel = [];\n      activePaths.forEach(function (item, index) {\n        var key = item[valueKey] || item[labelKey];\n        activeItemLabel.push(React.createElement(\"span\", {\n          key: key\n        }, item[labelKey]));\n\n        if (index < activePaths.length - 1) {\n          activeItemLabel.push(React.createElement(\"span\", {\n            className: \"separator\",\n            key: key + \"-separator\"\n          }, ' / '));\n        }\n      });\n    }\n\n    if (!_isNil(value) && _isFunction(renderValue)) {\n      activeItemLabel = renderValue(value, activePaths, activeItemLabel);\n    }\n\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\n    return React.createElement(IntlContext.Provider, {\n      value: locale\n    }, React.createElement(\"div\", {\n      className: classes,\n      style: style,\n      tabIndex: -1,\n      role: \"menu\",\n      ref: this.containerRef\n    }, React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: mergeRefs(this.positionRef, positionRef),\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\n      onExited: createChainedFunction(this.handleExit, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      componentClass: toggleComponentClass,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      hasValue: hasValue,\n      active: active\n    }), activeItemLabel || React.createElement(FormattedMessage, {\n      id: \"placeholder\"\n    })))));\n  };\n\n  return Cascader;\n}(React.Component);\n\nCascader.propTypes = _extends({}, listPickerPropTypes, {\n  renderMenu: PropTypes.func,\n  onSelect: PropTypes.func,\n  onSearch: PropTypes.func,\n  cleanable: PropTypes.bool,\n  renderMenuItem: PropTypes.func,\n  menuWidth: PropTypes.number,\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  searchable: PropTypes.bool,\n  inline: PropTypes.bool,\n  parentSelectable: PropTypes.bool\n});\nCascader.defaultProps = _extends({}, listPickerDefaultProps, {\n  searchable: true,\n  locale: {\n    placeholder: 'Select',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  }\n});\npolyfill(Cascader);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(Cascader);","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_isFunction","_isNil","_omit","_pick","_isUndefined","React","PropTypes","classNames","shallowEqual","polyfill","findNodeOfTree","IntlContext","FormattedMessage","DropdownMenu","dropdownMenuPropTypes","_stringToObject","getSafeRegExpString","flattenTree","getNodeParents","getDerivedStateForCascade","defaultProps","prefix","getUnhandledProps","createChainedFunction","mergeRefs","PickerToggle","MenuWrapper","SearchBar","PickerToggleTrigger","getToggleWrapperClassName","createConcatChildrenFunction","listPickerPropTypes","listPickerDefaultProps","Cascader","_React$Component","props","_this","call","triggerRef","containerRef","positionRef","menuContainerRef","isControlled","handleSelect","node","cascadeItems","activePaths","isLeafNode","event","_this$props","onChange","onSelect","valueKey","childrenKey","parentSelectable","prevValue","getValue","value","handleCloseDropdown","_nextState","selectNode","state","setState","nextState","items","tempActivePaths","_this$positionRef$cur","_this$positionRef$cur2","current","updatePosition","handleSearchRowSelect","item","_this$props2","searchKeyword","_this$triggerRef$curr","_this$triggerRef$curr2","hide","handleOpenDropdown","_this$triggerRef$curr3","_this$triggerRef$curr4","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleClean","_this$props3","disabled","data","handleSearch","_this$props$onSearch","_this$props4","onSearch","handleEntered","_this$props$onOpen","_this$props5","onOpen","active","handleExit","_this$props$onClose","_this$props6","onClose","addPrefix","name","classPrefix","renderSearchRow","key","_classNames","_this$props7","labelKey","_this$props7$disabled","disabledItemValues","regx","RegExp","nodes","push","map","_extends2","labelElements","a","split","b","match","i","length","createElement","some","itemClasses","className","onClick","index","initState","defaultValue","flattenData","createRef","getDerivedStateFromProps","nextProps","prevState","_prevState$selectNode","selectNodeValue","_findNodeOfTree","newChildren","children","_proto","prototype","_ref","stringToObject","_this$props8","someKeyword","parent","getSearchResult","_this4","result","filter","renderSearchResultPanel","locale","noResultsText","renderDropdownMenu","_classNames2","_this$state","_this$props9","renderMenu","renderExtraFooter","menuClassName","menuStyle","searchable","inline","classes","menuProps","Object","keys","style","placeholder","searchPlaceholder","ref","cascadePathItems","activeItemValue","render","_this$props10","renderValue","cleanable","toggleComponentClass","onEnter","onExited","onClean","rest","_this$state2","unhandled","hasValue","activeItemLabel","forEach","Provider","tabIndex","role","pickerProps","speaker","componentClass","id","Component","propTypes","func","bool","renderMenuItem","menuWidth","number","menuHeight","oneOfType","string"],"sources":["G:/gitlab/TFG/Aplicacion/node_modules/rsuite/es/Cascader/Cascader.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\r\nimport _isFunction from \"lodash/isFunction\";\r\nimport _isNil from \"lodash/isNil\";\r\nimport _omit from \"lodash/omit\";\r\nimport _pick from \"lodash/pick\";\r\nimport _isUndefined from \"lodash/isUndefined\";\r\nimport * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport shallowEqual from '../utils/shallowEqual';\r\nimport { polyfill } from 'react-lifecycles-compat';\r\nimport { findNodeOfTree } from '../utils/treeUtils';\r\nimport IntlContext from '../IntlProvider/IntlContext';\r\nimport FormattedMessage from '../IntlProvider/FormattedMessage';\r\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\r\nimport _stringToObject from '../utils/stringToObject';\r\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\r\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\r\nimport { getDerivedStateForCascade } from './utils';\r\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\r\nimport { PickerToggle, MenuWrapper, SearchBar, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\r\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes';\r\n\r\nvar Cascader =\r\n/*#__PURE__*/\r\nfunction (_React$Component) {\r\n  _inheritsLoose(Cascader, _React$Component);\r\n\r\n  function Cascader(props) {\r\n    var _this;\r\n\r\n    _this = _React$Component.call(this, props) || this;\r\n    _this.triggerRef = void 0;\r\n    _this.containerRef = void 0;\r\n    _this.positionRef = void 0;\r\n    _this.menuContainerRef = void 0;\r\n    _this.isControlled = void 0;\r\n\r\n    _this.handleSelect = function (node, cascadeItems, activePaths, isLeafNode, event) {\r\n      var _this$props = _this.props,\r\n          onChange = _this$props.onChange,\r\n          onSelect = _this$props.onSelect,\r\n          valueKey = _this$props.valueKey,\r\n          childrenKey = _this$props.childrenKey,\r\n          parentSelectable = _this$props.parentSelectable;\r\n\r\n      var prevValue = _this.getValue();\r\n\r\n      var value = node[valueKey];\r\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, value, {\r\n        valueKey: valueKey,\r\n        childrenKey: childrenKey\r\n      }), event);\r\n      /**\r\n       Determines whether the option is a leaf node, and if so, closes the picker.\r\n       */\r\n\r\n      if (isLeafNode) {\r\n        _this.handleCloseDropdown();\r\n\r\n        var _nextState = {\r\n          selectNode: node\r\n        };\r\n\r\n        if (!_this.isControlled) {\r\n          _nextState = _extends({}, _nextState, {\r\n            value: value\r\n          }, getDerivedStateForCascade(_this.props, _this.state, value));\r\n        }\r\n\r\n        _this.setState(_nextState);\r\n\r\n        if (!shallowEqual(value, prevValue)) {\r\n          onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      var nextState = {\r\n        selectNode: node,\r\n        items: cascadeItems,\r\n        tempActivePaths: activePaths\r\n      };\r\n      /** When the parent is optional, the value and the displayed path are updated. */\r\n\r\n      if (parentSelectable) {\r\n        nextState.value = value;\r\n        nextState.activePaths = activePaths;\r\n\r\n        if (!shallowEqual(value, prevValue)) {\r\n          onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\r\n        }\r\n      }\r\n\r\n      _this.setState(nextState, function () {\r\n        var _this$positionRef$cur, _this$positionRef$cur2;\r\n\r\n        // Update menu position\r\n        (_this$positionRef$cur = _this.positionRef.current) === null || _this$positionRef$cur === void 0 ? void 0 : (_this$positionRef$cur2 = _this$positionRef$cur.updatePosition) === null || _this$positionRef$cur2 === void 0 ? void 0 : _this$positionRef$cur2.call(_this$positionRef$cur);\r\n      });\r\n    };\r\n\r\n    _this.handleSearchRowSelect = function (item, event) {\r\n      var _this$props2 = _this.props,\r\n          valueKey = _this$props2.valueKey,\r\n          onChange = _this$props2.onChange,\r\n          onSelect = _this$props2.onSelect;\r\n      var value = item[valueKey];\r\n\r\n      _this.handleCloseDropdown();\r\n\r\n      var nextState = {\r\n        selectNode: item,\r\n        searchKeyword: ''\r\n      };\r\n\r\n      if (!_this.isControlled) {\r\n        nextState = _extends({}, nextState, {}, getDerivedStateForCascade(_this.props, _this.state, value), {\r\n          value: value\r\n        });\r\n      }\r\n\r\n      _this.setState(nextState);\r\n\r\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(item, null, null, event);\r\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\r\n    };\r\n\r\n    _this.handleCloseDropdown = function () {\r\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\r\n\r\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\r\n    };\r\n\r\n    _this.handleOpenDropdown = function () {\r\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\r\n\r\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\r\n    };\r\n\r\n    _this.open = function () {\r\n      var _this$handleOpenDropd, _this2;\r\n\r\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\r\n    };\r\n\r\n    _this.close = function () {\r\n      var _this$handleCloseDrop, _this3;\r\n\r\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\r\n    };\r\n\r\n    _this.handleClean = function (event) {\r\n      var _this$props3 = _this.props,\r\n          disabled = _this$props3.disabled,\r\n          onChange = _this$props3.onChange,\r\n          data = _this$props3.data;\r\n\r\n      if (disabled) {\r\n        return;\r\n      }\r\n\r\n      var nextState = {\r\n        items: [data],\r\n        value: null,\r\n        selectNode: null,\r\n        activePaths: [],\r\n        tempActivePaths: []\r\n      };\r\n\r\n      _this.setState(nextState, function () {\r\n        onChange === null || onChange === void 0 ? void 0 : onChange(null, event);\r\n      });\r\n    };\r\n\r\n    _this.handleSearch = function (searchKeyword, event) {\r\n      var _this$props$onSearch, _this$props4;\r\n\r\n      _this.setState({\r\n        searchKeyword: searchKeyword\r\n      });\r\n\r\n      (_this$props$onSearch = (_this$props4 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props4, searchKeyword, event);\r\n    };\r\n\r\n    _this.handleEntered = function () {\r\n      var _this$props$onOpen, _this$props5;\r\n\r\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\r\n\r\n      _this.setState({\r\n        active: true\r\n      });\r\n    };\r\n\r\n    _this.handleExit = function () {\r\n      var _this$props$onClose, _this$props6;\r\n\r\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\r\n\r\n      _this.setState({\r\n        searchKeyword: '',\r\n        active: false\r\n      });\r\n    };\r\n\r\n    _this.addPrefix = function (name) {\r\n      return prefix(_this.props.classPrefix)(name);\r\n    };\r\n\r\n    _this.renderSearchRow = function (item, key) {\r\n      var _classNames;\r\n\r\n      var _this$props7 = _this.props,\r\n          labelKey = _this$props7.labelKey,\r\n          valueKey = _this$props7.valueKey,\r\n          _this$props7$disabled = _this$props7.disabledItemValues,\r\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\r\n      var searchKeyword = _this.state.searchKeyword;\r\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\r\n      var nodes = getNodeParents(item);\r\n      nodes.push(item);\r\n      nodes = nodes.map(function (node) {\r\n        var _extends2;\r\n\r\n        var labelElements = [];\r\n        var a = node[labelKey].split(regx);\r\n        var b = node[labelKey].match(regx);\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n          labelElements.push(a[i]);\r\n\r\n          if (b && b[i]) {\r\n            labelElements.push(React.createElement(\"strong\", {\r\n              key: i\r\n            }, b[i]));\r\n          }\r\n        }\r\n\r\n        return _extends({}, node, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2));\r\n      });\r\n      var disabled = disabledItemValues.some(function (value) {\r\n        return nodes.some(function (node) {\r\n          return node[valueKey] === value;\r\n        });\r\n      });\r\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\r\n      return React.createElement(\"div\", {\r\n        key: key,\r\n        className: itemClasses,\r\n        onClick: function onClick(event) {\r\n          if (!disabled) {\r\n            _this.handleSearchRowSelect(item, event);\r\n          }\r\n        }\r\n      }, nodes.map(function (node, index) {\r\n        return React.createElement(\"span\", {\r\n          key: \"col-\" + index,\r\n          className: _this.addPrefix('cascader-col')\r\n        }, node[labelKey]);\r\n      }));\r\n    };\r\n\r\n    var initState = {\r\n      searchKeyword: '',\r\n      selectNode: null,\r\n      data: props.data,\r\n      value: props.defaultValue,\r\n\r\n      /**\r\n       * 选中值的路径\r\n       */\r\n      activePaths: [],\r\n\r\n      /**\r\n       * 用于展示面板的数据列表，是一个二维的数组\r\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\r\n       */\r\n      items: []\r\n    };\r\n    _this.state = _extends({}, initState, {}, getDerivedStateForCascade(props, initState), {\r\n      flattenData: flattenTree(props.data)\r\n    });\r\n    _this.isControlled = !_isUndefined(props.value);\r\n    _this.triggerRef = React.createRef();\r\n    _this.containerRef = React.createRef();\r\n    _this.positionRef = React.createRef(); // for test\r\n\r\n    _this.menuContainerRef = React.createRef();\r\n    return _this;\r\n  }\r\n\r\n  Cascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\r\n    var value = nextProps.value,\r\n        data = nextProps.data,\r\n        labelKey = nextProps.labelKey,\r\n        valueKey = nextProps.valueKey;\r\n\r\n    if (data !== prevState.data) {\r\n      var _prevState$selectNode;\r\n\r\n      // First get the value of the clicked node `selectNodeValue`, and then get the new `newChildren`.\r\n      var selectNodeValue = prevState === null || prevState === void 0 ? void 0 : (_prevState$selectNode = prevState.selectNode) === null || _prevState$selectNode === void 0 ? void 0 : _prevState$selectNode[valueKey];\r\n\r\n      if (selectNodeValue) {\r\n        var _findNodeOfTree;\r\n\r\n        var newChildren = ((_findNodeOfTree = findNodeOfTree(data, function (item) {\r\n          return shallowEqual(item[valueKey], selectNodeValue);\r\n        })) === null || _findNodeOfTree === void 0 ? void 0 : _findNodeOfTree.children) || [];\r\n        return _extends({}, getDerivedStateForCascade(nextProps, prevState, selectNodeValue, newChildren.map(function (item) {\r\n          return _stringToObject(item, labelKey, valueKey);\r\n        })), {\r\n          data: data,\r\n          flattenData: flattenTree(data)\r\n        });\r\n      }\r\n\r\n      return _extends({}, getDerivedStateForCascade(nextProps, prevState), {\r\n        flattenData: flattenTree(data),\r\n        data: data\r\n      });\r\n    }\r\n\r\n    if (typeof value !== 'undefined' && !shallowEqual(value, prevState.value)) {\r\n      return _extends({}, getDerivedStateForCascade(nextProps, prevState), {\r\n        value: value\r\n      });\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  var _proto = Cascader.prototype;\r\n\r\n  _proto.getValue = function getValue(nextProps) {\r\n    var _ref = nextProps || this.props,\r\n        value = _ref.value;\r\n\r\n    return _isUndefined(value) ? this.state.value : value;\r\n  };\r\n\r\n  /**\r\n   * 在 data 对象中的数据类型是字符串比如: ['foo']\r\n   * 通过这个行数可以把值转换成 [{name:'foo':value:'foo'}]\r\n   */\r\n  _proto.stringToObject = function stringToObject(value) {\r\n    var _this$props8 = this.props,\r\n        labelKey = _this$props8.labelKey,\r\n        valueKey = _this$props8.valueKey;\r\n    return _stringToObject(value, labelKey, valueKey);\r\n  };\r\n\r\n  _proto.someKeyword = function someKeyword(item) {\r\n    var labelKey = this.props.labelKey;\r\n    var searchKeyword = this.state.searchKeyword;\r\n\r\n    if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\r\n      return true;\r\n    }\r\n\r\n    if (item.parent && this.someKeyword(item.parent)) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  _proto.getSearchResult = function getSearchResult() {\r\n    var _this4 = this;\r\n\r\n    var childrenKey = this.props.childrenKey;\r\n    var flattenData = this.state.flattenData;\r\n    var items = [];\r\n    var result = flattenData.filter(function (item) {\r\n      if (item[childrenKey]) {\r\n        return false;\r\n      }\r\n\r\n      return _this4.someKeyword(item);\r\n    });\r\n\r\n    for (var i = 0; i < result.length; i++) {\r\n      items.push(result[i]);\r\n\r\n      if (i === 99) {\r\n        return items;\r\n      }\r\n    }\r\n\r\n    return items;\r\n  };\r\n\r\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\r\n    var locale = this.props.locale;\r\n    var searchKeyword = this.state.searchKeyword;\r\n\r\n    if (searchKeyword === '') {\r\n      return null;\r\n    }\r\n\r\n    var items = this.getSearchResult();\r\n    return React.createElement(\"div\", {\r\n      className: this.addPrefix('cascader-search-panel')\r\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\r\n      className: this.addPrefix('none')\r\n    }, locale.noResultsText));\r\n  };\r\n\r\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\r\n    var _classNames2;\r\n\r\n    var _this$state = this.state,\r\n        items = _this$state.items,\r\n        tempActivePaths = _this$state.tempActivePaths,\r\n        activePaths = _this$state.activePaths,\r\n        searchKeyword = _this$state.searchKeyword;\r\n    var _this$props9 = this.props,\r\n        renderMenu = _this$props9.renderMenu,\r\n        renderExtraFooter = _this$props9.renderExtraFooter,\r\n        menuClassName = _this$props9.menuClassName,\r\n        menuStyle = _this$props9.menuStyle,\r\n        searchable = _this$props9.searchable,\r\n        locale = _this$props9.locale,\r\n        inline = _this$props9.inline;\r\n    var classes = classNames(this.addPrefix('cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\r\n\r\n    var menuProps = _pick(this.props, Object.keys(_omit(dropdownMenuPropTypes, ['classPrefix'])));\r\n\r\n    return React.createElement(MenuWrapper, {\r\n      className: classes,\r\n      style: menuStyle\r\n    }, searchable && React.createElement(SearchBar, {\r\n      placeholder: locale.searchPlaceholder,\r\n      onChange: this.handleSearch,\r\n      value: searchKeyword\r\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\r\n      classPrefix: this.addPrefix('cascader-menu'),\r\n      ref: this.menuContainerRef,\r\n      cascadeItems: items,\r\n      cascadePathItems: tempActivePaths || activePaths,\r\n      activeItemValue: this.getValue(),\r\n      onSelect: this.handleSelect,\r\n      renderMenu: renderMenu\r\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\r\n  };\r\n\r\n  _proto.render = function render() {\r\n    var _this$props10 = this.props,\r\n        valueKey = _this$props10.valueKey,\r\n        labelKey = _this$props10.labelKey,\r\n        placeholder = _this$props10.placeholder,\r\n        renderValue = _this$props10.renderValue,\r\n        disabled = _this$props10.disabled,\r\n        cleanable = _this$props10.cleanable,\r\n        locale = _this$props10.locale,\r\n        toggleComponentClass = _this$props10.toggleComponentClass,\r\n        style = _this$props10.style,\r\n        onEnter = _this$props10.onEnter,\r\n        onExited = _this$props10.onExited,\r\n        onClean = _this$props10.onClean,\r\n        inline = _this$props10.inline,\r\n        positionRef = _this$props10.positionRef,\r\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"inline\", \"positionRef\"]);\r\n\r\n    if (inline) {\r\n      return this.renderDropdownMenu();\r\n    }\r\n\r\n    var _this$state2 = this.state,\r\n        activePaths = _this$state2.activePaths,\r\n        active = _this$state2.active;\r\n    var unhandled = getUnhandledProps(Cascader, rest);\r\n    var value = this.getValue();\r\n    /**\r\n     * 1.Have a value and the value is valid.\r\n     * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\r\n     */\r\n\r\n    var hasValue = activePaths.length > 0 || !_isNil(value) && _isFunction(renderValue);\r\n\r\n    var activeItemLabel = placeholder;\r\n\r\n    if (activePaths.length > 0) {\r\n      activeItemLabel = [];\r\n      activePaths.forEach(function (item, index) {\r\n        var key = item[valueKey] || item[labelKey];\r\n        activeItemLabel.push(React.createElement(\"span\", {\r\n          key: key\r\n        }, item[labelKey]));\r\n\r\n        if (index < activePaths.length - 1) {\r\n          activeItemLabel.push(React.createElement(\"span\", {\r\n            className: \"separator\",\r\n            key: key + \"-separator\"\r\n          }, ' / '));\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!_isNil(value) && _isFunction(renderValue)) {\r\n      activeItemLabel = renderValue(value, activePaths, activeItemLabel);\r\n    }\r\n\r\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\r\n    return React.createElement(IntlContext.Provider, {\r\n      value: locale\r\n    }, React.createElement(\"div\", {\r\n      className: classes,\r\n      style: style,\r\n      tabIndex: -1,\r\n      role: \"menu\",\r\n      ref: this.containerRef\r\n    }, React.createElement(PickerToggleTrigger, {\r\n      pickerProps: this.props,\r\n      ref: this.triggerRef,\r\n      positionRef: mergeRefs(this.positionRef, positionRef),\r\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\r\n      onExited: createChainedFunction(this.handleExit, onExited),\r\n      speaker: this.renderDropdownMenu()\r\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\r\n      componentClass: toggleComponentClass,\r\n      onClean: createChainedFunction(this.handleClean, onClean),\r\n      cleanable: cleanable && !disabled,\r\n      hasValue: hasValue,\r\n      active: active\r\n    }), activeItemLabel || React.createElement(FormattedMessage, {\r\n      id: \"placeholder\"\r\n    })))));\r\n  };\r\n\r\n  return Cascader;\r\n}(React.Component);\r\n\r\nCascader.propTypes = _extends({}, listPickerPropTypes, {\r\n  renderMenu: PropTypes.func,\r\n  onSelect: PropTypes.func,\r\n  onSearch: PropTypes.func,\r\n  cleanable: PropTypes.bool,\r\n  renderMenuItem: PropTypes.func,\r\n  menuWidth: PropTypes.number,\r\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n  searchable: PropTypes.bool,\r\n  inline: PropTypes.bool,\r\n  parentSelectable: PropTypes.bool\r\n});\r\nCascader.defaultProps = _extends({}, listPickerDefaultProps, {\r\n  searchable: true,\r\n  locale: {\r\n    placeholder: 'Select',\r\n    searchPlaceholder: 'Search',\r\n    noResultsText: 'No results found'\r\n  }\r\n});\r\npolyfill(Cascader);\r\nexport default defaultProps({\r\n  classPrefix: 'picker'\r\n})(Cascader);"],"mappings":"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"},"metadata":{},"sourceType":"module"}