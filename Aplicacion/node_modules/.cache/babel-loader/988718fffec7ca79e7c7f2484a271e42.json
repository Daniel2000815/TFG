{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport _isFunction from \"lodash/isFunction\";\nimport _pick from \"lodash/pick\";\nimport _get from \"lodash/get\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport shallowEqualArray from '../utils/shallowEqualArray';\nimport { polyfill } from 'react-lifecycles-compat';\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\nimport Checkbox from '../Checkbox';\nimport createUtils from './utils';\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\nimport { PickerToggle, MenuWrapper, SearchBar, SelectedElement, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes';\n\nvar MultiCascader = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(MultiCascader, _React$Component);\n\n  function MultiCascader(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.isControlled = null;\n    _this.menuContainerRef = void 0;\n    _this.positionRef = void 0;\n    _this.triggerRef = void 0;\n\n    _this.handleCheck = function (item, event, checked) {\n      var _this$props = _this.props,\n          valueKey = _this$props.valueKey,\n          onChange = _this$props.onChange,\n          cascade = _this$props.cascade,\n          uncheckableItemValues = _this$props.uncheckableItemValues;\n      var itemValue = item[valueKey];\n      var value = [];\n\n      if (cascade) {\n        value = MultiCascader.utils.splitValue(item, checked, _this.getValue(), uncheckableItemValues).value;\n      } else {\n        value = _this.getValue();\n\n        if (checked) {\n          value.push(itemValue);\n        } else {\n          value = value.filter(function (n) {\n            return n !== itemValue;\n          });\n        }\n      }\n\n      if (!_this.isControlled) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\n    };\n\n    _this.handleChangeForSearchItem = function (value, checked, event) {\n      _this.handleCheck(value, event, checked);\n    };\n\n    _this.handleSelect = function (node, cascadeItems, activePaths, event) {\n      var _this$props2 = _this.props,\n          onSelect = _this$props2.onSelect,\n          valueKey = _this$props2.valueKey,\n          childrenKey = _this$props2.childrenKey;\n\n      _this.setState({\n        selectNode: node,\n        items: cascadeItems,\n        activePaths: activePaths\n      }, function () {\n        var _this$positionRef$cur, _this$positionRef$cur2;\n\n        (_this$positionRef$cur = _this.positionRef.current) === null || _this$positionRef$cur === void 0 ? void 0 : (_this$positionRef$cur2 = _this$positionRef$cur.updatePosition) === null || _this$positionRef$cur2 === void 0 ? void 0 : _this$positionRef$cur2.call(_this$positionRef$cur);\n      });\n\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, node[valueKey], {\n        valueKey: valueKey,\n        childrenKey: childrenKey\n      }), event);\n    };\n\n    _this.handleSearch = function (searchKeyword, event) {\n      var _this$props$onSearch, _this$props3;\n\n      _this.setState({\n        searchKeyword: searchKeyword\n      });\n\n      (_this$props$onSearch = (_this$props3 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props3, searchKeyword, event);\n    };\n\n    _this.handleCloseDropdown = function () {\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\n\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\n    };\n\n    _this.handleOpenDropdown = function () {\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\n\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\n    };\n\n    _this.open = function () {\n      var _this$handleOpenDropd, _this2;\n\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\n    };\n\n    _this.close = function () {\n      var _this$handleCloseDrop, _this3;\n\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\n    };\n\n    _this.handleClean = function (event) {\n      var _this$props4 = _this.props,\n          disabled = _this$props4.disabled,\n          onChange = _this$props4.onChange,\n          data = _this$props4.data;\n\n      if (disabled) {\n        return;\n      }\n\n      var nextState = {\n        items: [data],\n        selectNode: null,\n        activePaths: []\n      };\n\n      if (!_this.isControlled) {\n        nextState.value = [];\n      }\n\n      _this.setState(nextState);\n\n      onChange === null || onChange === void 0 ? void 0 : onChange([], event);\n    };\n\n    _this.handleEntered = function () {\n      var _this$props$onOpen, _this$props5;\n\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\n\n      _this.setState({\n        active: true\n      });\n    };\n\n    _this.handleExit = function () {\n      var _this$props$onClose, _this$props6;\n\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\n\n      _this.setState({\n        searchKeyword: '',\n        active: false\n      });\n    };\n\n    _this.addPrefix = function (name) {\n      return prefix(_this.props.classPrefix)(name);\n    };\n\n    _this.renderSearchRow = function (item, key) {\n      var _extends2, _classNames;\n\n      var _this$props7 = _this.props,\n          labelKey = _this$props7.labelKey,\n          valueKey = _this$props7.valueKey,\n          cascade = _this$props7.cascade,\n          _this$props7$disabled = _this$props7.disabledItemValues,\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\n      var searchKeyword = _this.state.searchKeyword;\n\n      var values = _this.getValue();\n\n      var nodes = getNodeParents(item);\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\n      var labelElements = [];\n      var a = item[labelKey].split(regx);\n      var b = item[labelKey].match(regx);\n\n      for (var i = 0; i < a.length; i++) {\n        labelElements.push(a[i]);\n\n        if (b[i]) {\n          labelElements.push(React.createElement(\"strong\", {\n            key: i\n          }, b[i]));\n        }\n      }\n\n      nodes.push(_extends({}, item, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2)));\n      var active = values.some(function (value) {\n        if (cascade) {\n          return nodes.some(function (node) {\n            return node[valueKey] === value;\n          });\n        }\n\n        return item[valueKey] === value;\n      });\n      var disabled = disabledItemValues.some(function (value) {\n        return nodes.some(function (node) {\n          return node[valueKey] === value;\n        });\n      });\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\n      return React.createElement(\"div\", {\n        key: key,\n        className: itemClasses\n      }, React.createElement(Checkbox, {\n        disabled: disabled,\n        checked: active,\n        value: item,\n        indeterminate: cascade && !active && MultiCascader.utils.isSomeChildChecked(item, values),\n        onChange: _this.handleChangeForSearchItem\n      }, React.createElement(\"span\", {\n        className: _this.addPrefix('cascader-cols')\n      }, nodes.map(function (node, index) {\n        return React.createElement(\"span\", {\n          key: \"col-\" + index,\n          className: _this.addPrefix('cascader-col')\n        }, node[labelKey]);\n      }))));\n    };\n\n    var _data = props.data,\n        _value = props.value,\n        defaultValue = props.defaultValue;\n    var initState = {\n      data: _data,\n      searchKeyword: '',\n      prevValue: _value,\n      value: defaultValue || [],\n      selectNode: null,\n\n      /**\r\n       * 选中值的路径\r\n       */\n      activePaths: []\n    };\n    MultiCascader.utils = createUtils(props);\n    var flattenData = flattenTree(_data, props.childrenKey);\n    _this.isControlled = !_isUndefined(_value);\n    _this.state = _extends({}, initState, {\n      flattenData: flattenData,\n\n      /**\r\n       * 用于展示面板的数据列表，是一个二维的数组\r\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\r\n       */\n      items: [flattenData.filter(function (item) {\n        return !item.parent;\n      })]\n    }, MultiCascader.getCascadeState(props, flattenData)); // for test\n\n    _this.menuContainerRef = React.createRef();\n    _this.positionRef = React.createRef();\n    _this.triggerRef = React.createRef();\n    return _this;\n  }\n\n  MultiCascader.getCascadeState = function getCascadeState(nextProps, flattenData, nextValue) {\n    var data = nextProps.data,\n        cascade = nextProps.cascade,\n        value = nextProps.value,\n        defaultValue = nextProps.defaultValue,\n        uncheckableItemValues = nextProps.uncheckableItemValues;\n    var cascadeValue = nextValue || value || defaultValue || [];\n\n    if (cascade && data) {\n      cascadeValue = MultiCascader.utils.transformValue(cascadeValue, flattenData, uncheckableItemValues);\n    }\n\n    return {\n      value: cascadeValue\n    };\n  };\n\n  MultiCascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var data = nextProps.data,\n        valueKey = nextProps.valueKey,\n        childrenKey = nextProps.childrenKey;\n    var value = nextProps.value || prevState.value || [];\n    var prevValue = prevState.prevValue,\n        _prevState$selectNode = prevState.selectNode,\n        selectNode = _prevState$selectNode === void 0 ? {} : _prevState$selectNode,\n        items = prevState.items;\n    var flattenData = prevState.flattenData;\n    var isChangedData = data !== prevState.data;\n    var isChangedValue = !shallowEqualArray(prevValue, nextProps.value);\n\n    if (isChangedData || isChangedValue) {\n      if (isChangedData) {\n        flattenData = flattenTree(data, nextProps.childrenKey);\n      }\n      /**\r\n       * 如果更新了 data,\r\n       * 首先获取到被点击节点的值 `selectNode`， 然后再拿到新增后的 `newChildren`,\r\n       */\n\n\n      var nextSelectNode = flattenData.find(function (n) {\n        return selectNode && n[valueKey] === selectNode[valueKey];\n      });\n      var newChildren = (_get(nextSelectNode, childrenKey) || []).map(function (item) {\n        item.parent = nextSelectNode;\n        return item;\n      });\n\n      if (newChildren.length && items) {\n        items[items.length - 1] = newChildren;\n      }\n\n      var nextState = _extends({\n        selectNode: nextSelectNode,\n        flattenData: flattenData,\n        data: data,\n        items: MultiCascader.utils.getItems(nextSelectNode, flattenData)\n      }, MultiCascader.getCascadeState(nextProps, flattenData, value));\n\n      if (isChangedValue) {\n        nextState.prevValue = nextProps.value;\n      }\n\n      return nextState;\n    }\n\n    return null;\n  };\n\n  var _proto = MultiCascader.prototype;\n\n  _proto.getValue = function getValue() {\n    return this.state.value || [];\n  };\n\n  _proto.getSearchResult = function getSearchResult() {\n    var _this$props8 = this.props,\n        labelKey = _this$props8.labelKey,\n        valueKey = _this$props8.valueKey,\n        _this$props8$unchecka = _this$props8.uncheckableItemValues,\n        uncheckableItemValues = _this$props8$unchecka === void 0 ? [] : _this$props8$unchecka;\n    var _this$state = this.state,\n        searchKeyword = _this$state.searchKeyword,\n        flattenData = _this$state.flattenData;\n    var items = [];\n    var result = flattenData.filter(function (item) {\n      if (uncheckableItemValues.some(function (value) {\n        return item[valueKey] === value;\n      })) {\n        return false;\n      }\n\n      if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\n        return true;\n      }\n\n      return false;\n    });\n\n    for (var i = 0; i < result.length; i++) {\n      items.push(result[i]);\n\n      if (i === 99) {\n        return items;\n      }\n    }\n\n    return items;\n  };\n\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\n    var locale = this.props.locale;\n    var searchKeyword = this.state.searchKeyword;\n\n    if (searchKeyword === '') {\n      return null;\n    }\n\n    var items = this.getSearchResult();\n    return React.createElement(\"div\", {\n      className: this.addPrefix('cascader-search-panel')\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\n      className: this.addPrefix('none')\n    }, locale.noResultsText));\n  };\n\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\n    var _classNames2;\n\n    var _this$state2 = this.state,\n        items = _this$state2.items,\n        activePaths = _this$state2.activePaths,\n        searchKeyword = _this$state2.searchKeyword;\n    var _this$props9 = this.props,\n        renderMenu = _this$props9.renderMenu,\n        renderExtraFooter = _this$props9.renderExtraFooter,\n        menuClassName = _this$props9.menuClassName,\n        menuStyle = _this$props9.menuStyle,\n        classPrefix = _this$props9.classPrefix,\n        searchable = _this$props9.searchable,\n        locale = _this$props9.locale,\n        inline = _this$props9.inline;\n    var classes = classNames(this.addPrefix('cascader-menu'), this.addPrefix('multi-cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\n\n    var menuProps = _pick(this.props, Object.keys(dropdownMenuPropTypes));\n\n    return React.createElement(MenuWrapper, {\n      className: classes,\n      style: menuStyle\n    }, searchable && React.createElement(SearchBar, {\n      placeholder: locale.searchPlaceholder,\n      onChange: this.handleSearch,\n      value: searchKeyword\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\n      classPrefix: classPrefix,\n      ref: this.menuContainerRef,\n      cascadeItems: items,\n      cascadePathItems: activePaths,\n      value: this.getValue(),\n      onSelect: this.handleSelect,\n      onCheck: this.handleCheck,\n      renderMenu: renderMenu\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\n  };\n\n  _proto.render = function render() {\n    var _this$props$value;\n\n    var _this$props10 = this.props,\n        valueKey = _this$props10.valueKey,\n        labelKey = _this$props10.labelKey,\n        childrenKey = _this$props10.childrenKey,\n        placeholder = _this$props10.placeholder,\n        renderValue = _this$props10.renderValue,\n        disabled = _this$props10.disabled,\n        cleanable = _this$props10.cleanable,\n        locale = _this$props10.locale,\n        toggleComponentClass = _this$props10.toggleComponentClass,\n        style = _this$props10.style,\n        onEnter = _this$props10.onEnter,\n        onExited = _this$props10.onExited,\n        onClean = _this$props10.onClean,\n        countable = _this$props10.countable,\n        cascade = _this$props10.cascade,\n        inline = _this$props10.inline,\n        positionRef = _this$props10.positionRef,\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"childrenKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"countable\", \"cascade\", \"inline\", \"positionRef\"]);\n\n    if (inline) {\n      return this.renderDropdownMenu();\n    }\n\n    var flattenData = this.state.flattenData;\n    var unhandled = getUnhandledProps(MultiCascader, rest);\n    var value = this.getValue();\n    var selectedItems = flattenData.filter(function (item) {\n      return value.some(function (v) {\n        return v === item[valueKey];\n      });\n    }) || [];\n    /**\r\n     * 1.Have a value and the value is valid.\r\n     * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\r\n     */\n\n    var hasValue = selectedItems.length > 0 || ((_this$props$value = this.props.value) === null || _this$props$value === void 0 ? void 0 : _this$props$value.length) > 0 && _isFunction(renderValue);\n\n    var selectedElement = placeholder;\n\n    if (selectedItems.length > 0) {\n      selectedElement = React.createElement(SelectedElement, {\n        selectedItems: selectedItems,\n        countable: countable,\n        valueKey: valueKey,\n        labelKey: labelKey,\n        childrenKey: childrenKey,\n        prefix: this.addPrefix,\n        cascade: cascade,\n        locale: locale\n      });\n    }\n\n    if (hasValue && _isFunction(renderValue)) {\n      selectedElement = renderValue((value === null || value === void 0 ? void 0 : value.length) > 0 ? value : this.props.value, selectedItems, selectedElement);\n    }\n\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\n    return React.createElement(\"div\", {\n      className: classes,\n      style: style,\n      tabIndex: -1,\n      role: \"menu\"\n    }, React.createElement(PickerToggleTrigger, {\n      pickerProps: this.props,\n      ref: this.triggerRef,\n      positionRef: mergeRefs(this.positionRef, positionRef),\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\n      onExited: createChainedFunction(this.handleExit, onExited),\n      speaker: this.renderDropdownMenu()\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\n      componentClass: toggleComponentClass,\n      onClean: createChainedFunction(this.handleClean, onClean),\n      cleanable: cleanable && !disabled,\n      hasValue: hasValue,\n      active: this.state.active\n    }), selectedElement || locale.placeholder)));\n  };\n\n  return MultiCascader;\n}(React.Component);\n\nMultiCascader.propTypes = _extends({}, listPickerPropTypes, {\n  cascade: PropTypes.bool,\n  inline: PropTypes.bool,\n  countable: PropTypes.bool,\n  menuWidth: PropTypes.number,\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  uncheckableItemValues: PropTypes.array,\n  searchable: PropTypes.bool,\n  renderMenuItem: PropTypes.func,\n  renderMenu: PropTypes.func,\n  onSearch: PropTypes.func,\n  onSelect: PropTypes.func\n});\nMultiCascader.defaultProps = _extends({}, listPickerDefaultProps, {\n  searchable: true,\n  countable: true,\n  cascade: true,\n  uncheckableItemValues: [],\n  locale: {\n    placeholder: 'Select',\n    checkAll: 'All',\n    searchPlaceholder: 'Search',\n    noResultsText: 'No results found'\n  }\n});\nMultiCascader.utils = {};\npolyfill(MultiCascader);\nexport default defaultProps({\n  classPrefix: 'picker'\n})(MultiCascader);","map":{"version":3,"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","_isFunction","_pick","_get","_isUndefined","React","PropTypes","classNames","shallowEqualArray","polyfill","DropdownMenu","dropdownMenuPropTypes","Checkbox","createUtils","flattenTree","getNodeParents","defaultProps","prefix","getUnhandledProps","createChainedFunction","mergeRefs","getSafeRegExpString","PickerToggle","MenuWrapper","SearchBar","SelectedElement","PickerToggleTrigger","getToggleWrapperClassName","createConcatChildrenFunction","listPickerPropTypes","listPickerDefaultProps","MultiCascader","_React$Component","props","_this","call","isControlled","menuContainerRef","positionRef","triggerRef","handleCheck","item","event","checked","_this$props","valueKey","onChange","cascade","uncheckableItemValues","itemValue","value","utils","splitValue","getValue","push","filter","n","setState","handleChangeForSearchItem","handleSelect","node","cascadeItems","activePaths","_this$props2","onSelect","childrenKey","selectNode","items","_this$positionRef$cur","_this$positionRef$cur2","current","updatePosition","handleSearch","searchKeyword","_this$props$onSearch","_this$props3","onSearch","handleCloseDropdown","_this$triggerRef$curr","_this$triggerRef$curr2","hide","handleOpenDropdown","_this$triggerRef$curr3","_this$triggerRef$curr4","show","open","_this$handleOpenDropd","_this2","close","_this$handleCloseDrop","_this3","handleClean","_this$props4","disabled","data","nextState","handleEntered","_this$props$onOpen","_this$props5","onOpen","active","handleExit","_this$props$onClose","_this$props6","onClose","addPrefix","name","classPrefix","renderSearchRow","key","_extends2","_classNames","_this$props7","labelKey","_this$props7$disabled","disabledItemValues","state","values","nodes","regx","RegExp","labelElements","a","split","b","match","i","length","createElement","some","itemClasses","className","indeterminate","isSomeChildChecked","map","index","_data","_value","defaultValue","initState","prevValue","flattenData","parent","getCascadeState","createRef","nextProps","nextValue","cascadeValue","transformValue","getDerivedStateFromProps","prevState","_prevState$selectNode","isChangedData","isChangedValue","nextSelectNode","find","newChildren","getItems","_proto","prototype","getSearchResult","_this$props8","_this$props8$unchecka","_this$state","result","renderSearchResultPanel","locale","noResultsText","renderDropdownMenu","_classNames2","_this$state2","_this$props9","renderMenu","renderExtraFooter","menuClassName","menuStyle","searchable","inline","classes","menuProps","Object","keys","style","placeholder","searchPlaceholder","ref","cascadePathItems","onCheck","render","_this$props$value","_this$props10","renderValue","cleanable","toggleComponentClass","onEnter","onExited","onClean","countable","rest","unhandled","selectedItems","v","hasValue","selectedElement","tabIndex","role","pickerProps","speaker","componentClass","Component","propTypes","bool","menuWidth","number","menuHeight","oneOfType","string","array","renderMenuItem","func","checkAll"],"sources":["G:/gitlab/TFG/Aplicacion/node_modules/rsuite/es/MultiCascader/MultiCascader.js"],"sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\r\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\r\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\r\nimport _isFunction from \"lodash/isFunction\";\r\nimport _pick from \"lodash/pick\";\r\nimport _get from \"lodash/get\";\r\nimport _isUndefined from \"lodash/isUndefined\";\r\nimport * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport shallowEqualArray from '../utils/shallowEqualArray';\r\nimport { polyfill } from 'react-lifecycles-compat';\r\nimport DropdownMenu, { dropdownMenuPropTypes } from './DropdownMenu';\r\nimport Checkbox from '../Checkbox';\r\nimport createUtils from './utils';\r\nimport { flattenTree, getNodeParents } from '../utils/treeUtils';\r\nimport { defaultProps, prefix, getUnhandledProps, createChainedFunction, mergeRefs } from '../utils';\r\nimport getSafeRegExpString from '../utils/getSafeRegExpString';\r\nimport { PickerToggle, MenuWrapper, SearchBar, SelectedElement, PickerToggleTrigger, getToggleWrapperClassName, createConcatChildrenFunction } from '../Picker';\r\nimport { listPickerPropTypes, listPickerDefaultProps } from '../Picker/propTypes';\r\n\r\nvar MultiCascader =\r\n/*#__PURE__*/\r\nfunction (_React$Component) {\r\n  _inheritsLoose(MultiCascader, _React$Component);\r\n\r\n  function MultiCascader(props) {\r\n    var _this;\r\n\r\n    _this = _React$Component.call(this, props) || this;\r\n    _this.isControlled = null;\r\n    _this.menuContainerRef = void 0;\r\n    _this.positionRef = void 0;\r\n    _this.triggerRef = void 0;\r\n\r\n    _this.handleCheck = function (item, event, checked) {\r\n      var _this$props = _this.props,\r\n          valueKey = _this$props.valueKey,\r\n          onChange = _this$props.onChange,\r\n          cascade = _this$props.cascade,\r\n          uncheckableItemValues = _this$props.uncheckableItemValues;\r\n      var itemValue = item[valueKey];\r\n      var value = [];\r\n\r\n      if (cascade) {\r\n        value = MultiCascader.utils.splitValue(item, checked, _this.getValue(), uncheckableItemValues).value;\r\n      } else {\r\n        value = _this.getValue();\r\n\r\n        if (checked) {\r\n          value.push(itemValue);\r\n        } else {\r\n          value = value.filter(function (n) {\r\n            return n !== itemValue;\r\n          });\r\n        }\r\n      }\r\n\r\n      if (!_this.isControlled) {\r\n        _this.setState({\r\n          value: value\r\n        });\r\n      }\r\n\r\n      onChange === null || onChange === void 0 ? void 0 : onChange(value, event);\r\n    };\r\n\r\n    _this.handleChangeForSearchItem = function (value, checked, event) {\r\n      _this.handleCheck(value, event, checked);\r\n    };\r\n\r\n    _this.handleSelect = function (node, cascadeItems, activePaths, event) {\r\n      var _this$props2 = _this.props,\r\n          onSelect = _this$props2.onSelect,\r\n          valueKey = _this$props2.valueKey,\r\n          childrenKey = _this$props2.childrenKey;\r\n\r\n      _this.setState({\r\n        selectNode: node,\r\n        items: cascadeItems,\r\n        activePaths: activePaths\r\n      }, function () {\r\n        var _this$positionRef$cur, _this$positionRef$cur2;\r\n\r\n        (_this$positionRef$cur = _this.positionRef.current) === null || _this$positionRef$cur === void 0 ? void 0 : (_this$positionRef$cur2 = _this$positionRef$cur.updatePosition) === null || _this$positionRef$cur2 === void 0 ? void 0 : _this$positionRef$cur2.call(_this$positionRef$cur);\r\n      });\r\n\r\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(node, activePaths, createConcatChildrenFunction(node, node[valueKey], {\r\n        valueKey: valueKey,\r\n        childrenKey: childrenKey\r\n      }), event);\r\n    };\r\n\r\n    _this.handleSearch = function (searchKeyword, event) {\r\n      var _this$props$onSearch, _this$props3;\r\n\r\n      _this.setState({\r\n        searchKeyword: searchKeyword\r\n      });\r\n\r\n      (_this$props$onSearch = (_this$props3 = _this.props).onSearch) === null || _this$props$onSearch === void 0 ? void 0 : _this$props$onSearch.call(_this$props3, searchKeyword, event);\r\n    };\r\n\r\n    _this.handleCloseDropdown = function () {\r\n      var _this$triggerRef$curr, _this$triggerRef$curr2;\r\n\r\n      (_this$triggerRef$curr = _this.triggerRef.current) === null || _this$triggerRef$curr === void 0 ? void 0 : (_this$triggerRef$curr2 = _this$triggerRef$curr.hide) === null || _this$triggerRef$curr2 === void 0 ? void 0 : _this$triggerRef$curr2.call(_this$triggerRef$curr);\r\n    };\r\n\r\n    _this.handleOpenDropdown = function () {\r\n      var _this$triggerRef$curr3, _this$triggerRef$curr4;\r\n\r\n      (_this$triggerRef$curr3 = _this.triggerRef.current) === null || _this$triggerRef$curr3 === void 0 ? void 0 : (_this$triggerRef$curr4 = _this$triggerRef$curr3.show) === null || _this$triggerRef$curr4 === void 0 ? void 0 : _this$triggerRef$curr4.call(_this$triggerRef$curr3);\r\n    };\r\n\r\n    _this.open = function () {\r\n      var _this$handleOpenDropd, _this2;\r\n\r\n      (_this$handleOpenDropd = (_this2 = _this).handleOpenDropdown) === null || _this$handleOpenDropd === void 0 ? void 0 : _this$handleOpenDropd.call(_this2);\r\n    };\r\n\r\n    _this.close = function () {\r\n      var _this$handleCloseDrop, _this3;\r\n\r\n      (_this$handleCloseDrop = (_this3 = _this).handleCloseDropdown) === null || _this$handleCloseDrop === void 0 ? void 0 : _this$handleCloseDrop.call(_this3);\r\n    };\r\n\r\n    _this.handleClean = function (event) {\r\n      var _this$props4 = _this.props,\r\n          disabled = _this$props4.disabled,\r\n          onChange = _this$props4.onChange,\r\n          data = _this$props4.data;\r\n\r\n      if (disabled) {\r\n        return;\r\n      }\r\n\r\n      var nextState = {\r\n        items: [data],\r\n        selectNode: null,\r\n        activePaths: []\r\n      };\r\n\r\n      if (!_this.isControlled) {\r\n        nextState.value = [];\r\n      }\r\n\r\n      _this.setState(nextState);\r\n\r\n      onChange === null || onChange === void 0 ? void 0 : onChange([], event);\r\n    };\r\n\r\n    _this.handleEntered = function () {\r\n      var _this$props$onOpen, _this$props5;\r\n\r\n      (_this$props$onOpen = (_this$props5 = _this.props).onOpen) === null || _this$props$onOpen === void 0 ? void 0 : _this$props$onOpen.call(_this$props5);\r\n\r\n      _this.setState({\r\n        active: true\r\n      });\r\n    };\r\n\r\n    _this.handleExit = function () {\r\n      var _this$props$onClose, _this$props6;\r\n\r\n      (_this$props$onClose = (_this$props6 = _this.props).onClose) === null || _this$props$onClose === void 0 ? void 0 : _this$props$onClose.call(_this$props6);\r\n\r\n      _this.setState({\r\n        searchKeyword: '',\r\n        active: false\r\n      });\r\n    };\r\n\r\n    _this.addPrefix = function (name) {\r\n      return prefix(_this.props.classPrefix)(name);\r\n    };\r\n\r\n    _this.renderSearchRow = function (item, key) {\r\n      var _extends2, _classNames;\r\n\r\n      var _this$props7 = _this.props,\r\n          labelKey = _this$props7.labelKey,\r\n          valueKey = _this$props7.valueKey,\r\n          cascade = _this$props7.cascade,\r\n          _this$props7$disabled = _this$props7.disabledItemValues,\r\n          disabledItemValues = _this$props7$disabled === void 0 ? [] : _this$props7$disabled;\r\n      var searchKeyword = _this.state.searchKeyword;\r\n\r\n      var values = _this.getValue();\r\n\r\n      var nodes = getNodeParents(item);\r\n      var regx = new RegExp(getSafeRegExpString(searchKeyword), 'ig');\r\n      var labelElements = [];\r\n      var a = item[labelKey].split(regx);\r\n      var b = item[labelKey].match(regx);\r\n\r\n      for (var i = 0; i < a.length; i++) {\r\n        labelElements.push(a[i]);\r\n\r\n        if (b[i]) {\r\n          labelElements.push(React.createElement(\"strong\", {\r\n            key: i\r\n          }, b[i]));\r\n        }\r\n      }\r\n\r\n      nodes.push(_extends({}, item, (_extends2 = {}, _extends2[labelKey] = labelElements, _extends2)));\r\n      var active = values.some(function (value) {\r\n        if (cascade) {\r\n          return nodes.some(function (node) {\r\n            return node[valueKey] === value;\r\n          });\r\n        }\r\n\r\n        return item[valueKey] === value;\r\n      });\r\n      var disabled = disabledItemValues.some(function (value) {\r\n        return nodes.some(function (node) {\r\n          return node[valueKey] === value;\r\n        });\r\n      });\r\n      var itemClasses = classNames(_this.addPrefix('cascader-row'), (_classNames = {}, _classNames[_this.addPrefix('cascader-row-disabled')] = disabled, _classNames));\r\n      return React.createElement(\"div\", {\r\n        key: key,\r\n        className: itemClasses\r\n      }, React.createElement(Checkbox, {\r\n        disabled: disabled,\r\n        checked: active,\r\n        value: item,\r\n        indeterminate: cascade && !active && MultiCascader.utils.isSomeChildChecked(item, values),\r\n        onChange: _this.handleChangeForSearchItem\r\n      }, React.createElement(\"span\", {\r\n        className: _this.addPrefix('cascader-cols')\r\n      }, nodes.map(function (node, index) {\r\n        return React.createElement(\"span\", {\r\n          key: \"col-\" + index,\r\n          className: _this.addPrefix('cascader-col')\r\n        }, node[labelKey]);\r\n      }))));\r\n    };\r\n\r\n    var _data = props.data,\r\n        _value = props.value,\r\n        defaultValue = props.defaultValue;\r\n    var initState = {\r\n      data: _data,\r\n      searchKeyword: '',\r\n      prevValue: _value,\r\n      value: defaultValue || [],\r\n      selectNode: null,\r\n\r\n      /**\r\n       * 选中值的路径\r\n       */\r\n      activePaths: []\r\n    };\r\n    MultiCascader.utils = createUtils(props);\r\n    var flattenData = flattenTree(_data, props.childrenKey);\r\n    _this.isControlled = !_isUndefined(_value);\r\n    _this.state = _extends({}, initState, {\r\n      flattenData: flattenData,\r\n\r\n      /**\r\n       * 用于展示面板的数据列表，是一个二维的数组\r\n       * 是通过 data 树结构转换成的二维的数组，其中只包含页面上展示的数据\r\n       */\r\n      items: [flattenData.filter(function (item) {\r\n        return !item.parent;\r\n      })]\r\n    }, MultiCascader.getCascadeState(props, flattenData)); // for test\r\n\r\n    _this.menuContainerRef = React.createRef();\r\n    _this.positionRef = React.createRef();\r\n    _this.triggerRef = React.createRef();\r\n    return _this;\r\n  }\r\n\r\n  MultiCascader.getCascadeState = function getCascadeState(nextProps, flattenData, nextValue) {\r\n    var data = nextProps.data,\r\n        cascade = nextProps.cascade,\r\n        value = nextProps.value,\r\n        defaultValue = nextProps.defaultValue,\r\n        uncheckableItemValues = nextProps.uncheckableItemValues;\r\n    var cascadeValue = nextValue || value || defaultValue || [];\r\n\r\n    if (cascade && data) {\r\n      cascadeValue = MultiCascader.utils.transformValue(cascadeValue, flattenData, uncheckableItemValues);\r\n    }\r\n\r\n    return {\r\n      value: cascadeValue\r\n    };\r\n  };\r\n\r\n  MultiCascader.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\r\n    var data = nextProps.data,\r\n        valueKey = nextProps.valueKey,\r\n        childrenKey = nextProps.childrenKey;\r\n    var value = nextProps.value || prevState.value || [];\r\n    var prevValue = prevState.prevValue,\r\n        _prevState$selectNode = prevState.selectNode,\r\n        selectNode = _prevState$selectNode === void 0 ? {} : _prevState$selectNode,\r\n        items = prevState.items;\r\n    var flattenData = prevState.flattenData;\r\n    var isChangedData = data !== prevState.data;\r\n    var isChangedValue = !shallowEqualArray(prevValue, nextProps.value);\r\n\r\n    if (isChangedData || isChangedValue) {\r\n      if (isChangedData) {\r\n        flattenData = flattenTree(data, nextProps.childrenKey);\r\n      }\r\n      /**\r\n       * 如果更新了 data,\r\n       * 首先获取到被点击节点的值 `selectNode`， 然后再拿到新增后的 `newChildren`,\r\n       */\r\n\r\n\r\n      var nextSelectNode = flattenData.find(function (n) {\r\n        return selectNode && n[valueKey] === selectNode[valueKey];\r\n      });\r\n      var newChildren = (_get(nextSelectNode, childrenKey) || []).map(function (item) {\r\n        item.parent = nextSelectNode;\r\n        return item;\r\n      });\r\n\r\n      if (newChildren.length && items) {\r\n        items[items.length - 1] = newChildren;\r\n      }\r\n\r\n      var nextState = _extends({\r\n        selectNode: nextSelectNode,\r\n        flattenData: flattenData,\r\n        data: data,\r\n        items: MultiCascader.utils.getItems(nextSelectNode, flattenData)\r\n      }, MultiCascader.getCascadeState(nextProps, flattenData, value));\r\n\r\n      if (isChangedValue) {\r\n        nextState.prevValue = nextProps.value;\r\n      }\r\n\r\n      return nextState;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  var _proto = MultiCascader.prototype;\r\n\r\n  _proto.getValue = function getValue() {\r\n    return this.state.value || [];\r\n  };\r\n\r\n  _proto.getSearchResult = function getSearchResult() {\r\n    var _this$props8 = this.props,\r\n        labelKey = _this$props8.labelKey,\r\n        valueKey = _this$props8.valueKey,\r\n        _this$props8$unchecka = _this$props8.uncheckableItemValues,\r\n        uncheckableItemValues = _this$props8$unchecka === void 0 ? [] : _this$props8$unchecka;\r\n    var _this$state = this.state,\r\n        searchKeyword = _this$state.searchKeyword,\r\n        flattenData = _this$state.flattenData;\r\n    var items = [];\r\n    var result = flattenData.filter(function (item) {\r\n      if (uncheckableItemValues.some(function (value) {\r\n        return item[valueKey] === value;\r\n      })) {\r\n        return false;\r\n      }\r\n\r\n      if (item[labelKey].match(new RegExp(getSafeRegExpString(searchKeyword), 'i'))) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n\r\n    for (var i = 0; i < result.length; i++) {\r\n      items.push(result[i]);\r\n\r\n      if (i === 99) {\r\n        return items;\r\n      }\r\n    }\r\n\r\n    return items;\r\n  };\r\n\r\n  _proto.renderSearchResultPanel = function renderSearchResultPanel() {\r\n    var locale = this.props.locale;\r\n    var searchKeyword = this.state.searchKeyword;\r\n\r\n    if (searchKeyword === '') {\r\n      return null;\r\n    }\r\n\r\n    var items = this.getSearchResult();\r\n    return React.createElement(\"div\", {\r\n      className: this.addPrefix('cascader-search-panel')\r\n    }, items.length ? items.map(this.renderSearchRow) : React.createElement(\"div\", {\r\n      className: this.addPrefix('none')\r\n    }, locale.noResultsText));\r\n  };\r\n\r\n  _proto.renderDropdownMenu = function renderDropdownMenu() {\r\n    var _classNames2;\r\n\r\n    var _this$state2 = this.state,\r\n        items = _this$state2.items,\r\n        activePaths = _this$state2.activePaths,\r\n        searchKeyword = _this$state2.searchKeyword;\r\n    var _this$props9 = this.props,\r\n        renderMenu = _this$props9.renderMenu,\r\n        renderExtraFooter = _this$props9.renderExtraFooter,\r\n        menuClassName = _this$props9.menuClassName,\r\n        menuStyle = _this$props9.menuStyle,\r\n        classPrefix = _this$props9.classPrefix,\r\n        searchable = _this$props9.searchable,\r\n        locale = _this$props9.locale,\r\n        inline = _this$props9.inline;\r\n    var classes = classNames(this.addPrefix('cascader-menu'), this.addPrefix('multi-cascader-menu'), menuClassName, (_classNames2 = {}, _classNames2[this.addPrefix('inline')] = inline, _classNames2));\r\n\r\n    var menuProps = _pick(this.props, Object.keys(dropdownMenuPropTypes));\r\n\r\n    return React.createElement(MenuWrapper, {\r\n      className: classes,\r\n      style: menuStyle\r\n    }, searchable && React.createElement(SearchBar, {\r\n      placeholder: locale.searchPlaceholder,\r\n      onChange: this.handleSearch,\r\n      value: searchKeyword\r\n    }), this.renderSearchResultPanel(), searchKeyword === '' && React.createElement(DropdownMenu, _extends({}, menuProps, {\r\n      classPrefix: classPrefix,\r\n      ref: this.menuContainerRef,\r\n      cascadeItems: items,\r\n      cascadePathItems: activePaths,\r\n      value: this.getValue(),\r\n      onSelect: this.handleSelect,\r\n      onCheck: this.handleCheck,\r\n      renderMenu: renderMenu\r\n    })), renderExtraFooter === null || renderExtraFooter === void 0 ? void 0 : renderExtraFooter());\r\n  };\r\n\r\n  _proto.render = function render() {\r\n    var _this$props$value;\r\n\r\n    var _this$props10 = this.props,\r\n        valueKey = _this$props10.valueKey,\r\n        labelKey = _this$props10.labelKey,\r\n        childrenKey = _this$props10.childrenKey,\r\n        placeholder = _this$props10.placeholder,\r\n        renderValue = _this$props10.renderValue,\r\n        disabled = _this$props10.disabled,\r\n        cleanable = _this$props10.cleanable,\r\n        locale = _this$props10.locale,\r\n        toggleComponentClass = _this$props10.toggleComponentClass,\r\n        style = _this$props10.style,\r\n        onEnter = _this$props10.onEnter,\r\n        onExited = _this$props10.onExited,\r\n        onClean = _this$props10.onClean,\r\n        countable = _this$props10.countable,\r\n        cascade = _this$props10.cascade,\r\n        inline = _this$props10.inline,\r\n        positionRef = _this$props10.positionRef,\r\n        rest = _objectWithoutPropertiesLoose(_this$props10, [\"valueKey\", \"labelKey\", \"childrenKey\", \"placeholder\", \"renderValue\", \"disabled\", \"cleanable\", \"locale\", \"toggleComponentClass\", \"style\", \"onEnter\", \"onExited\", \"onClean\", \"countable\", \"cascade\", \"inline\", \"positionRef\"]);\r\n\r\n    if (inline) {\r\n      return this.renderDropdownMenu();\r\n    }\r\n\r\n    var flattenData = this.state.flattenData;\r\n    var unhandled = getUnhandledProps(MultiCascader, rest);\r\n    var value = this.getValue();\r\n    var selectedItems = flattenData.filter(function (item) {\r\n      return value.some(function (v) {\r\n        return v === item[valueKey];\r\n      });\r\n    }) || [];\r\n    /**\r\n     * 1.Have a value and the value is valid.\r\n     * 2.Regardless of whether the value is valid, as long as renderValue is set, it is judged to have a value.\r\n     */\r\n\r\n    var hasValue = selectedItems.length > 0 || ((_this$props$value = this.props.value) === null || _this$props$value === void 0 ? void 0 : _this$props$value.length) > 0 && _isFunction(renderValue);\r\n\r\n    var selectedElement = placeholder;\r\n\r\n    if (selectedItems.length > 0) {\r\n      selectedElement = React.createElement(SelectedElement, {\r\n        selectedItems: selectedItems,\r\n        countable: countable,\r\n        valueKey: valueKey,\r\n        labelKey: labelKey,\r\n        childrenKey: childrenKey,\r\n        prefix: this.addPrefix,\r\n        cascade: cascade,\r\n        locale: locale\r\n      });\r\n    }\r\n\r\n    if (hasValue && _isFunction(renderValue)) {\r\n      selectedElement = renderValue((value === null || value === void 0 ? void 0 : value.length) > 0 ? value : this.props.value, selectedItems, selectedElement);\r\n    }\r\n\r\n    var classes = getToggleWrapperClassName('cascader', this.addPrefix, this.props, hasValue);\r\n    return React.createElement(\"div\", {\r\n      className: classes,\r\n      style: style,\r\n      tabIndex: -1,\r\n      role: \"menu\"\r\n    }, React.createElement(PickerToggleTrigger, {\r\n      pickerProps: this.props,\r\n      ref: this.triggerRef,\r\n      positionRef: mergeRefs(this.positionRef, positionRef),\r\n      onEnter: createChainedFunction(this.handleEntered, onEnter),\r\n      onExited: createChainedFunction(this.handleExit, onExited),\r\n      speaker: this.renderDropdownMenu()\r\n    }, React.createElement(PickerToggle, _extends({}, unhandled, {\r\n      componentClass: toggleComponentClass,\r\n      onClean: createChainedFunction(this.handleClean, onClean),\r\n      cleanable: cleanable && !disabled,\r\n      hasValue: hasValue,\r\n      active: this.state.active\r\n    }), selectedElement || locale.placeholder)));\r\n  };\r\n\r\n  return MultiCascader;\r\n}(React.Component);\r\n\r\nMultiCascader.propTypes = _extends({}, listPickerPropTypes, {\r\n  cascade: PropTypes.bool,\r\n  inline: PropTypes.bool,\r\n  countable: PropTypes.bool,\r\n  menuWidth: PropTypes.number,\r\n  menuHeight: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n  uncheckableItemValues: PropTypes.array,\r\n  searchable: PropTypes.bool,\r\n  renderMenuItem: PropTypes.func,\r\n  renderMenu: PropTypes.func,\r\n  onSearch: PropTypes.func,\r\n  onSelect: PropTypes.func\r\n});\r\nMultiCascader.defaultProps = _extends({}, listPickerDefaultProps, {\r\n  searchable: true,\r\n  countable: true,\r\n  cascade: true,\r\n  uncheckableItemValues: [],\r\n  locale: {\r\n    placeholder: 'Select',\r\n    checkAll: 'All',\r\n    searchPlaceholder: 'Search',\r\n    noResultsText: 'No results found'\r\n  }\r\n});\r\nMultiCascader.utils = {};\r\npolyfill(MultiCascader);\r\nexport default defaultProps({\r\n  classPrefix: 'picker'\r\n})(MultiCascader);"],"mappings":"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"},"metadata":{},"sourceType":"module"}