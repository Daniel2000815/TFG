{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommonScriptbaseMixin = void 0;\n\nvar MmlNode_js_1 = require(\"../../../core/MmlTree/MmlNode.js\");\n\nfunction CommonScriptbaseMixin(Base) {\n  var _a;\n\n  return _a = function (_super) {\n    __extends(class_1, _super);\n\n    function class_1() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var _this = _super.apply(this, __spreadArray([], __read(args), false)) || this;\n\n      _this.baseScale = 1;\n      _this.baseIc = 0;\n      _this.baseRemoveIc = false;\n      _this.baseIsChar = false;\n      _this.baseHasAccentOver = null;\n      _this.baseHasAccentUnder = null;\n      _this.isLineAbove = false;\n      _this.isLineBelow = false;\n      _this.isMathAccent = false;\n\n      var core = _this.baseCore = _this.getBaseCore();\n\n      if (!core) return _this;\n\n      _this.setBaseAccentsFor(core);\n\n      _this.baseScale = _this.getBaseScale();\n      _this.baseIc = _this.getBaseIc();\n      _this.baseIsChar = _this.isCharBase();\n      _this.isMathAccent = _this.baseIsChar && _this.scriptChild && !!_this.scriptChild.coreMO().node.getProperty('mathaccent');\n\n      _this.checkLineAccents();\n\n      _this.baseRemoveIc = !_this.isLineAbove && !_this.isLineBelow && (!_this.constructor.useIC || _this.isMathAccent);\n      return _this;\n    }\n\n    Object.defineProperty(class_1.prototype, \"baseChild\", {\n      get: function get() {\n        return this.childNodes[this.node.base];\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(class_1.prototype, \"scriptChild\", {\n      get: function get() {\n        return this.childNodes[1];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_1.prototype.getBaseCore = function () {\n      var core = this.getSemanticBase() || this.childNodes[0];\n\n      while (core && (core.childNodes.length === 1 && (core.node.isKind('mrow') || core.node.isKind('TeXAtom') && core.node.texClass !== MmlNode_js_1.TEXCLASS.VCENTER || core.node.isKind('mstyle') || core.node.isKind('mpadded') || core.node.isKind('mphantom') || core.node.isKind('semantics')) || core.node.isKind('munderover') && core.isMathAccent)) {\n        this.setBaseAccentsFor(core);\n        core = core.childNodes[0];\n      }\n\n      if (!core) {\n        this.baseHasAccentOver = this.baseHasAccentUnder = false;\n      }\n\n      return core || this.childNodes[0];\n    };\n\n    class_1.prototype.setBaseAccentsFor = function (core) {\n      if (core.node.isKind('munderover')) {\n        if (this.baseHasAccentOver === null) {\n          this.baseHasAccentOver = !!core.node.attributes.get('accent');\n        }\n\n        if (this.baseHasAccentUnder === null) {\n          this.baseHasAccentUnder = !!core.node.attributes.get('accentunder');\n        }\n      }\n    };\n\n    class_1.prototype.getSemanticBase = function () {\n      var fence = this.node.attributes.getExplicit('data-semantic-fencepointer');\n      return this.getBaseFence(this.baseChild, fence);\n    };\n\n    class_1.prototype.getBaseFence = function (fence, id) {\n      var e_1, _a;\n\n      if (!fence || !fence.node.attributes || !id) {\n        return null;\n      }\n\n      if (fence.node.attributes.getExplicit('data-semantic-id') === id) {\n        return fence;\n      }\n\n      try {\n        for (var _b = __values(fence.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          var result = this.getBaseFence(child, id);\n\n          if (result) {\n            return result;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    class_1.prototype.getBaseScale = function () {\n      var child = this.baseCore;\n      var scale = 1;\n\n      while (child && child !== this) {\n        var bbox = child.getOuterBBox();\n        scale *= bbox.rscale;\n        child = child.parent;\n      }\n\n      return scale;\n    };\n\n    class_1.prototype.getBaseIc = function () {\n      return this.baseCore.getOuterBBox().ic * this.baseScale;\n    };\n\n    class_1.prototype.getAdjustedIc = function () {\n      var bbox = this.baseCore.getOuterBBox();\n      return (bbox.ic ? 1.05 * bbox.ic + .05 : 0) * this.baseScale;\n    };\n\n    class_1.prototype.isCharBase = function () {\n      var base = this.baseCore;\n      return (base.node.isKind('mo') && base.size === null || base.node.isKind('mi') || base.node.isKind('mn')) && base.bbox.rscale === 1 && Array.from(base.getText()).length === 1;\n    };\n\n    class_1.prototype.checkLineAccents = function () {\n      if (!this.node.isKind('munderover')) return;\n\n      if (this.node.isKind('mover')) {\n        this.isLineAbove = this.isLineAccent(this.scriptChild);\n      } else if (this.node.isKind('munder')) {\n        this.isLineBelow = this.isLineAccent(this.scriptChild);\n      } else {\n        var mml = this;\n        this.isLineAbove = this.isLineAccent(mml.overChild);\n        this.isLineBelow = this.isLineAccent(mml.underChild);\n      }\n    };\n\n    class_1.prototype.isLineAccent = function (script) {\n      var node = script.coreMO().node;\n      return node.isToken && node.getText() === \"\\u2015\";\n    };\n\n    class_1.prototype.getBaseWidth = function () {\n      var bbox = this.baseChild.getOuterBBox();\n      return bbox.w * bbox.rscale - (this.baseRemoveIc ? this.baseIc : 0) + this.font.params.extra_ic;\n    };\n\n    class_1.prototype.computeBBox = function (bbox, recompute) {\n      if (recompute === void 0) {\n        recompute = false;\n      }\n\n      var w = this.getBaseWidth();\n\n      var _a = __read(this.getOffset(), 2),\n          x = _a[0],\n          y = _a[1];\n\n      bbox.append(this.baseChild.getOuterBBox());\n      bbox.combine(this.scriptChild.getOuterBBox(), w + x, y);\n      bbox.w += this.font.params.scriptspace;\n      bbox.clean();\n      this.setChildPWidths(recompute);\n    };\n\n    class_1.prototype.getOffset = function () {\n      return [0, 0];\n    };\n\n    class_1.prototype.baseCharZero = function (n) {\n      var largeop = !!this.baseCore.node.attributes.get('largeop');\n      var scale = this.baseScale;\n      return this.baseIsChar && !largeop && scale === 1 ? 0 : n;\n    };\n\n    class_1.prototype.getV = function () {\n      var bbox = this.baseCore.getOuterBBox();\n      var sbox = this.scriptChild.getOuterBBox();\n      var tex = this.font.params;\n      var subscriptshift = this.length2em(this.node.attributes.get('subscriptshift'), tex.sub1);\n      return Math.max(this.baseCharZero(bbox.d * this.baseScale + tex.sub_drop * sbox.rscale), subscriptshift, sbox.h * sbox.rscale - 4 / 5 * tex.x_height);\n    };\n\n    class_1.prototype.getU = function () {\n      var bbox = this.baseCore.getOuterBBox();\n      var sbox = this.scriptChild.getOuterBBox();\n      var tex = this.font.params;\n      var attr = this.node.attributes.getList('displaystyle', 'superscriptshift');\n      var prime = this.node.getProperty('texprimestyle');\n      var p = prime ? tex.sup3 : attr.displaystyle ? tex.sup1 : tex.sup2;\n      var superscriptshift = this.length2em(attr.superscriptshift, p);\n      return Math.max(this.baseCharZero(bbox.h * this.baseScale - tex.sup_drop * sbox.rscale), superscriptshift, sbox.d * sbox.rscale + 1 / 4 * tex.x_height);\n    };\n\n    class_1.prototype.hasMovableLimits = function () {\n      var display = this.node.attributes.get('displaystyle');\n      var mo = this.baseChild.coreMO().node;\n      return !display && !!mo.attributes.get('movablelimits');\n    };\n\n    class_1.prototype.getOverKU = function (basebox, overbox) {\n      var accent = this.node.attributes.get('accent');\n      var tex = this.font.params;\n      var d = overbox.d * overbox.rscale;\n      var t = tex.rule_thickness * tex.separation_factor;\n      var delta = this.baseHasAccentOver ? t : 0;\n      var T = this.isLineAbove ? 3 * tex.rule_thickness : t;\n      var k = (accent ? T : Math.max(tex.big_op_spacing1, tex.big_op_spacing3 - Math.max(0, d))) - delta;\n      return [k, basebox.h * basebox.rscale + k + d];\n    };\n\n    class_1.prototype.getUnderKV = function (basebox, underbox) {\n      var accent = this.node.attributes.get('accentunder');\n      var tex = this.font.params;\n      var h = underbox.h * underbox.rscale;\n      var t = tex.rule_thickness * tex.separation_factor;\n      var delta = this.baseHasAccentUnder ? t : 0;\n      var T = this.isLineBelow ? 3 * tex.rule_thickness : t;\n      var k = (accent ? T : Math.max(tex.big_op_spacing2, tex.big_op_spacing4 - h)) - delta;\n      return [k, -(basebox.d * basebox.rscale + k + h)];\n    };\n\n    class_1.prototype.getDeltaW = function (boxes, delta) {\n      var e_2, _a, e_3, _b;\n\n      if (delta === void 0) {\n        delta = [0, 0, 0];\n      }\n\n      var align = this.node.attributes.get('align');\n      var widths = boxes.map(function (box) {\n        return box.w * box.rscale;\n      });\n      widths[0] -= this.baseRemoveIc && !this.baseCore.node.attributes.get('largeop') ? this.baseIc : 0;\n      var w = Math.max.apply(Math, __spreadArray([], __read(widths), false));\n      var dw = [];\n      var m = 0;\n\n      try {\n        for (var _c = __values(widths.keys()), _d = _c.next(); !_d.done; _d = _c.next()) {\n          var i = _d.value;\n          dw[i] = (align === 'center' ? (w - widths[i]) / 2 : align === 'right' ? w - widths[i] : 0) + delta[i];\n\n          if (dw[i] < m) {\n            m = -dw[i];\n          }\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      if (m) {\n        try {\n          for (var _e = __values(dw.keys()), _f = _e.next(); !_f.done; _f = _e.next()) {\n            var i = _f.value;\n            dw[i] += m;\n          }\n        } catch (e_3_1) {\n          e_3 = {\n            error: e_3_1\n          };\n        } finally {\n          try {\n            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n          } finally {\n            if (e_3) throw e_3.error;\n          }\n        }\n      }\n\n      [1, 2].map(function (i) {\n        return dw[i] += boxes[i] ? boxes[i].dx * boxes[0].scale : 0;\n      });\n      return dw;\n    };\n\n    class_1.prototype.getDelta = function (noskew) {\n      if (noskew === void 0) {\n        noskew = false;\n      }\n\n      var accent = this.node.attributes.get('accent');\n\n      var _a = this.baseCore.getOuterBBox(),\n          sk = _a.sk,\n          ic = _a.ic;\n\n      return ((accent && !noskew ? sk : 0) + this.font.skewIcFactor * ic) * this.baseScale;\n    };\n\n    class_1.prototype.stretchChildren = function () {\n      var e_4, _a, e_5, _b, e_6, _c;\n\n      var stretchy = [];\n\n      try {\n        for (var _d = __values(this.childNodes), _e = _d.next(); !_e.done; _e = _d.next()) {\n          var child = _e.value;\n\n          if (child.canStretch(2)) {\n            stretchy.push(child);\n          }\n        }\n      } catch (e_4_1) {\n        e_4 = {\n          error: e_4_1\n        };\n      } finally {\n        try {\n          if (_e && !_e.done && (_a = _d.return)) _a.call(_d);\n        } finally {\n          if (e_4) throw e_4.error;\n        }\n      }\n\n      var count = stretchy.length;\n      var nodeCount = this.childNodes.length;\n\n      if (count && nodeCount > 1) {\n        var W = 0;\n        var all = count > 1 && count === nodeCount;\n\n        try {\n          for (var _f = __values(this.childNodes), _g = _f.next(); !_g.done; _g = _f.next()) {\n            var child = _g.value;\n            var noStretch = child.stretch.dir === 0;\n\n            if (all || noStretch) {\n              var _h = child.getOuterBBox(noStretch),\n                  w = _h.w,\n                  rscale = _h.rscale;\n\n              if (w * rscale > W) W = w * rscale;\n            }\n          }\n        } catch (e_5_1) {\n          e_5 = {\n            error: e_5_1\n          };\n        } finally {\n          try {\n            if (_g && !_g.done && (_b = _f.return)) _b.call(_f);\n          } finally {\n            if (e_5) throw e_5.error;\n          }\n        }\n\n        try {\n          for (var stretchy_1 = __values(stretchy), stretchy_1_1 = stretchy_1.next(); !stretchy_1_1.done; stretchy_1_1 = stretchy_1.next()) {\n            var child = stretchy_1_1.value;\n            child.coreMO().getStretchedVariant([W / child.bbox.rscale]);\n          }\n        } catch (e_6_1) {\n          e_6 = {\n            error: e_6_1\n          };\n        } finally {\n          try {\n            if (stretchy_1_1 && !stretchy_1_1.done && (_c = stretchy_1.return)) _c.call(stretchy_1);\n          } finally {\n            if (e_6) throw e_6.error;\n          }\n        }\n      }\n    };\n\n    return class_1;\n  }(Base), _a.useIC = true, _a;\n}\n\nexports.CommonScriptbaseMixin = CommonScriptbaseMixin;","map":{"version":3,"mappings":"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","names":["CommonScriptbaseMixin","Base","__extends","args","_this","core","baseCore","getBaseCore","setBaseAccentsFor","baseScale","getBaseScale","baseIc","getBaseIc","baseIsChar","isCharBase","isMathAccent","scriptChild","coreMO","node","getProperty","checkLineAccents","baseRemoveIc","isLineAbove","isLineBelow","constructor","useIC","Object","class_1","childNodes","base","getSemanticBase","length","isKind","texClass","MmlNode_js_1","VCENTER","baseHasAccentOver","baseHasAccentUnder","attributes","get","fence","getExplicit","getBaseFence","baseChild","id","_c","child","result","scale","bbox","getOuterBBox","rscale","parent","ic","size","Array","from","getText","isLineAccent","mml","overChild","underChild","script","isToken","w","font","params","extra_ic","recompute","getBaseWidth","getOffset","x","y","append","combine","scriptspace","clean","setChildPWidths","n","largeop","sbox","tex","subscriptshift","length2em","sub1","Math","max","baseCharZero","d","sub_drop","h","x_height","attr","getList","prime","p","sup3","displaystyle","sup1","sup2","superscriptshift","sup_drop","display","mo","basebox","overbox","accent","t","rule_thickness","separation_factor","delta","T","k","big_op_spacing1","big_op_spacing3","underbox","big_op_spacing2","big_op_spacing4","boxes","align","widths","map","box","apply","__spreadArray","dw","m","keys","_d","i","_f","dx","noskew","sk","skewIcFactor","stretchy","_e","canStretch","push","count","nodeCount","W","all","_g","noStretch","stretch","dir","stretchy_1_1","getStretchedVariant","_a","exports"],"sourceRoot":"","sources":["../../../../ts/output/common/Wrappers/scriptbase.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}