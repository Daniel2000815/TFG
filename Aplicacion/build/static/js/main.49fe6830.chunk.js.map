{"version":3,"sources":["../node_modules/typescript/lib sync","CustomComponents/Shader.js","ShaderStuff/defaultShader.js","ShaderStuff/fragmentShaderMovable.js","ShaderStuff/primitives.js","ShaderStuff/operators.js","CustomComponents/Dropdown.js","CustomNodes/CustomHandle.js","GraphContext.js","CustomComponents/ToggleButton.js","CustomNodes/CustomNode.js","CustomComponents/FloatInput.js","CustomNodes/PrimitiveNode.js","CustomComponents/FloatSlider.js","CustomNodes/BooleanNode.js","CustomNodes/DeformNode.js","CustomComponents/Vector3Input.js","CustomNodes/TransformNode.js","CustomComponents/CustomControls.js","nodeTypes.js","CustomComponents/CustomContextMenu copy.js","Graph.js","CustomNodes/ButtonEdge.js","MaterialCard.js","MaterialsPage.js","SurfaceCard.js","SurfacePage.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Shader","props","useEffect","shader","uniforms","useState","zoom","setZoom","style","timeout","wheelConfig","preventScroll","upHandler","downHandler","ratio","onWheel","console","log","fs","key","distance","type","value","sdf","Dropdown","React","open","setOpen","FormControl","onClick","sx","m","minWidth","InputLabel","label","Select","defaultValue","onChange","ev","target","autoWidth","size","items","map","item","MenuItem","CustomHandle","theme","useTheme","width","height","background","palette","primary","light","border","main","marginRight","position","marginLeft","GraphContext","createContext","GraphProvider","Provider","CustomButton","styled","Button","color","contrastText","backgroundColor","accent","ToggleButton","variant","borderRadius","endIcon","CustomNode","showMore","setShowMore","isHover","setIsHover","sharedFunctions","useContext","nodeStyle","display","flexDirection","transition","boxShadow","dark","headerStyle","textAlign","fontWeight","fontSize","letterSpacing","justifyContent","footerStyle","updateNodeSdf","handleKeyDown","toLowerCase","document","addEventListener","removeEventListener","tabIndex","className","title","currOption","onMouseEnter","onMouseLeave","dropdownOptions","onChangeOption","Object","data","children","join","body","margin","Array","nInputs","i","top","onConnect","params","FloatInput","TextField","val","handleChange","parseFloat","placeholder","paddingLeft","InputProps","startAdornment","InputAdornment","labelColor","padding","borderTopLeftRadius","shape","borderBottomLeftRadius","createTheme","Primitives","Sphere","Box","Torus","Cylinder","CustomSlider","Slider","opacity","FloatSlider","valueLabelDisplay","min","range","max","step","BooleanOperations","Union","Difference","Intersection","DeformOperations","Bend","Twist","Header","Paper","typography","body2","TextFieldWrapper","Field","Vector3Input","x","setX","y","setY","z","setZ","flexGrow","container","spacing","columns","xs","sm","md","TransformOperations","Translate","Scale","Rotate","CustomControls","save","load","NodeTypes","Primitive","Boolean","Transform","Deform","CustomContextMenu2","icons","index","newNode","values","Typography","align","toUpperCase","graphNodeTypes","primitiveNode","primitive","setPrimitive","setSdf","inputs","setInputs","inputLabels","setInputLabels","inputsActive","setInputsActive","prepareInputs","label1","label2","label3","toFixed","ThemeProvider","newVal","booleanNode","operation","setOperation","smooth","k","setK","length","newSdf","Math","deformNode","input","replace","v","transformNode","transformVal","setTransformVal","s","edgeTypes","buttonEdge","sourceX","sourceY","targetX","targetY","sourcePosition","targetPosition","edgePath","getBezierPath","getEdgeCenter","edgeCenterX","edgeCenterY","d","foreignObjectSize","requiredExtensions","removeEdge","initialNodes","dragHandle","default","Graph","useNodesState","nodes","setNodes","onNodesChange","useEdgesState","edges","setEdges","onEdgesChange","rfInstance","setRfInstance","setId","mouseCoor","setMouseCoor","reactFlowRef","useRef","parent","nodesCopy","find","node","child","newInputs","edgeId","edge","newEdges","filter","source","nds","newChildren","c","onLoad","flow","JSON","parse","localStorage","getItem","viewport","nodeType","xPos","yPos","nodeId","onKeyDown","project","push","onMouseMove","bounds","current","getBoundingClientRect","clientX","left","clientY","ref","sourceNode","n","eds","addEdge","animated","markerEnd","MarkerType","Arrow","nodeTypes","onInit","snapToGrid","fitView","gap","toObject","setItem","stringify","MaterialCard","Card","elevation","CardContent","component","name","mb","CardActions","MaterialsPage","direction","alignItems","SurfaceCard","SurfaceDialog","nerdamer","require","eqData","setEqData","validEq","setValEq","Dialog","onClose","handleClose","DialogTitle","DialogContent","f","toString","Node","formula","convertToLaTeX","dx","dy","dz","norm","DialogContentText","newEq","error","warn","dfdx","diff","dfdy","dfdz","handleNewEquation","endAdornment","disabled","DialogActions","SurfacePage","dialogOpen","setDialogOpen","Fab","bottom","right","aria-label","boolean","deform","transform","MainContent","Grid","fluid","Row","Col","borderRight","layoutStyles","App","tabVal","setTabVal","Tabs","Tab","Content","Footer","Panel","bordered","rootElement","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.49fe6830.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 309;","import React, {useState} from \"react\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport Ratio from \"react-ratio\";\r\nimport ShadertoyReact from \"shadertoy-react\";\r\nimport { defaultShader } from \"../ShaderStuff/defaultShader\";\r\nimport ReactScrollWheelHandler from \"react-scroll-wheel-handler\";\r\n\r\nexport default function Shader(props) {\r\n  useEffect(() => {}, [props.shader, props.uniforms]);\r\n\r\n  const [zoom, setZoom] = useState(10.0);\r\n  const zoomIncrement = 0.5;\r\n  return (\r\n    <div style={props.style}  >\r\n      <ReactScrollWheelHandler\r\n      timeout=\"0\"\r\n      wheelConfig= {[100, 1000, 0.05]}\r\n      preventScroll=\"true \"\r\n  upHandler={(e) => setZoom(zoom + zoomIncrement)}\r\n  downHandler={(e) => setZoom(zoom - zoomIncrement)}\r\n>\r\n      <Ratio ratio={1} onWheel={(e) => console.log(e)}>\r\n        <ShadertoyReact\r\n          fs={props.shader ? props.shader : defaultShader()}\r\n          key={props.shader}\r\n          uniforms={{\r\n            ...props.uniforms, \r\n            distance: { type: \"1f\"  , value: zoom}\r\n          }}\r\n        />\r\n      </Ratio>\r\n      </ReactScrollWheelHandler>\r\n    </div>\r\n  );\r\n}\r\n","export const defaultShader = () => `\r\n#define T_MAX 30.0\r\n\r\nstruct point_light\r\n{\r\n    vec3 p;\r\n    vec3 i;\r\n};\r\n\r\nfloat sdBox( vec3 p, vec3 b )\r\n{\r\n  vec3 d = abs(p) - b;\r\n  return min(max(d.x,max(d.y,d.z)),0.0) + length(max(d,0.0));\r\n}\r\n\r\nvec3 opRep( in vec3 p, in vec3 c)\r\n{\r\n    vec3 q = mod(p,c)-0.5*c;\r\n    return q;\r\n}\r\n\r\nfloat sdf(in vec3 p, out int matid)\r\n{\r\n    float sphere_sdf = length(p - vec3(0, 1, 0)) - 1.0;\r\n    float box_sdf = sdBox(p - vec3(0, 1, 0), vec3(0.8));\r\n    float obj_sdf = max(-sphere_sdf, box_sdf);\r\n    float floor_sdf = abs(p.y);\r\n    \r\n    float sdf = min(obj_sdf, floor_sdf);\r\n    if (sdf == obj_sdf)\r\n    {\r\n        matid = 1;\r\n    }\r\n    else\r\n    {\r\n        matid = 0;\r\n    }\r\n    \r\n    return sdf;\r\n}\r\n\r\nvec3 sdf_n(in vec3 p)\r\n{\r\n    vec3 res = vec3(0);\r\n    \r\n    int ignored;\r\n    res.x = sdf(p + vec3(0.001, 0, 0), ignored) - sdf(p, ignored);\r\n    res.y = sdf(p + vec3(0, 0.001, 0), ignored) - sdf(p, ignored);\r\n    res.z = sdf(p + vec3(0, 0, 0.001), ignored) - sdf(p, ignored);\r\n    \r\n    return normalize(res);\r\n}\r\n\r\nfloat intersect(in vec3 ro, in vec3 rd, out int matid)\r\n{\r\n\tfloat t = 0.0;\r\n    matid = -1;\r\n    for (int i = 0; i < 256; ++i)\r\n    {\r\n        if (t > T_MAX)\r\n        {\r\n            break;\r\n        }\r\n        \r\n        int curr_matid = -1;\r\n\t\tfloat d = sdf(ro + t*rd, curr_matid);\r\n        if (d < 0.0001)\r\n        {\r\n            matid = curr_matid;\r\n            break;\r\n        }\r\n        t += d;\r\n    }\r\n    return t;\r\n}\r\n\r\nfloat dir_shadow(in vec3 p, in vec3 l)\r\n{\r\n    float t = 0.15;\r\n    float t_max = 20.0;\r\n    \r\n    float res = 1.0;\r\n    for (int i = 0; i < 256; ++i)\r\n    {\r\n        if (t > t_max) break;\r\n        \r\n        int ignored;\r\n        float d = sdf(p + t*l, ignored);\r\n        if (d < 0.01)\r\n        {\r\n            return 0.0;\r\n        }\r\n        t += d;\r\n        res = min(res, 8.0 * d / t);\r\n    }\r\n    \r\n    return res;\r\n}\r\n\r\nfloat point_shadow(in vec3 p, in vec3 light_p)\r\n{\r\n    vec3 l = normalize(light_p - p);\r\n        \r\n    float t = 0.15;\r\n    float t_max = distance(light_p, p);\r\n    \r\n    float res = 1.0;\r\n    for (int i = 0; i < 256; ++i)\r\n    {\r\n        if (t > t_max) break;\r\n        \r\n        int ignored;\r\n        float d = sdf(p + t*l, ignored);\r\n        if (d < 0.01)\r\n        {\r\n            return 0.0;\r\n        }\r\n        t += d;\r\n        res = min(res, 64.0 * d / t);\r\n    }\r\n    \r\n    return res;\r\n}\r\n\r\nfloat ao(in vec3 p, in vec3 n)\r\n{\r\n    float e = 0.1;\r\n    float res = 0.0;\r\n    \r\n#define AO_ITER 5\r\n    \r\n    int ignored;\r\n    float weight = 0.5;\r\n    for (int i = 1; i <= AO_ITER; ++i)\r\n    {\r\n        float d = e * float(i);\r\n        res += weight * (1.0 - (d - sdf(p + d * n, ignored)));\r\n        weight *= 0.5;\r\n    }\r\n    \r\n    return res;\r\n}\r\n\r\nvec3 render(in vec2 fragCoord)\r\n{\r\n   \tvec2 uv = 2.0 * fragCoord / iResolution.xy - 1.0;\r\n    uv.x *= iResolution.x / iResolution.y;\r\n     \r\n    float cam_d = 3.0;\r\n    float time = 0.6;\r\n    vec3 ro = vec3(cam_d*sin(time), 2.5, cam_d*cos(time));\r\n    vec3 at = vec3(0, 1, 0);\r\n    vec3 cam_z = normalize(at - ro);\r\n    vec3 cam_x = normalize(cross(vec3(0,1,0), cam_z));\r\n    vec3 cam_y = cross(cam_z, cam_x);\r\n    vec3 rd = normalize(uv.x * cam_x + uv.y * cam_y + 1.73 * cam_z);\r\n\t\r\n    vec3 sky = vec3(0.02);\r\n    vec3 col = vec3(0);\r\n    \r\n    int matid = -1;\r\n    float t = intersect(ro, rd, matid);\r\n    if (matid != -1)\r\n    { \r\n        vec3 p = ro + t*rd;\r\n        vec3 n = sdf_n(p);\r\n        \r\n#define PLIGHT_COUNT 1 \r\n        point_light plights[PLIGHT_COUNT];\r\n        plights[0] = point_light(vec3(2, 1, 1), vec3(20));\r\n\r\n        vec3 direct_light = vec3(0);\r\n        for (int plight_index = 0; plight_index < PLIGHT_COUNT; ++plight_index)\r\n        {\r\n            vec3 light_i = plights[plight_index].i;\r\n            vec3 light_p = plights[plight_index].p;\r\n        \tfloat light_r = dot(light_p - p, light_p - p);\r\n        \tvec3 l = normalize(light_p - p);\r\n        \r\n        \tdirect_light += point_shadow(p, light_p) * max(0.0, dot(n, l)) * light_i / (light_r * light_r);\r\n        }\r\n\r\n        vec3 indirect_light = ao(p, n) * sky;\r\n        \r\n        vec3 albedo = vec3(0.9);      \r\n\t\tcol = albedo * (0.7 * direct_light + indirect_light);\r\n        \r\n        col = mix(col, vec3(0), clamp(pow(t / T_MAX, 2.0), 0.0, 1.0));\r\n    }\r\n    \r\n    return col;\r\n}\r\n\r\nvec3 tonemap(in vec3 col)\r\n{\r\n    return col / (1.0 + col);\r\n}\r\n\r\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\r\n{\r\n#if 0\r\n    vec3 col = tonemap(render(fragCoord));\r\n#else\r\n    vec3 col = vec3(0);\r\n    col += tonemap(render(fragCoord + vec2(0.25, 0.25)));\r\n    col += tonemap(render(fragCoord + vec2(0.25, -0.25)));\r\n    col += tonemap(render(fragCoord + vec2(-0.25, -0.25)));\r\n    col += tonemap(render(fragCoord + vec2(-0.25, 0.25)));\r\n    col /= 4.0;\r\n#endif\r\n    \r\n    col = sqrt(col);\r\n    fragColor = vec4(col, 1.0);\r\n}\r\n`;\r\n","import { primitives } from \"./primitives\";\r\nimport { operators } from \"./operators\";\r\n\r\nexport const fs = (sdf) => {\r\n  return `\r\n    \r\n    // https://thebookofshaders.com/03/?lan=es\r\n  // https://thebookofshaders.com/03/\r\n  // http://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/#putting-it-all-together\r\n  // https://www.shadertoy.com/view/llt3R4\r\n  \r\n  // camera\r\n  // https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-ray-tracing/how-does-it-work\r\n  // http://www.codinglabs.net/article_world_view_projection_matrix.aspx\r\n  // https://iopscience.iop.org/article/10.1088/0031-9155/52/12/006/meta\r\n  // https://www.ingebook.com/ib/NPcd/IB_BooksVis?cod_primaria=1000187&codigo_libro=6575\r\n  \r\n  #ifdef GL_ES\r\n  precision mediump float;\r\n  #endif\r\n  \r\n  const int AA = 3;\r\n  const int MAX_MARCHING_STEPS = 255;\r\n  const float EPSILON = 0.0001;\r\n  const float MIN_DIST = 0.0;\r\n  const float MAX_DIST = 100.0;\r\n\r\n  vec3 cameraPos                    = vec3(10.0, 1.0, 10.0);\r\n  \r\n  ${primitives()}\r\n  ${operators()}\r\n\r\n  struct Material\r\n  {\r\n      vec3 specular;\r\n      vec3 diffuse;\r\n      vec3 ambient;\r\n      float smoothness;\r\n  };\r\n  \r\n  float map( in vec3 p )\r\n  {\r\n    return ${sdf};\r\n  }\r\n  \r\n  \r\n  vec3 rayDirection(vec2 size, vec2 fragCoord) {\r\n      const float fov = 45.0;\r\n  \r\n      vec2 xy = fragCoord - size / 2.0;\r\n      float z = size.y / tan(radians(fov) / 2.0);\r\n  \r\n      return normalize(vec3(xy, -z));\r\n  }\r\n  \r\n  vec3 normal(vec3 p) {\r\n      return normalize(vec3(\r\n          map(vec3(p.x + EPSILON, p.y, p.z)) - map(vec3(p.x - EPSILON, p.y, p.z)),\r\n          map(vec3(p.x, p.y + EPSILON, p.z)) - map(vec3(p.x, p.y - EPSILON, p.z)),\r\n          map(vec3(p.x, p.y, p.z  + EPSILON)) - map(vec3(p.x, p.y, p.z - EPSILON))\r\n      ));\r\n  }\r\n  \r\n  vec3 lighting(vec3 p, vec3 n, vec3 eye, Material mat){\r\n      vec3 ambient = vec3(0.5);\r\n  \r\n      vec3 lights_pos[2];\r\n      lights_pos[0] = vec3(4.0, 2.0, 2.0);\r\n      lights_pos[1] = vec3(-4.0, -2.0, -2.0);\r\n  \r\n      vec3 lights_color[2];\r\n      lights_color[0] = vec3(1.0, 1.0, 1.0);\r\n      lights_color[1] = vec3(1.0, 1.0, 1.0);\r\n  \r\n      vec3 Ip = mat.ambient * ambient;\r\n  \r\n      for(int i=0; i<2; i++){\r\n          vec3 Lm = normalize(lights_pos[i] - p);\r\n          vec3 Rm = normalize(2.0*(dot(Lm,n))*n - Lm);    // reflect(-Lm, n)\r\n          vec3 V  = normalize(eye - p);\r\n  \r\n          float LN = dot(Lm, n);\r\n          float RV = dot(Rm, V);\r\n  \r\n          if (LN < 0.0)   // Light not visible\r\n              Ip += vec3(0.0, 0.0, 0.0);\r\n          else if (RV < 0.0)  // opposite direction as viewer, apply only diffuse\r\n              Ip += lights_color[i] * (mat.diffuse * LN);\r\n          else\r\n              Ip += lights_color[i] * (mat.diffuse*LN + mat.specular*pow(RV, mat.smoothness));\r\n      }\r\n  \r\n      return Ip;\r\n  }\r\n  \r\n  mat4 viewMatrix(vec3 eye, vec3 center, vec3 up) {\r\n      // Based on gluLookAt man page\r\n      vec3 f = normalize(center - eye);\r\n      vec3 s = normalize(cross(f, up));\r\n      vec3 u = cross(s, f);\r\n      return mat4(\r\n          vec4(s, 0.0),\r\n          vec4(u, 0.0),\r\n          vec4(-f, 0.0),\r\n          vec4(0.0, 0.0, 0.0, 1)\r\n      );\r\n  }\r\n  \r\n  float clamp(float val){\r\n    if(val < 0.0)   return 0.0;\r\n    if(val >1.0)    return 1.0;\r\n\r\n    return val;\r\n}\r\n\r\n  void main() {\r\n      Material mat_yellow = Material(\r\n          vec3(1.0, 1.0, 1.0),    // specular\r\n          vec3(1.0, 1.0,0.0),        // diffuse\r\n          vec3(0.2),              // ambient\r\n          10.0                    // shiness\r\n      );\r\n      \r\n      const vec3 backGroundColor  = vec3(0.9);\r\n      vec2 mouseStartPos, mouseCurrPos;\r\n      vec2 mouse = iMouse.xy / iResolution.xy;\r\n\r\n      if(iMouse.z > 0.0){\r\n        \r\n        vec3 cameraAt \t= vec3(0.0);\r\n\r\n        float angleX = 6.28 * mouse.x;\r\n        float angleY =  mouse.y * 6.28 ;\r\n        cameraPos\t= distance * (vec3(sin(angleX)*cos(angleY), sin(angleY), cos(angleX)*cos(angleY)));\r\n      }\r\n\r\n      \r\n\r\n      for( int m=0; m<AA; m++ ){\r\n          for( int n=0; n<AA; n++ ){\r\n              float depth = MIN_DIST;\r\n  \r\n              // create view ray\r\n              vec3 ray = rayDirection(iResolution.xy, gl_FragCoord.xy);\r\n              mat4 viewToWorld = viewMatrix(cameraPos, vec3(0.0, 0.0, 0.0), vec3(0.0, 1.0, 0.0));\r\n              vec3 worldDir = (viewToWorld * vec4(ray, 0.0)).xyz;\r\n  \r\n              // raytracing\r\n              for (int i = 0; i < MAX_MARCHING_STEPS; i++) {\r\n                  float dist = map(cameraPos + depth * worldDir);\r\n                  if (dist < EPSILON) {\r\n                      vec3 p = cameraPos + depth * worldDir;\r\n                      vec3 n = normal(p);\r\n  \r\n                      gl_FragColor = vec4(lighting(p, n, cameraPos, mat_yellow), 1.0);\r\n                      return;\r\n                  }\r\n  \r\n                  depth += dist;\r\n  \r\n                  if (depth >= MAX_DIST) {\r\n                      gl_FragColor = vec4(backGroundColor.xyz, 1.0);\r\n                      return;\r\n                  }\r\n              }\r\n          }\r\n      }\r\n  }\r\n\r\n  \r\n  `;\r\n};\r\n","export const primitives = () => `\r\n    float sphere( vec3 p, float radius )\r\n    {\r\n    return length(p)-radius;\r\n    }\r\n\r\n    float box( vec3 p, vec3 size )\r\n    {\r\n    vec3 q = abs(p) - size;\r\n    return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\r\n    }\r\n\r\n    float torus( vec3 p, vec2 size )\r\n    {\r\n    vec2 q = vec2(length(p.xz)-size.x,p.y);\r\n    return length(q)-size.y;\r\n    }\r\n\r\n    float cylinder( vec3 p, float h, float r )\r\n    {\r\n    vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);\r\n    return min(max(d.x,d.y),0.0) + length(max(d,0.0));\r\n    }\r\n\r\n    float line(in vec3 p, in vec3 start, in vec3 end, in float thickness) {\r\n        vec3 ba = end - start;\r\n        vec3 pa = p - start;\r\n        float h = clamp(dot(pa, ba) / dot(ba, ba), 0., 1.);\r\n        return length(pa - h * ba) - thickness;\r\n    }\r\n\r\n`","export const operators = () => `\r\n    vec3 sdfTwist( in vec3 p, in float k )\r\n    {\r\n        float c = cos(k*p.y);\r\n        float s = sin(k*p.y);\r\n        mat2  m = mat2(c,-s,s,c);\r\n        vec3  q = vec3(m*p.xz,p.y);\r\n        return q;\r\n    }\r\n\r\n    vec3 sdfBend(in vec3 p, in float k )\r\n    {\r\n        float c = cos(k*p.x);\r\n        float s = sin(k*p.x);\r\n        mat2  m = mat2(c,-s,s,c);\r\n        vec3  q = vec3(m*p.xy,p.z);\r\n        return q;\r\n    }\r\n    vec3 sdfRepeat( in vec3 p, in float s, in vec3 lim )\r\n    {\r\n        return p-s*clamp(floor(p/s+0.5),-lim,lim);\r\n    }\r\n\r\n    float sdfUnion( float d1, float d2 ) {\r\n        \r\n        return min(d1,d2);\r\n    }\r\n\r\n    float sdfSmoothUnion( float d1, float d2, float k ) {\r\n        float h = clamp( 0.5 + 0.5*(d2-d1)/k, 0.0, 1.0 );\r\n        return mix( d2, d1, h ) - k*h*(1.0-h); \r\n    }\r\n\r\n    float sdfDifference( float d1, float d2 ) {\r\n        \r\n        return max(-d1,d2);\r\n    }\r\n\r\n    float sdfSmoothDifference( float d1, float d2, float k ) {\r\n        float h = clamp( 0.5 - 0.5*(d2+d1)/k, 0.0, 1.0 );\r\n        return mix( d2, -d1, h ) + k*h*(1.0-h); \r\n    }\r\n\r\n    float sdfIntersection( float d1, float d2 ) {\r\n        \r\n        return max(d1,d2);\r\n    }\r\n\r\n    float sdfSmoothIntersection( float d1, float d2, float k ) {\r\n        float h = clamp( 0.5 - 0.5*(d2-d1)/k, 0.0, 1.0 );\r\n        return mix( d2, d1, h ) + k*h*(1.0-h); \r\n    }\r\n\r\n    // https://stackoverflow.com/questions/34050929/3d-point-rotation-algorithm\r\n    vec3 sdfRotate(vec3 p, vec3 ang) {\r\n        float pitch = ang.x;\r\n        float roll = ang.y;\r\n        float yaw = ang.z;\r\n\r\n        float cosa = cos(yaw);\r\n        float sina = sin(yaw);\r\n\r\n        float cosb = cos(pitch);\r\n        float sinb = sin(pitch);\r\n\r\n        float cosc = cos(roll);\r\n        float sinc = sin(roll);\r\n\r\n        float Axx = cosa*cosb;\r\n        float Axy = cosa*sinb*sinc - sina*cosc;\r\n        float Axz = cosa*sinb*cosc + sina*sinc;\r\n\r\n        float Ayx = sina*cosb;\r\n        float Ayy = sina*sinb*sinc + cosa*cosc;\r\n        float Ayz = sina*sinb*cosc - cosa*sinc;\r\n\r\n        float Azx = -sinb;\r\n        float Azy = cosb*sinc;\r\n        float Azz = cosb*cosc;\r\n\r\n        float px = p.x;\r\n        float py = p.y;\r\n        float pz = p.z;\r\n\r\n        p.x = Axx*px + Axy*py + Axz*pz;\r\n        p.y = Ayx*px + Ayy*py + Ayz*pz;\r\n        p.z = Azx*px + Azy*py + Azz*pz;\r\n        \r\n        return p;\r\n    }\r\n\r\n    vec3 sdfTranslate(vec3 p, vec3 t) {\r\n        return p-t;\r\n    }\r\n\r\n    vec3 sdfScale( vec3 p, vec3 s )\r\n    {\r\n        return (p/s)*s;\r\n    }\r\n\r\n`","import React from \"react\";\r\n\r\nimport MenuItem from \"@mui/material/MenuItem\";\r\nimport FormControl from \"@mui/material/FormControl\";\r\nimport Select from \"@mui/material/Select\";\r\nimport InputLabel from \"@mui/material/InputLabel\";\r\n\r\nexport default function Dropdown(props) {\r\n  const [open, setOpen] = React.useState(false);\r\n\r\n  return (\r\n    <FormControl onClick={() => setOpen(!open)} sx={{ m: 1, minWidth: 80 }}>\r\n      <InputLabel>{props.label}</InputLabel>\r\n      <Select\r\n        defaultValue={props.defaultValue}\r\n        value={props.value}\r\n        onChange={(ev) => props.onChange(ev.target.value)}\r\n        autoWidth\r\n        size=\"small\"\r\n        open={open}\r\n        label=\"Primitive\"\r\n      >\r\n        {props.items.map((item) => (\r\n          <MenuItem key={item} value={item}>\r\n            {item}\r\n          </MenuItem>\r\n        ))}\r\n      </Select>\r\n    </FormControl>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Handle } from \"react-flow-renderer\";\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nexport default function CustomHandle(props) {\r\n  const theme = useTheme();\r\n  const radius = \"10px\";\r\n  const margin = \"-2px\"\r\n\r\n  const style = {\r\n    ...props.style, width: `${radius}`, height: `${radius}`,\r\n    background: `${theme.palette.primary.light}`,\r\n    border: `1px solid ${theme.palette.primary.main}`\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      {props.type === \"source\" ?\r\n        <Handle\r\n          type=\"source\"\r\n          id={props.id}\r\n          style={{\r\n            ...style, marginRight: `${margin}`\r\n          }}\r\n          position=\"right\"\r\n        />\r\n        :\r\n        <Handle\r\n          type=\"target\"\r\n          id={props.id ? props.id : \"0\"}\r\n          style={{\r\n            ...style, marginLeft: `${margin}`\r\n          }}\r\n          position=\"left\"\r\n        />\r\n      }\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nconst GraphContext = React.createContext({});\r\nexport const GraphProvider = GraphContext.Provider;\r\nexport default GraphContext;","import React from \"react\";\r\nimport { styled } from '@mui/material/styles';\r\nimport Button, { ButtonProps } from '@mui/material/Button';\r\nimport KeyboardArrowDownIcon from \"@mui/icons-material/KeyboardArrowDown\";\r\nimport KeyboardArrowUpIcon from \"@mui/icons-material/KeyboardArrowUp\";\r\n\r\nconst CustomButton = styled(Button)(({ theme }) => ({\r\n    color: theme.palette.contrastText,\r\n    backgroundColor: theme.palette.primary,\r\n    '&:hover': {\r\n      backgroundColor: theme.palette.accent,\r\n    },\r\n  }));\r\n\r\nexport default function ToggleButton(props) {\r\n    return (\r\n        <CustomButton\r\n        onClick={props.onClick}\r\n        variant=\"contained\"\r\n        size=\"small\"\r\n        style={{ width: \"100%\", borderRadius: \"0 0 5px 5px\", height: \"15px\"}}\r\n        endIcon={\r\n          props.value ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />\r\n        }\r\n      >\r\n      </CustomButton>\r\n    );\r\n}","import React, { useEffect, useContext, useRef } from \"react\";\r\nimport Shader from \"../CustomComponents/Shader\";\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nimport { fs } from \"../ShaderStuff/fragmentShaderMovable\";\r\nimport Dropdown from \"../CustomComponents/Dropdown\";\r\nimport CustomHandle from \"./CustomHandle\";\r\nimport GraphContext from \"../GraphContext.js\";\r\nimport ToggleButton from \"../CustomComponents/ToggleButton\";\r\n\r\n\r\nexport default function CustomNode(props) {\r\n  const [showMore, setShowMore] = React.useState(true);\r\n  const [isHover, setIsHover] = React.useState(false);\r\n\r\n  const sharedFunctions = useContext(GraphContext);\r\n  const theme = useTheme();\r\n  const width = 200;\r\n\r\n  const nodeStyle = {\r\n    position: \"relative\",\r\n    width: `${width}px`,\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    transition: \"border 300ms ease\",\r\n    boxShadow: \"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)\",\r\n    borderRadius: \"0px 0px 0px 0px\",\r\n    backgroundColor: \"#fff\",\r\n\r\n    boxShadow: isHover ?\r\n      \"0 6px 12px rgba(0, 0, 0, 0.25), 0 6px 12px rgba(0, 0, 0, 0.25)\" :\r\n      \"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)\",\r\n\r\n    border: isHover ?\r\n      `1px solid ${theme.palette.primary.dark}` :\r\n      `1px solid ${theme.palette.primary.main}`,\r\n\r\n    \"&:hover\": {\r\n      transition: \"box-shadow 200ms ease\",\r\n      boxShadow: \"0 6px 12px rgba(0, 0, 0, 0.25), 0 6px 12px rgba(0, 0, 0, 0.25)\",\r\n      border: `1px solid ${theme.palette.primary.dark}`\r\n    },\r\n  }\r\n\r\n  const headerStyle = {\r\n    height: showMore ? \"20px\" : \"40px\",\r\n    width: `${width}px`,\r\n    color: \"#EFF7FF\",\r\n    borderRadius: \"5px 5px 0px 0px\",\r\n    textAlign: \"center\",\r\n    fontWeight: \"600\",\r\n    fontSize: showMore ? \"14px\" : \"24px\",\r\n    letterSpacing: \"0.1px\",\r\n    justifyContent: \"flex-start\",\r\n    backgroundColor: `${theme.palette.primary.main}`\r\n  }\r\n\r\n  const footerStyle = {\r\n    height: \"20px\",\r\n    width: `${width}px`,\r\n    color: \"#EFF7FF\",\r\n    borderRadius: \"0px 0px 5px 5px\",\r\n    backgroundColor: `${theme.palette.primary.main}`\r\n  }\r\n\r\n  const handleMouseEnter = () => {\r\n    setIsHover(true);\r\n  };\r\n\r\n  const handleMouseLeave = () => {\r\n    setIsHover(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(`SDF DE ${props.id} MODIFICADO`);\r\n    sharedFunctions.updateNodeSdf(props.id, props.sdf);\r\n  }, [props.sdf]);\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.key.toLowerCase() === \"s\") setShowMore(!showMore);\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [showMore]);\r\n\r\n\r\n\r\n  return (\r\n    <div tabIndex=\"0\">\r\n      <div className=\"nodeHeader\" style={headerStyle}>\r\n        {showMore ? props.title : props.currOption}\r\n      </div>\r\n\r\n      {showMore ?\r\n        <div className=\"nodeBody\" onMouseEnter={handleMouseEnter} onMouseLeave={handleMouseLeave} style={nodeStyle}>\r\n\r\n\r\n          {props.dropdownOptions ? (\r\n            <Dropdown\r\n              defaultValue={props.dropdownOptions[0]}\r\n              onChange={props.onChangeOption}\r\n              items={props.dropdownOptions}\r\n              label={props.title}\r\n            />\r\n          ) : null}\r\n\r\n\r\n\r\n\r\n          {showMore ? (\r\n            <>\r\n              <p>{`ID: ${props.id}`}</p>\r\n              <p>\r\n                CHILDREN:{\" \"}\r\n                {Object.keys(props.data.children)\r\n                  .map((key) => `${props.data.children[key]}`)\r\n                  .join(\", \")}\r\n              </p>\r\n              <p>{`SDF: ${props.sdf}`}</p>\r\n\r\n\r\n\r\n              {props.body}\r\n              <Shader\r\n                shader={fs(props.sdf)}\r\n                uniforms={{\r\n                  color: { type: \"3fv\", value: [1.0, 1.0, 0.0] },\r\n\r\n                }}\r\n                style={{ margin: \"10px\", height: \"100%\" }}\r\n              />\r\n            </>\r\n          ) : null}\r\n\r\n\r\n\r\n\r\n        </div> : null}\r\n\r\n      <div style={footerStyle}>\r\n        <ToggleButton value={showMore} onClick={() => setShowMore(!showMore)} />\r\n      </div>\r\n\r\n      {[...Array(props.nInputs)].map((e, i) =>\r\n        <CustomHandle\r\n          id={i}\r\n          type=\"target\"\r\n          style={{ top: `${50 - ((props.nInputs - 1) / 2) * 5 + i * 5}%` }}\r\n        />\r\n      )\r\n      }\r\n\r\n      <CustomHandle\r\n        id={\"2\"}\r\n        type=\"source\"\r\n        onConnect={(params) => console.log(\"handle onsConnect\", params)}\r\n        style={{ top: \"50%\" }}\r\n\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport TextField from '@mui/material/TextField';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\n\r\nexport default function FloatInput(props) {\r\n  return (\r\n\r\n    <TextField\r\n      value={props.val}\r\n      type=\"number\"\r\n      onChange={(ev) => props.handleChange(parseFloat(ev.target.value))}\r\n      placeholder={props.label}\r\n      \r\n      sx={{\r\n        '& .MuiOutlinedInput-root': {\r\n          paddingLeft: 0,\r\n          m: 1,\r\n          height: \"30px\"\r\n        },\r\n      }}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment\r\n            sx={{\r\n              backgroundColor: props.labelColor ? props.labelColor : \"gray\",\r\n              padding: '15px 14px',\r\n              borderTopLeftRadius: (theme) => theme.shape.borderRadius + 'px',\r\n              borderBottomLeftRadius: (theme) => theme.shape.borderRadius + 'px',\r\n            }}\r\n            position=\"start\"\r\n          >\r\n            {props.label}\r\n          </InputAdornment>\r\n        ),\r\n      }}\r\n    />\r\n  );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport CustomNode from \"../CustomNodes/CustomNode\";\r\nimport FloatInput from \"../CustomComponents/FloatInput.js\";\r\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#92bcff',\r\n      main: '#609dff',\r\n      dark: '#166cf5',\r\n      contrastText: 'white',\r\n    },\r\n  },\r\n});\r\n\r\nconst Primitives = {\r\n  Sphere: \"Sphere\",\r\n  Box: \"Box\",\r\n  Torus: \"Torus\",\r\n  Cylinder: \"Cylinder\",\r\n};\r\n\r\nexport default function PrimitiveNode({ data, id }) {\r\n  const [primitive, setPrimitive] = React.useState(Primitives.Sphere);\r\n  const [sdf, setSdf] = React.useState(\"\");\r\n  const [inputs, setInputs] = React.useState([1.0, 1.0, 1.0]);\r\n  const [inputLabels, setInputLabels] = React.useState([\"Radius\", \"\", \"\"]);\r\n  const [inputsActive, setInputsActive] = React.useState([true, false, false]);\r\n\r\n  const prepareInputs = (label1, label2 = \"\", label3 = \"\") => {\r\n    setInputLabels([label1, label2, label3]);\r\n    setInputsActive([label1, label2, label3]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(\"ACTUALIZADO SDF\");\r\n    if (primitive == Primitives.Sphere) {\r\n      setSdf(`sphere(p, ${inputs[0].toFixed(4)})`);\r\n      prepareInputs(\"radius\");\r\n    } else if (primitive == Primitives.Box) {\r\n      setSdf(\r\n        `box(p, vec3(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}, \r\n          ${inputs[2].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"sx\", \"sy\", \"sz\");\r\n    } else if (primitive == Primitives.Torus) {\r\n      setSdf(\r\n        `torus(p, vec2(\r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n          )\r\n        )`\r\n      );\r\n      prepareInputs(\"hole\", \"thickness\");\r\n    } else if (primitive == Primitives.Cylinder) {\r\n      setSdf(\r\n        `cylinder(p, \r\n          ${inputs[0].toFixed(4)}, \r\n          ${inputs[1].toFixed(4)}\r\n        )`\r\n      );\r\n      prepareInputs(\"height\", \"radius\");\r\n    }\r\n  }, [primitive, inputs]);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CustomNode\r\n        title={\"Primitive\"}\r\n        id={id}\r\n        data={data}\r\n        dropdownOptions={Object.values(Primitives)}\r\n        body={\r\n          <>\r\n            {inputsActive[0] ? (\r\n              <FloatInput\r\n                val={inputs[0]}\r\n                handleChange={(newVal) =>\r\n                  setInputs([newVal, inputs[1], inputs[2]])\r\n                }\r\n                label={inputLabels[0]}\r\n              />\r\n            ) : null}\r\n            {inputsActive[1] ? (\r\n              <FloatInput\r\n                val={inputs[1]}\r\n                handleChange={(newVal) =>\r\n                  setInputs([inputs[0], newVal, inputs[2]])\r\n                }\r\n                label={inputLabels[1]}\r\n              />\r\n            ) : null}\r\n            {inputsActive[2] ? (\r\n              <FloatInput\r\n                val={inputs[2]}\r\n                handleChange={(newVal) =>\r\n                  setInputs([inputs[0], inputs[1], newVal])\r\n                }\r\n                label={inputLabels[2]}\r\n              />\r\n            ) : null}\r\n          </>\r\n        }\r\n        onChangeOption={setPrimitive}\r\n        sdf={sdf}\r\n        currOption={primitive}\r\n        nInputs={0}\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport Slider from '@mui/material/Slider';\r\nimport { styled } from '@mui/material/styles';\r\n\r\nconst CustomSlider = styled(Slider)(({ theme }) => ({\r\n    color: theme.palette.primary,\r\n    \"& .MuiSlider-thumb\": {\r\n        backgroundColor: theme.palette.primary,\r\n        '&:focus, &:hover, &.Mui-active': {\r\n            boxShadow:\r\n              '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)',\r\n            // Reset on touch devices, it doesn't add specificity\r\n            '@media (hover: none)': {\r\n              boxShadow: '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)',\r\n            },\r\n          },\r\n    },\r\n    \"& .MuiSlider-rail\": {\r\n        opacity: 0.5,\r\n        backgroundColor: theme.palette.primary\r\n    }\r\n}));\r\n\r\nexport default function FloatSlider(props) {\r\n    return (\r\n        <CustomSlider\r\n            size=\"small\"\r\n            valueLabelDisplay=\"auto\"\r\n            onChange={props.handleChange}\r\n            min={props.range[0]}\r\n            max={props.range[1]}\r\n            step={0.1}\r\n            style={{width:\"90%\", margin:\"10px\"}}\r\n        />\r\n    );\r\n}","import React, { useEffect } from \"react\";\r\nimport CustomNode from \"../CustomNodes/CustomNode\";\r\nimport FloatSlider from \"../CustomComponents/FloatSlider\";\r\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#ff8787',\r\n      main: '#ff5858',\r\n      dark: '#ff2323',\r\n      contrastText: 'white',\r\n    },\r\n  },\r\n});\r\n\r\nconst BooleanOperations = {\r\n  Union: \"Union\",\r\n  Difference: \"Difference\",\r\n  Intersection: \"Intersection\",\r\n};\r\n\r\nexport default function BooleanNode({ data, id }) {\r\n  const [operation, setOperation] = React.useState(BooleanOperations.Union);\r\n  const [smooth, setSmooth] = React.useState(true);\r\n  const [k, setK] = React.useState(0.0.toFixed(4));\r\n  const [sdf, setSdf] = React.useState(\"\");\r\n\r\n  useEffect(() => {\r\n    console.log(\r\n      `SE HAN MODIFICADO LOS SDF EN NODO BOOLEANO. AHORA HAY ${Object.keys(data.inputs).length\r\n      }`\r\n    );\r\n\r\n    const keys = Object.keys(data.inputs);\r\n\r\n    let newSdf = `sdfSmooth${operation}(${data.inputs[keys[0]]}, ${data.inputs[keys[1]]}, ${k})`;\r\n\r\n    for (let i = 0; i < keys.length - 2; i++) {\r\n      console.log(data.inputs[keys[i + 2]]);\r\n      newSdf = `sdfSmooth${operation}(${data.inputs[keys[i + 2]]}, ${newSdf}, ${k})`;\r\n    };\r\n\r\n    setSdf(newSdf);\r\n  }, [data, operation, smooth, k]);\r\n\r\n\r\n\r\n  const handleChange = (ev, val) => {\r\n    setK(parseFloat(val).toFixed(4));\r\n  }\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CustomNode\r\n        title={\"Boolean\"}\r\n        id={id}\r\n        data={data}\r\n        dropdownOptions={Object.values(BooleanOperations)}\r\n        onChangeOption={setOperation}\r\n        sdf={sdf}\r\n        currOption={operation}\r\n        nInputs={Math.max(2, Object.keys(data.inputs).length + 1)}\r\n        body={\r\n          <div style={{ margin: 10 }}>\r\n            Smoothness\r\n\r\n            <FloatSlider\r\n              handleChange={handleChange}\r\n              range={[0, 10]}\r\n            />\r\n\r\n          </div>\r\n        }\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n}","import React, { useEffect } from \"react\";\r\nimport CustomNode from \"../CustomNodes/CustomNode\";\r\nimport Slider from '@mui/material/Slider';\r\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#a8f798',\r\n      main: '#3ec224',\r\n      dark: '#1c9404',\r\n      contrastText: 'white',\r\n    },\r\n  },\r\n});\r\n\r\nconst DeformOperations = {\r\n  Bend: \"Bend\",\r\n  Twist: \"Twist\",\r\n};\r\n\r\nexport default function DeformNode({ data, id }) {\r\n  const [operation, setOperation] = React.useState(DeformOperations.Bend);\r\n  const [k, setK] = React.useState(0.0.toFixed(4));\r\n\r\n  const [sdf, setSdf] = React.useState(\"\");\r\n\r\n  useEffect(() => {\r\n    console.log(\r\n      `SE HAN MODIFICADO LOS SDF EN NODO DEFORM. AHORA HAY ${Object.keys(data.inputs).length\r\n      }`\r\n    );\r\n    \r\n    let input = data.inputs[Object.keys(data.inputs)[0]];\r\n\r\n    if(input){\r\n      console.log(\"OLD: \" + input);\r\n      console.log(typeof(input));\r\n      setSdf(input.replace(\"p,\", `sdf${operation}(p, ${k}),`));\r\n\r\n    }\r\n  }, [data, operation, k]);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n    <CustomNode\r\n      title={\"Deform\"}\r\n      id={id}\r\n      data={data}\r\n      dropdownOptions={Object.values(DeformOperations)}\r\n      onChangeOption={setOperation}\r\n      sdf={sdf}\r\n      currOption={operation}\r\n      body={\r\n        <div style={{ margin: 10 }}>\r\n            Amount\r\n         \r\n            <Slider\r\n              size=\"small\"\r\n              value={k}\r\n              valueLabelDisplay=\"k\"\r\n              onChange={(e, v) => setK(parseFloat(v).toFixed(4))}\r\n              min={0}\r\n              max={5}\r\n              step={0.1}\r\n          />          \r\n        </div>\r\n      }\r\n    />\r\n    </ThemeProvider>\r\n  );\r\n}","import React, {useEffect, useState} from 'react';\r\nimport FloatInput from './FloatInput';\r\nimport Box from '@mui/material/Box';\r\nimport Paper from '@mui/material/Paper';\r\nimport Grid from '@mui/material/Grid'; import Stack from '@mui/material/Stack';\r\nimport { styled } from '@mui/material/styles';\r\nimport TextField from '@mui/material/TextField';\r\n\r\n\r\nconst Header = styled(Paper)(({ theme, color }) => ({\r\n    backgroundColor: color,\r\n    ...theme.typography.body2,\r\n    textAlign: 'center',\r\n    color: theme.palette.primary.contrastText,\r\n    borderRadius: \"3px 3px 0 0\"\r\n}));\r\n\r\nexport const TextFieldWrapper = styled(TextField)`\r\n  fieldset {\r\n    border-radius: 0 0 2px 2px;\r\n  }\r\n`;\r\n\r\nfunction Field(props) {\r\n    return (\r\n        <TextFieldWrapper\r\n            value={props.val}\r\n            type=\"number\"\r\n            onChange={(ev) => props.handleChange(parseFloat(ev.target.value))}\r\n            size=\"small\"\r\n            style={{borderRadius: \"0\"}}\r\n        />\r\n    )\r\n}\r\nexport default function Vector3Input(props) {\r\n    const [x, setX] = useState(0);\r\n    const [y, setY] = useState(0);\r\n    const [z, setZ] = useState(0);\r\n\r\n    useEffect(() => {\r\n        props.handleChange([x,y,z]);\r\n    }, [x,y,z]);\r\n\r\n    return (\r\n        <>\r\n            <Box sx={{ flexGrow: 1 }}>\r\n                <Grid container spacing={0} columns={{ xs: 4, sm: 8, md: 12 }}>\r\n                    <Grid item xs={2} sm={4} md={4} key={1}><Header color='red'>x</Header></Grid>\r\n                    <Grid item xs={2} sm={4} md={4} key={2}><Header color=\"green\">y</Header></Grid>\r\n                    <Grid item xs={2} sm={4} md={4} key={3}><Header color=\"blue\">z</Header></Grid>\r\n\r\n                    <Grid item xs={2} sm={4} md={4} key={4}>\r\n                        <Field val={x} handleChange={setX}/>\r\n                    </Grid>\r\n                    <Grid item xs={2} sm={4} md={4} key={5}>\r\n                        <Field val={y} handleChange={setY}/>\r\n                    </Grid>\r\n                    <Grid item xs={2} sm={4} md={4} key={6}>\r\n                        <Field val={z} handleChange={setZ}/>\r\n                    </Grid>\r\n\r\n                </Grid>\r\n            </Box>\r\n        </>\r\n    );\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport CustomNode from \"../CustomNodes/CustomNode\";\r\nimport FloatSlider from \"../CustomComponents/FloatSlider\";\r\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\r\nimport Vector3Input from \"../CustomComponents/Vector3Input\";\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      light: '#ffd7a2',\r\n      main: '#ffbb62',\r\n      dark: '#fa9c21',\r\n      contrastText: 'white',\r\n    },\r\n  },\r\n});\r\n\r\nconst TransformOperations = {\r\n  Translate: \"Translate\",\r\n  Scale: \"Scale\",\r\n  Rotate: \"Rotate\"\r\n};\r\n\r\nexport default function TransformNode({ data, id }) {\r\n  const [operation, setOperation] = React.useState(TransformOperations.Translate);\r\n  const [sdf, setSdf] = React.useState(\"\");\r\n  const [transformVal, setTransformVal] = React.useState([0,0,0]);\r\n\r\n  useEffect(() => {\r\n    console.log(\r\n      `SE HAN MODIFICADO LOS SDF EN NODO TRANSFORM. AHORA HAY ${Object.keys(data.inputs).length\r\n      }`\r\n    );\r\n\r\n    let input = data.inputs[Object.keys(data.inputs)[0]];\r\n\r\n    if (input) {\r\n      if(operation !== TransformOperations.Scale)\r\n        setSdf(input.replace(\"p,\", `sdf${operation}(p, vec3(${transformVal[0]},${transformVal[1]},${transformVal[2]}) ),`));\r\n      else{\r\n        const s = `vec3(${transformVal[0]},${transformVal[1]},${transformVal[2]})`;\r\n        setSdf(input.replace(\"p,\", `(p/${s}) * ${s},`));\r\n      }\r\n\r\n    }\r\n\r\n  }, [data, operation, transformVal]);\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CustomNode\r\n        title={\"Transform\"}\r\n        id={id}\r\n        data={data}\r\n        dropdownOptions={Object.values(TransformOperations)}\r\n        onChangeOption={setOperation}\r\n        sdf={sdf}\r\n        currOption={operation}\r\n        body={\r\n          <div style={{ margin: 10 }}>\r\n            Amount\r\n            <Vector3Input handleChange={setTransformVal}/>\r\n          </div>\r\n        }\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n}","import React from 'react';\r\nimport { Controls, ControlButton } from 'react-flow-renderer';\r\nimport SaveIcon from '@mui/icons-material/Save';\r\nimport FileOpenIcon from '@mui/icons-material/FileOpen';\r\n\r\nexport default function CustomControls(props) {\r\n  return (\r\n    <Controls>\r\n      <ControlButton onClick={() => props.save()}>\r\n        <SaveIcon />\r\n      </ControlButton>\r\n      <ControlButton onClick={() => props.load()}>\r\n        <FileOpenIcon />\r\n      </ControlButton>\r\n    </Controls>\r\n  );\r\n}","export const NodeTypes = {\r\n    Primitive: \"primitiveNode\",\r\n    Boolean: \"booleanNode\",\r\n    Transform: \"transformNode\",\r\n    Deform: \"deformNode\",\r\n  };","import * as React from 'react';\r\nimport { useCallback, useEffect, useState, useRef } from \"react\";\r\n\r\nimport { ContextMenu, MenuItem, ContextMenuTrigger } from \"react-contextmenu\";\r\n\r\nimport { NodeTypes } from '../nodeTypes';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport PrimitiveIcon from '@mui/icons-material/ViewInAr';\r\nimport TransformIcon from '@mui/icons-material/Transform';\r\nimport BooleanIcon from '@mui/icons-material/JoinRight';\r\nimport DeformIcon from '@mui/icons-material/Storm';\r\n\r\nconst customStyles = {\r\n  width: \"250px\",\r\n  height: \"250px\",\r\n  backgroundColor: \"purple\",\r\n  color: \"white\",\r\n  display: \"flex\",\r\n  alignItems: \"center\",\r\n  justifyContent: \"center\",\r\n  margin: \"auto\"\r\n};\r\n\r\n// https://codesandbox.io/s/tq8r3?file=/src/components/coupon.css:969-2051\r\nexport default function CustomContextMenu2(props) {\r\n  const icons = [<PrimitiveIcon />, <BooleanIcon />, <TransformIcon />, <DeformIcon />];\r\n\r\n  return (\r\n\r\n\r\n\r\n    <ContextMenu id=\"contextmenu\">\r\n      {Object.keys(NodeTypes).map((type, index) =>\r\n        <MenuItem onClick={()=>{props.newNode(Object.values(NodeTypes)[index],0,0); console.log(Object.values(NodeTypes)[index])}}>\r\n          {icons[index]}\r\n          <Typography align=\"left\" style={{marginLeft: \"10px\"}} variant=\"body1\" color=\"text.primary\">\r\n            {type}\r\n          </Typography>\r\n          <Typography  align=\"right\" style={{marginLeft: \"10px\"}} variant=\"body2\" color=\"text.secondary\">\r\n            {type[0].toUpperCase()}\r\n          </Typography>\r\n        </MenuItem>\r\n      )}\r\n    </ContextMenu>\r\n\r\n  );\r\n\r\n  // const handleContextMenu = useCallback(\r\n  //     (event) => {\r\n  //         event.preventDefault();\r\n  //         setAnchorPoint({ x: event.pageX, y: event.pageY });\r\n  //         setShow(true);\r\n  //         console.log(\"ANCHOR: \" + event.pageX);\r\n  //     },\r\n  //     [setAnchorPoint]\r\n  // );\r\n\r\n  // const handleClick = useCallback(() => (show ? setShow(false) : null), [show]);\r\n\r\n  // useEffect(() => {\r\n  //     document.addEventListener(\"click\", handleClick);\r\n  //     document.addEventListener(\"contextmenu\", handleContextMenu);\r\n  //     return () => {\r\n  //         document.removeEventListener(\"click\", handleClick);\r\n  //         document.removeEventListener(\"contextmenu\", handleContextMenu);\r\n  //     };\r\n  // }, [show]);\r\n\r\n\r\n  // return (\r\n  //     <div style={{\r\n  //         top: `${anchorPoint.y}px`,\r\n  //         left: `${anchorPoint.x}px`\r\n  //       }}>\r\n  //         {show ? <Paper sx = {{ width: 200, maxWidth: '100%' }} >\r\n  //         <MenuList>\r\n  //         {Object.values(NodeTypes).map((type, index) =>\r\n  //             <MenuItem onClick={() => console.log(\"asasas\")}>\r\n  //                 <ListItemIcon>{icons[index]}</ListItemIcon>\r\n  //                 <ListItemText>{type} </ListItemText>\r\n  //                 <Typography variant=\"body2\" color=\"text.secondary\">\r\n  //                     {type[0].toUpperCase()}\r\n  //                 </Typography>\r\n  //             </MenuItem>)\r\n  //         }\r\n  //     </MenuList>\r\n  //     </Paper > \r\n  //     : null}\r\n  //     </div>\r\n\r\n  // );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { useEffect, useRef } from 'react';\r\nimport ReactFlow, {\r\n  addEdge,\r\n  Background,\r\n  useNodesState,\r\n  useEdgesState,\r\n  MarkerType,\r\n  project,\r\n  useReactFlow\r\n} from 'react-flow-renderer';\r\nimport PrimitiveNode from './CustomNodes/PrimitiveNode.js';\r\nimport BooleanNode from './CustomNodes/BooleanNode.js';\r\nimport DeformNode from './CustomNodes/DeformNode.js';\r\nimport TransformNode from './CustomNodes/TransformNode.js';\r\n\r\nimport ButtonEdge from './CustomNodes/ButtonEdge';\r\nimport CustomControls from './CustomComponents/CustomControls.js';\r\nimport './styles.css';\r\nimport { GraphProvider } from './GraphContext.js';\r\nimport CustomContextMenu from './CustomComponents/CustomContextMenu.js';\r\nimport CustomContextMenu2 from './CustomComponents/CustomContextMenu copy.js';\r\n\r\nimport { ContextMenu, MenuItem, ContextMenuTrigger } from 'react-contextmenu';\r\n\r\n\r\nconst flowKey = 'savedGraph';\r\nconst graphNodeTypes = { primitiveNode: PrimitiveNode, booleanNode: BooleanNode, deformNode: DeformNode, transformNode: TransformNode };\r\nconst edgeTypes = { buttonEdge: ButtonEdge };\r\n\r\nconst initialNodes = [\r\n  {\r\n    id: 'prim-0',\r\n    type: 'primitiveNode',\r\n    position: { x: -50, y: -350 },\r\n    dragHandle: ' .nodeHeader',\r\n    data: { default: 'Cube', inputs: {}, sdf: '', children: [] },\r\n  },\r\n  {\r\n    id: 'prim-1',\r\n    type: 'primitiveNode',\r\n    dragHandle: '.nodeHeader',\r\n    position: { x: -50, y: 125 },\r\n    data: { inputs: {}, sdf: '', children: [] },\r\n  },\r\n  {\r\n    id: 'prim-2',\r\n    type: 'primitiveNode',\r\n    position: { x: -50, y: 600 },\r\n    dragHandle: '.nodeHeader',\r\n    data: { inputs: {}, sdf: '', children: [] },\r\n  },\r\n  {\r\n    id: 'deform-0',\r\n    type: 'deformNode',\r\n    dragHandle: '.nodeHeader',\r\n    position: { x: 200, y: -125 },\r\n    data: { inputs: {}, sdf: '', children: [] },\r\n  },\r\n  {\r\n    id: 'transform-0',\r\n    type: 'transformNode',\r\n    dragHandle: '.nodeHeader',\r\n    position: { x: 450, y: 150 },\r\n    data: { inputs: {}, sdf: '', children: [] },\r\n  },\r\n  {\r\n    id: 'bool-2',\r\n    type: 'booleanNode',\r\n    dragHandle: '.nodeHeader',\r\n    position: { x: 200, y: 375 },\r\n    data: { inputs: {}, sdf: '', children: [] },\r\n  },\r\n];\r\n\r\nconst onInit = (reactFlowInstance) =>\r\n  console.log('flow loaded:', reactFlowInstance);\r\n\r\nexport default function Graph() {\r\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\r\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\r\n  const [rfInstance, setRfInstance] = useState(null);\r\n  const [id, setId] = React.useState(3);\r\n  const [mouseCoor, setMouseCoor] = useState([0, 0]);\r\n\r\n  const reactFlowRef = useRef(null);\r\n\r\n  const updateNodeSdf = (id, newSdf, parent) => {\r\n    console.log('ACTUALIZADONDO SDF DE ' + id);\r\n    var nodesCopy = [...nodes];\r\n    var parent = nodesCopy.find((node) => node.id === id);\r\n    parent.data = {\r\n      ...parent.data,\r\n      sdf: newSdf,\r\n    };\r\n\r\n    for (var child of parent.data.children) {\r\n      for (var node of nodesCopy) {\r\n        if (node.id === child) {\r\n          var newInputs = node.data.inputs;\r\n          newInputs[`${id}`] = newSdf;\r\n\r\n          node.data = {\r\n            ...node.data,\r\n            inputs: newInputs,\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    setNodes(nodesCopy);\r\n  };\r\n\r\n  const removeChild = (parent, child) => {\r\n    setNodes((nds) =>\r\n      nds.map((node) => {\r\n        if (node.id === parent) {\r\n          console.log(`ELIMINANDO HIJO ${child} DE ${parent}`);\r\n\r\n          var newChildren = node.data.children;\r\n          newChildren = newChildren.filter(function (c) {\r\n            return c.id != child;\r\n          });\r\n\r\n          node.data = {\r\n            ...node.data,\r\n            children: newChildren,\r\n          };\r\n        }\r\n        if (node.id === child) {\r\n          console.log(`ACTUALIZANDO ${child}`);\r\n          var newInputs = node.data.inputs;\r\n          newInputs[`${parent}`] = '';\r\n          node.data = {\r\n            ...node.data,\r\n            inputs: newInputs,\r\n          };\r\n        }\r\n\r\n        onNodesChange([node]);\r\n        return node;\r\n      })\r\n    );\r\n  };\r\n\r\n  const removeEdge = (edgeId) => {\r\n    console.log('WDGES: ');\r\n    console.log(edges);\r\n    const edge = edges.find((e) => e.id === edgeId);\r\n\r\n    var newEdges = edges.filter((edge) => {\r\n      console.log(edge.source);\r\n      return edge.id != edgeId;\r\n    });\r\n\r\n    setEdges(newEdges);\r\n    removeChild(edge.source, edge.target);\r\n  };\r\n\r\n  const sharedFunctions = {\r\n    updateNodeSdf,\r\n    removeEdge,\r\n  };\r\n\r\n  const onConnect = (params) => {\r\n    const sourceNode = nodes.find((n) => n.id === params.source);\r\n\r\n    // CREAMOS EDGE\r\n    setEdges((eds) =>\r\n      addEdge(\r\n        {\r\n          ...params,\r\n          type: 'buttonEdge',\r\n          animated: true,\r\n          markerEnd: { type: MarkerType.Arrow, color: '#000' },\r\n        },\r\n        eds\r\n      )\r\n    );\r\n\r\n    // AADIMOS HIJO AL PADRE\r\n    var newChildren = sourceNode.data.children;\r\n    newChildren.push(params.target);\r\n\r\n    setNodes((nds) =>\r\n      nds.map((node) => {\r\n        if (node.id === params.source) {\r\n          console.log(`AADIENDO HIJO ${params.target} A ${params.source}`);\r\n\r\n          // var newChildren = node.data.children;\r\n          // console.log(typeof newChildren);\r\n          // console.log(newChildren);\r\n          // newChildren.push(params.target);\r\n          console.log(newChildren);\r\n          node.data = {\r\n            ...node.data,\r\n            children: newChildren,\r\n          };\r\n        }\r\n        if (node.id === params.target) {\r\n          console.log(`INICIALIZANDO ${params.source}`);\r\n          var newInputs = node.data.inputs;\r\n          newInputs[`${params.source}`] = sourceNode.data.sdf;\r\n          node.data = {\r\n            ...node.data,\r\n            inputs: newInputs,\r\n          };\r\n        }\r\n\r\n        onNodesChange([node]);\r\n        return node;\r\n      })\r\n    );\r\n\r\n    // INICIAMOS HIJO\r\n  };\r\n\r\n  // useEffect(() => {\r\n  //   console.log('NODOS ACTUALIZADOS');\r\n  //   console.log(nodes);\r\n  // }, [nodes]);\r\n\r\n  useEffect(() => {\r\n    console.log('NUEVO EDGE:');\r\n    console.log(edges);\r\n  }, [edges]);\r\n\r\n  const onSave = () => {\r\n    if (rfInstance) {\r\n      const flow = rfInstance.toObject();\r\n      console.log('FLOW SAVED:');\r\n      console.log(flow);\r\n      localStorage.setItem(flowKey, JSON.stringify(flow));\r\n    }\r\n  };\r\n\r\n  const onLoad = async () => {\r\n    const flow = JSON.parse(localStorage.getItem(flowKey));\r\n\r\n    if (flow) {\r\n      console.log('FLOW LOADED:');\r\n      console.log(flow);\r\n      const { x = 0, y = 0, zoom = 1 } = flow.viewport;\r\n      setNodes(flow.nodes || []);\r\n      setEdges(flow.edges || []);\r\n    }\r\n  };\r\n\r\n  const newNode = (nodeType, xPos = 0, yPos = 0) => {\r\n    console.log('CREANDO ' + nodeType);\r\n    setId(id + 1);\r\n    const nodeId = `node-${id}`;\r\n    return {\r\n      id: nodeId,\r\n      type: nodeType,\r\n      dragHandle: '.nodeHeader',\r\n      position: { x: xPos, y: yPos },\r\n      data: {\r\n        inputs: {},\r\n        sdf: '',\r\n        children: [],\r\n      },\r\n    };\r\n  };\r\n\r\n  const createAddNodeMousePos = (nodeType) => {\r\n    const { x, y } = rfInstance.project({ x: mouseCoor[0], y: mouseCoor[1] });\r\n    let node = newNode(nodeType, x, y);\r\n    nodes.push(node);\r\n    onNodesChange([node]);\r\n  };\r\n\r\n  const handleKey = (e) => {\r\n    let node = null;\r\n\r\n    const { x, y } = rfInstance.project({ x: mouseCoor[0], y: mouseCoor[1] });\r\n\r\n\r\n    if (e.key.toLowerCase() === 'p') node = newNode('primitiveNode', x, y);\r\n    else if (e.key.toLowerCase() === 'b') node = newNode('booleanNode', x, y);\r\n    else if (e.key.toLowerCase() === 'd') node = newNode('deformNode', x, y);\r\n    else if (e.key.toLowerCase() === 't') node = newNode('transformNode', x, y);\r\n\r\n    if (node) {\r\n      nodes.push(node);\r\n      onNodesChange([node]); // Para actualizar\r\n    }\r\n\r\n  };\r\n\r\n  const handleMouse = (e) => {\r\n    const bounds = reactFlowRef.current.getBoundingClientRect();\r\n    setMouseCoor([e.clientX - bounds.left, e.clientY - bounds.top]);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <ContextMenuTrigger id='contextmenu'>\r\n        <div style={{ height: '100vh' }} tabIndex='0' onKeyDown={handleKey} onMouseMove={handleMouse}>\r\n\r\n          <GraphProvider value={sharedFunctions}>\r\n            <ReactFlow\r\n              ref={reactFlowRef}\r\n              nodes={nodes}\r\n              edges={edges}\r\n              onNodesChange={onNodesChange}\r\n              onEdgesChange={onEdgesChange}\r\n              onConnect={onConnect}\r\n              // onDisconnect={onDisconnect}\r\n\r\n              nodeTypes={graphNodeTypes}\r\n              edgeTypes={edgeTypes}\r\n              onInit={setRfInstance}\r\n              // onEdgeClick={(ev, edge) =>\r\n              //   setEdges(edges.filter((e) => e.id != edge.id))\r\n              // }\r\n              snapToGrid={false}\r\n              fitView\r\n            >\r\n              <Background variant='lines' color='#aaa' gap={10} />\r\n              <CustomControls save={onSave} load={onLoad} />\r\n            </ReactFlow>\r\n          </GraphProvider>\r\n\r\n\r\n\r\n\r\n        </div>\r\n      </ContextMenuTrigger>\r\n      <CustomContextMenu2 newNode={createAddNodeMousePos} />\r\n\r\n    </>\r\n  );\r\n}\r\n","import React, {useContext} from 'react';\r\nimport { getBezierPath, getEdgeCenter } from 'react-flow-renderer';\r\nimport GraphContext from \"../GraphContext.js\";\r\n\r\nimport '../styles.css';\r\n\r\nconst foreignObjectSize = 40;\r\n\r\nexport default function CustomEdge({\r\n  id,\r\n  sourceX,\r\n  sourceY,\r\n  targetX,\r\n  targetY,\r\n  sourcePosition,\r\n  targetPosition,\r\n  style = {},\r\n  data,\r\n}) {\r\n  const edgePath = getBezierPath({\r\n    sourceX,\r\n    sourceY,\r\n    sourcePosition,\r\n    targetX,\r\n    targetY,\r\n    targetPosition,\r\n  });\r\n  const [edgeCenterX, edgeCenterY] = getEdgeCenter({\r\n    sourceX,\r\n    sourceY,\r\n    targetX,\r\n    targetY,\r\n  });\r\n\r\n  const [showButton, setShowButton] = React.useState(false);\r\n  const sharedFunctions = useContext(GraphContext);\r\n\r\n  return (\r\n    <>\r\n      <path\r\n        id={id}\r\n        style={style}\r\n        className=\"react-flow__edge-path\"\r\n        d={edgePath}\r\n        \r\n      />\r\n      <foreignObject\r\n        width={foreignObjectSize}\r\n        height={foreignObjectSize}\r\n        x={edgeCenterX - foreignObjectSize / 2}\r\n        y={edgeCenterY - foreignObjectSize / 2}\r\n        \r\n        className=\"edgebutton-foreignobject\"\r\n        requiredExtensions=\"http://www.w3.org/1999/xhtml\"\r\n      >\r\n        {true ?\r\n          <body>\r\n            <button className=\"edgebutton\" onClick={() => {console.log(\"SI: \" + id); sharedFunctions.removeEdge(id)}}>\r\n              \r\n            </button>\r\n          </body> \r\n          : \r\n          null\r\n        }\r\n      </foreignObject>\r\n    </>\r\n  );\r\n}\r\n","import * as React from 'react';\r\nimport Box from '@mui/material/Box';\r\nimport Card from '@mui/material/Card';\r\nimport CardActions from '@mui/material/CardActions';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport Button from '@mui/material/Button';\r\nimport Typography from '@mui/material/Typography';\r\n\r\n\r\nexport default function MaterialCard(props) {\r\n  return (\r\n    <Box sx={{ minWidth: 100 }}>\r\n      <Card elevation={10} >\r\n      <CardContent>\r\n      <Typography variant=\"h5\" component=\"div\">\r\n        {props.name} ? {props.name} ; Unknown\r\n      </Typography>\r\n      <Typography sx={{ mb: 1.5 }} color=\"text.secondary\">\r\n        adjective\r\n      </Typography>\r\n      <Typography variant=\"body2\">\r\n        well meaning and kindly.\r\n        <br />\r\n        {'\"a benevolent smile\"'}\r\n      </Typography>\r\n    </CardContent>\r\n    <CardActions>\r\n      <Button size=\"small\">Learn More</Button>\r\n    </CardActions>\r\n      </Card>\r\n    </Box>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport MaterialCard from \"./MaterialCard\";\r\nimport Grid from '@mui/material/Grid';\r\n\r\nexport default function MaterialsPage() {\r\n  return <Grid\r\n    container\r\n    direction=\"row\"\r\n    justifyContent=\"flex-start\"\r\n    alignItems=\"flex-start\"\r\n    spacing={2}\r\n    >\r\n\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n    <Grid item><MaterialCard/></Grid>\r\n</Grid>;\r\n}\r\n","import * as React from 'react';\r\nimport Box from '@mui/material/Box';\r\nimport Card from '@mui/material/Card';\r\nimport CardActions from '@mui/material/CardActions';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport Button from '@mui/material/Button';\r\nimport Typography from '@mui/material/Typography';\r\n\r\n\r\nexport default function SurfaceCard(props) {\r\n  return (\r\n    <Box sx={{ minWidth: 100 }}>\r\n      <Card elevation={10} >\r\n      <CardContent>\r\n      <Typography variant=\"h5\" component=\"div\">\r\n        {props.name} ? {props.name} ; Unknown\r\n      </Typography>\r\n      <Typography sx={{ mb: 1.5 }} color=\"text.secondary\">\r\n        adjective\r\n      </Typography>\r\n      <Typography variant=\"body2\">\r\n        well meaning and kindly.\r\n        <br />\r\n        {'\"a benevolent smile\"'}\r\n      </Typography>\r\n    </CardContent>\r\n    <CardActions>\r\n      <Button size=\"small\">Learn More</Button>\r\n    </CardActions>\r\n      </Card>\r\n    </Box>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport SurfaceCard from './SurfaceCard';\r\nimport Grid from '@mui/material/Grid';\r\nimport Box from '@mui/material/Box';\r\nimport Fab from '@mui/material/Fab';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport Typography from '@mui/material/Typography';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\n\r\nimport TextField from '@mui/material/TextField';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogContentText from '@mui/material/DialogContentText';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport Button from '@mui/material/Button';\r\nimport EquationEditor from 'equation-editor-react';\r\nimport evaluatex from '../node_modules/evaluatex/dist/evaluatex';\r\nimport MathJax from 'react-mathjax';\r\n\r\nimport { evaluate, create, all } from 'mathjs';\r\nimport nerdamer from 'nerdamer';\r\nimport { isImportEqualsDeclaration } from 'typescript';\r\n\r\nfunction SurfaceDialog(props) {\r\n  var nerdamer = require('nerdamer');\r\n  require('nerdamer/Calculus');\r\n\r\n  const [eqData, setEqData] = useState({});\r\n  const [validEq, setValEq] = useState(true);\r\n\r\n  const handleSave = () => {\r\n    // let fn = evaluatex(equation);\r\n    // let result = fn({ x: 3, y: 0, z: 0 });\r\n    // console.log('EVALUACION EN X=3: ' + result);\r\n    // const math = create(all);\r\n    // // defined methods can be used in both JavaScript as well as the parser\r\n    // math.import({\r\n    //   myConstant: 42,\r\n    //   sdf: function (x, y, z) {\r\n    //     return fn({ x: x, y: y, z: z });\r\n    //   },\r\n    // });\r\n    // console.log(math.evaluate('sdf(3,2,0)')); // 84\r\n    // console.log(math.derivative(math.sdf, 'x').evaluate({ x: 4 }));\r\n  };\r\n\r\n  // const handleNewEquation = (newEq) => {\r\n  //   const math = create(all);\r\n  //   setEquation(newEq);\r\n  //   let f = null;\r\n\r\n  //   try {\r\n  //     f = math.parse(newEq);\r\n  //   } catch (error) {\r\n  //     setValEq(false);\r\n  //     console.warn(\"ERROR PARSING EQUATION\");\r\n  //     console.log(f);\r\n  //     return;\r\n  //   }\r\n\r\n  //   setValEq(true);\r\n\r\n  //   const x = math.parse('x');\r\n  //   const y = math.parse('y');\r\n  //   const z = math.parse('z');\r\n\r\n  //   const dfdx = math.derivative(f, x);\r\n  //   const dfdy = math.derivative(f, y);\r\n  //   const dfdz = math.derivative(f, z);\r\n\r\n  //   const norm = math.sqrt(dfdx*dfdx + dfdy*dfdy + dfdz*dfdz);\r\n  //   console.log(math.multiply(dfdx,dfdx));\r\n  //   console.log(\"NORMA: \" + norm);\r\n\r\n  //   let newData = {\r\n  //     f: f,\r\n  //     dx: dfdx,\r\n  //     dy: dfdy,\r\n  //     dz: dfdz}\r\n\r\n  //   setEqData(eqData => ({\r\n  //     ...eqData,\r\n  //     ...newData\r\n  //   }));\r\n\r\n  //   console.log(\"dFdX: \" + dfdx);\r\n  //   console.log(\"dFdY: \" + dfdy);\r\n  //   console.log(\"dFdZ: \" + dfdz);\r\n  //   //console.log(math.norm([dfdx, dfdy, dfdz]));\r\n  //   console.log(eqData);\r\n  // }\r\n\r\n  const handleNewEquation = (newEq) => {\r\n    let f = null;\r\n\r\n    try {\r\n      f = nerdamer(newEq);\r\n    } catch (error) {\r\n      setValEq(false);\r\n      console.warn('ERROR PARSING EQUATION');\r\n\r\n      return;\r\n    }\r\n\r\n    setValEq(true);\r\n\r\n    let dfdx = nerdamer.diff(f, 'x', 1);\r\n    let dfdy = nerdamer.diff(f, 'y', 1);\r\n    let dfdz = nerdamer.diff(f, 'z', 1);\r\n\r\n    let norm = nerdamer(`sqrt((${dfdx})^2 + (${dfdy})^2 + (${dfdz})^2)`);\r\n    let sdf = nerdamer(`(${f})/(${norm})`);\r\n\r\n    console.log('F: ' + f.toString());\r\n    console.log('dFdX: ' + dfdx.toString());\r\n    console.log('dFdY: ' + dfdy.toString());\r\n    console.log('dFdZ: ' + dfdz.toString());\r\n    console.log('norm: ' + norm.toString());\r\n    console.log('sdf: ' + sdf.toString());\r\n\r\n    setEqData({\r\n      f: f,\r\n      dx: dfdx,\r\n      dy: dfdy,\r\n      dz: dfdz,\r\n      norm: norm,\r\n      sdf: sdf,\r\n    });\r\n\r\n    console.log(eqData);\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log('CHANGE');\r\n    console.log(eqData);\r\n  }, [eqData]);\r\n\r\n  return (\r\n    <Dialog open={props.open} onClose={props.handleClose}>\r\n      <DialogTitle>New Surface</DialogTitle>\r\n\r\n      <DialogContent>\r\n        EQ: {eqData.f ? eqData.f.toString() : ''}\r\n        <MathJax.Provider>\r\n      <div>\r\n\r\n        <p>Block formula:</p>\r\n        <MathJax.Node formula={\r\n          eqData.f ?\r\n          `\\\\begin{align*} \r\n            f(x,y,z) &=  ${nerdamer.convertToLaTeX(eqData.f.toString())} \\\\\\\\[10pt]\r\n            \\\\nabla f(x,y,z) &= \\\\left( \r\n              ${nerdamer.convertToLaTeX(eqData.dx.toString())}, \r\n              ${nerdamer.convertToLaTeX(eqData.dy.toString())}, \r\n              ${nerdamer.convertToLaTeX(eqData.dz.toString())}\r\n            \\\\right) \\\\\\\\[10pt]\r\n            \\\\Vert \\\\nabla f(x,y,z) \\\\Vert &= ${nerdamer.convertToLaTeX(eqData.norm.toString())} \\\\\\\\[10pt]\r\n            \\\\text{sdf}(x,y,z) &= ${nerdamer.convertToLaTeX(eqData.sdf.toString())}\r\n          \\\\end{align*}` : \"\"} \r\n        />\r\n        salida string: {eqData.f ? eqData.f.toString() : \"\"} \r\n      </div>\r\n    </MathJax.Provider>\r\n\r\n        <DialogContentText>Introduce surface information:</DialogContentText>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12}>\r\n            <TextField id=\"name\" label=\"Name\" />\r\n          </Grid>\r\n\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              sx={{ width: '100%' }}\r\n              defaultValue=\"x^2 + y^2 + z^2 - 1\"\r\n              label=\"Implicit\"\r\n              onChange={(e) => handleNewEquation(e.target.value)}\r\n              id=\"Implicit\"\r\n              error={!validEq}\r\n              InputProps={{\r\n                endAdornment: (\r\n                  <InputAdornment position=\"end\"> = 0</InputAdornment>\r\n                ),\r\n              }}\r\n            />\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <TextField\r\n              disabled\r\n              sx={{ width: '100%' }}\r\n              id=\"derivative\"\r\n              label=\"Derivative\"\r\n              defaultValue=\"0\"\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={props.handleClose}>Cancel</Button>\r\n        <Button onClick={handleSave}>Save</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\nexport default function SurfacePage() {\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n\r\n  return (\r\n    <Box>\r\n      <Fab\r\n        style={{ position: 'absolute', bottom: 16, right: 16 }}\r\n        color=\"primary\"\r\n        aria-label=\"add\"\r\n        onClick={() => setDialogOpen(true)}\r\n      >\r\n        <AddIcon />\r\n      </Fab>\r\n      <SurfaceDialog\r\n        open={dialogOpen}\r\n        handleClose={() => setDialogOpen(false)}\r\n      />\r\n      <Grid\r\n        container\r\n        direction=\"row\"\r\n        justifyContent=\"flex-start\"\r\n        alignItems=\"flex-start\"\r\n        spacing={2}\r\n      >\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n        <Grid item>\r\n          <SurfaceCard />\r\n        </Grid>\r\n      </Grid>\r\n    </Box>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { createTheme, ThemeProvider, styled } from '@mui/material/styles';\r\n\r\nimport {\r\n  Header,\r\n  Content,\r\n  Footer,\r\n  Navbar,\r\n  Nav,\r\n  Icon,\r\n  Panel,\r\n  Grid,\r\n  Row, Col,\r\n} from \"rsuite\";\r\n\r\nimport AppBar from '@mui/material/AppBar';\r\nimport Graph from \"./Graph\";\r\nimport MaterialsPage from './MaterialsPage';\r\nimport SurfacePage from './SurfacePage';\r\nimport \"rsuite/dist/styles/rsuite-default.css\";\r\nimport { Box, Tab, Tabs, Typography } from '@mui/material';\r\n\r\nimport \"./styles.css\";\r\nimport Shader from \"./CustomComponents/Shader\";\r\nimport {fs} from \"./ShaderStuff/fragmentShaderMovable\";\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primitive: '#609dff',\r\n    boolean: '#ff5858',\r\n    deform: '#3ec224',\r\n    transform: '#ffbb62'\r\n  },\r\n});\r\n\r\n\r\n\r\n\r\nfunction MainContent(){ \r\n  return(\r\n    <>\r\n    <Grid fluid>\r\n      <Row>\r\n        <Col xs={6}>\r\n          <Shader \r\n            style={{height: \"100vh\"}}\r\n            shader={fs(\"box(p, vec3(1.0))\")} \r\n            uniforms={{ color: { type: \"3fv\", value: [1.0, 1.0, 0.0] } }}\r\n          />\r\n        </Col>\r\n        <Col xs={1}>\r\n          <div style={{borderRight: \"2px solid grey\",  height: \"100vh\"}} />\r\n        </Col>\r\n        <Col xs={17}>\r\n          {/* <ContextMenu/> */}\r\n          \r\n          <Graph/>\r\n        </Col>\r\n      </Row>\r\n      \r\n    </Grid>\r\n    </>\r\n  );\r\n}\r\n\r\nconst layoutStyles = {\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  height: \"100vh\"\r\n};\r\n\r\nexport default function App() {\r\n  const [tabVal, setTabVal] = React.useState(2);\r\n  \r\n  return (\r\n    <div style={layoutStyles}>\r\n      <ThemeProvider theme={theme}>\r\n      <Box>\r\n      <Box>\r\n        <Tabs value={tabVal} onChange={(e,v)=>setTabVal(v)}>\r\n          <Tab label=\"Graph\" />\r\n          <Tab label=\"Materials\" />\r\n          <Tab label=\"Surfaces\" />\r\n        </Tabs>\r\n      </Box>\r\n      <Box sx={{ padding: 2 }}>\r\n        {tabVal === 0 && (<MainContent />)}\r\n        {tabVal === 1 && (<MaterialsPage/>)}\r\n        {tabVal === 2 && (<SurfacePage/>)}\r\n      </Box>\r\n      </Box>\r\n\r\n        <Content style={{ flexGrow: 1 }}>\r\n          \r\n        </Content>\r\n        <Footer>\r\n          <Panel bordered>\r\n            <p>Daniel Zufr Quesada</p>\r\n          </Panel>\r\n        </Footer>\r\n      </ThemeProvider>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nconst rootElement = document.getElementById('root')\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n)\n"],"sourceRoot":""}